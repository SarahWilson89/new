function Garment(t,e){this.step="",this.container=$(t),this._relations_active={},this.buttons_holes_opened=!1,this.extra_fabrics_active=!1,this.extra_linings_active=!1,this.current_extra_option=!1,this.render=$("#available_window .layers"),this.render_zoom=$("#available_window_zoom .layers"),this.pocket_square=$(".pocket_square",this.container),this.render_enabled=!0,this.current_fabric_activator_parent="",this.id_box_opt_fabric="",this.bLazy_fabric=!1,this.bLazy_extra=!1,this.fabric_new=!1,this.fabric_preview_open=!1,this.image_size="STD",this.multi_fabric=!1,this.multi_fabric_active=!1,this.multi_fabric_options=[],this.position_render="",this.zoom="",this.last_change="",this.has_extra_lining=!1,this.manualStateChange=!0,this.previous_view="front",this.quilted_alert=!1,this.winter_lining_alert=!1,this.out_of_stock_status=!1,this.views=[],this.pre_filter_active=!1,this.shirt_style_click=!1,this._events={};for(var r in e)this[r]=e[r];this.current.product_type=this.product_type,this.zoom="normal",this.current.view="front",this.current.view_detail="inside",this.current.neck_open=0,this.current.inner_sleeve=0,this.current._show_lining=!1,this.real_product_type=this.product_type,this.complex&&(this.multi_fabric_options=this.product_parts,"man_suit2"==this.product_type&&(this.multi_fabric_options[2]="man_waistcoat"),this.current.config._active_block=this.multi_fabric_options[0],"man_smoking_jacket"==this.multi_fabric_options[0]&&(this.multi_fabric_options[0]="man_jacket")),$(".action_column div.price").before('<div class="price original_price"></div>');var i=window.location.search.substring(1);"defaultFilter=wedding"==i&&"man_waistcoat"==this.product_type&&$("#extra li.waistcoat_metal_buttons").hide(),this.resize_render_viewport_init();var a={};for(var n in this.config)a[n]=this.config[n];for(var n in this.extra)a[n]=this.extra[n];if(this.product_config=a,this.current.fabric.shoes="1",this.current.model=model,this.current.style=p_style,"man_shirt"==this.product_type){if(this.current.style||(this.current.style="business"),this.current.fabric.button_code=e.fabric.man_shirt.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=1),this.current.fabric.hole_code_fabric=e.fabric.man_shirt.hole_code,this.current.fabric.hole_code_fabric||(this.current.fabric.hole_code_fabric=107),this.current.fabric.thread_code_fabric=e.fabric.man_shirt.thread_code,this.current.fabric.thread_code_fabric||(this.current.fabric.thread_code_fabric=107),this.current.fabric.cuff_code=e.fabric.man_shirt.cuff_code,this.current.fabric.cuff_code||(this.current.fabric.cuff_code=1),this.shirt_styles=this.styles,"auto"!=this.current.style&&"business"!=this.current.style){var o=$(".image_render .options_render a.style"),c=$("span",o),s=this.shirt_styles[this.current.style];"undefined"!=typeof s&&("auto"!=this.current.style&&$(".title",o).hide(),"auto"!=s.view_detail&&(this.current.view_detail=s.view_detail),"auto"!=s.neck_open&&(this.current.neck_open=s.neck_open),"auto"!=s.inner_sleeve&&(this.current.inner_sleeve=s.inner_sleeve),"auto"!=s.icon&&c.html(s.icon),"auto"!=this.current.style&&$(".title."+s.title_to_show,o).show())}this.current.fabric.pant_code=e.fabric[this.product_type].pant_code,this.current.fabric.pant_code||(this.current.fabric.pant_code=1)}else"man_jacket"==this.product_type?(this.current.fabric.button_code=e.fabric.man_jacket.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=2),this.current.fabric.shirt_to_jacket_id=e.fabric.man_jacket.shirt_to_jacket_id,this.current.fabric.shirt_to_jacket_id||(this.current.fabric.shirt_to_jacket_id=699),this.current.fabric.lining=e.fabric.man_jacket.lining_id,this.current.fabric.lining||(this.current.fabric.lining=59),this.current.fabric.label_color=e.fabric.man_jacket.label_color,this.current.fabric.label_color||(this.current.fabric.label_color=0),this.current.fabric.pant_code=e.fabric[this.product_type].pant_code,this.current.fabric.pant_code||(this.current.fabric.pant_code=1),this.current.fabric.shoes=e.fabric.shoes,this.current.fabric.shoes||(this.current.fabric.shoes=1),this.current.fabric.shoe_color=e.fabric.shoe_color,this.current.fabric.shoe_color||(this.current.fabric.shoe_color="black"),this.current.fabric.tie=e.fabric.id_t4l_tie,this.current.fabric.tie||(this.current.fabric.tie=1),this.current.pocket_square="recto",this.current.quilted_waistcoat="abierto"):"man_suit2"==this.product_type||"man_suit3"==this.product_type?(this.current.fabric.button_code=e.fabric.man_jacket.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=2),this.current.fabric.tie=e.fabric.id_t4l_tie,this.current.fabric.tie||(this.current.fabric.tie=1),this.current.fabric.shirt_to_jacket_id=e.fabric.man_jacket.shirt_to_jacket_id,this.current.fabric.shirt_to_jacket_id||(this.current.fabric.shirt_to_jacket_id=699),this.current.fabric.lining=e.fabric.man_jacket.lining_id,this.current.fabric.lining||(this.current.fabric.lining=59),this.current.fabric.label_color=e.fabric.man_jacket.label_color,this.current.fabric.label_color||(this.current.fabric.label_color=0),this.current.fabric.shoes=e.fabric.shoes,this.current.fabric.shoes||(this.current.fabric.shoes=1),this.current.fabric.shoe_color=e.fabric.shoe_color,this.current.fabric.shoe_color||(this.current.fabric.shoe_color="black"),this.current.fabric.waistcoat_button_code=e.fabric.man_waistcoat.button_code,this.current.fabric.waistcoat_button_code||(this.current.fabric.waistcoat_button_code=2)):"man_smoking"==this.product_type?(this.current.fabric.button_code=e.fabric.man_smoking.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=2),this.current.fabric.tie=e.fabric.id_t4l_tie,this.current.fabric.tie||(this.current.fabric.tie=1),this.current.fabric.shirt_to_jacket_id=e.fabric.man_smoking.shirt_to_jacket_id,this.current.fabric.shirt_to_jacket_id||(this.current.fabric.shirt_to_jacket_id=699),this.current.fabric.lining=e.fabric.man_smoking.lining_id,this.current.fabric.lining||(this.current.fabric.lining=59),this.current.fabric.label_color=e.fabric.man_smoking.label_color,this.current.fabric.label_color||(this.current.fabric.label_color=0),this.current.fabric.shoes=e.fabric.shoes,this.current.fabric.shoes||(this.current.fabric.shoes=1),this.current.fabric.shoe_color=e.fabric.shoe_color,this.current.fabric.shoe_color||(this.current.fabric.shoe_color="black")):"man_pants"==this.product_type?(this.current.fabric.button_code=e.fabric.man_pants.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=2),this.current.fabric.shirt_to_jacket_id=e.fabric.man_pants.shirt_to_jacket_id,this.current.fabric.shirt_to_jacket_id||(this.current.fabric.shirt_to_jacket_id=699),this.current.fabric.lining=e.fabric.man_pants.lining_id,this.current.fabric.lining||(this.current.fabric.lining=59),this.current.fabric.label_color=e.fabric.man_pants.label_color,this.current.fabric.label_color||(this.current.fabric.label_color=0),this.current.fabric.pant_code=e.fabric[this.product_type].pant_code,this.current.fabric.pant_code||(this.current.fabric.pant_code=1),this.current.fabric.shoes=e.fabric.shoes,this.current.fabric.shoes||(this.current.fabric.shoes=1),this.current.fabric.shoe_color=e.fabric.shoe_color,this.current.fabric.shoe_color||(this.current.fabric.shoe_color="black"),this.current.fabric.tie=e.fabric.id_t4l_tie,this.current.fabric.tie||(this.current.fabric.tie=1),this.current.pocket_square="recto"):"man_waistcoat"==this.product_type?(this.current.fabric.button_code=e.fabric.man_waistcoat.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=2),this.current.fabric.waistcoat_button_code=e.fabric.man_waistcoat.button_code,this.current.fabric.waistcoat_button_code||(this.current.fabric.waistcoat_button_code=2),this.current.fabric.shirt_to_jacket_id=e.fabric.man_waistcoat.shirt_to_jacket_id,this.current.fabric.shirt_to_jacket_id||(this.current.fabric.shirt_to_jacket_id=699),this.current.fabric.lining=e.fabric.man_waistcoat.lining_id,this.current.fabric.lining||(this.current.fabric.lining=59),this.current.fabric.label_color=e.fabric.man_waistcoat.label_color,this.current.fabric.label_color||(this.current.fabric.label_color=0),this.current.fabric.pant_code=e.fabric[this.product_type].pant_code,this.current.fabric.pant_code||(this.current.fabric.pant_code=1),this.current.fabric.shoes=e.fabric.shoes,this.current.fabric.shoes||(this.current.fabric.shoes=1),this.current.fabric.shoe_color=e.fabric.shoe_color,this.current.fabric.shoe_color||(this.current.fabric.shoe_color="black"),this.current.fabric.tie=e.fabric.id_t4l_tie,this.current.fabric.tie||(this.current.fabric.tie=1),this.current.pocket_square="recto"):"man_coat"==this.product_type&&(this.current.fabric.button_code=e.fabric.man_coat.button_code,this.current.fabric.button_code||(this.current.fabric.button_code=2),this.current.fabric.ribbon_color=e.fabric.man_coat.ribbon_color,this.current.fabric.ribbon_color||(this.current.fabric.ribbon_color="mm"))}function parse_query_string(t,e){if(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=r.exec(t);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))}var a,n=/\+/g,o=/([^&=]+)=?([^&]*)/g,c=function(t){return decodeURIComponent(t.replace(n," "))},s=t.replace(/^\?/,"");for(urlParams={};a=o.exec(s);)urlParams[c(a[1])]=c(a[2]);return urlParams}function formatMoney(t,e,r,i){t=t||0,e=isNaN(e=Math.abs(e))?2:e,r=r||",",i=i||".";var a=t<0?"-":"",n=parseInt(t=Math.abs(+t||0).toFixed(e),10)+"",o=(o=n.length)>3?o%3:0,c=Math.abs(t-n).toFixed(e).slice(2);return"00"==c?a+(o?n.substr(0,o)+r:"")+n.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+r):a+(o?n.substr(0,o)+r:"")+n.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+r)+(e?i+c:"")}function format_price(t,e,r){switch(r||(r=window.currency),e){case"small_symbol":switch(r.iso){case"GBP":return"<small>"+r.symbol+"</small>"+formatMoney(t);case"USD":var i="<small>"+r.symbol+"</small>"+formatMoney(t);return"/en-ca/"!=window.region_url&&"/fr-ca/"!=window.region_url||(i+='<small style="font-size: 50%">USD</small>'),i;case"AUD":return"<small>AU"+r.symbol+"</small>"+formatMoney(t);case"MXN":return"<small>MX"+r.symbol+"</small>"+formatMoney(t);case"RUB":return formatMoney(t)+"<small>p</small>";case"CHF":return"<small>CHF </small>"+formatMoney(t,2,"'",".");default:return formatMoney(t,2,".",",")+"<small>"+r.symbol+"</small>"}case"text":default:switch(r.iso){case"GBP":return r.symbol+formatMoney(t);case"USD":var i=r.symbol+formatMoney(t);return"/en-ca/"!=window.region_url&&"/fr-ca/"!=window.region_url||(i+='<small style="font-size: 50%">USD</small>'),i;case"AUD":return"AU"+r.symbol+formatMoney(t);case"MXN":return"MX"+r.symbol+formatMoney(t);case"RUB":return formatMoney(t)+"p";case"CHF":return"<small>CHF </small>"+formatMoney(t,2,"'",".");default:return formatMoney(t)+r.symbol}}}function str_replace(t,e,r,i){var a=0,n=0,o="",c="",s=0,l=0,_=[].concat(t),u=[].concat(e),p=r,f="[object Array]"===Object.prototype.toString.call(u),d="[object Array]"===Object.prototype.toString.call(p);for(p=[].concat(p),i&&(this.window[i]=0),a=0,s=p.length;a<s;a++)if(""!==p[a])for(n=0,l=_.length;n<l;n++)o=p[a]+"",c=f?void 0!==u[n]?u[n]:"":u[0],p[a]=o.split(_[n]).join(c),i&&p[a]!==o&&(this.window[i]+=(o.length-p[a].length)/_[n].length);return d?p:p[0]}function strpos(t,e,r){var i=(t+"").indexOf(e,r||0);return i!==-1&&i}function array_push(t){var e=0,r="",i=arguments,a=i.length,n=/^\d$/,o=0,c=0,s=0;if(t.hasOwnProperty("length")){for(e=1;e<a;e++)t[t.length]=i[e];return t.length}for(r in t)t.hasOwnProperty(r)&&(++s,r.search(n)!==-1&&(o=parseInt(r,10),c=o>c?o:c));for(e=1;e<a;e++)t[++c]=i[e];return s+e-1}function empty(t){var e,r,i,a,n=[e,null,!1,0,"","0"];for(i=0,a=n.length;i<a;i++)if(t===n[i])return!0;if("object"==typeof t){for(r in t)return!1;return!0}return!1}function array_merge(){var t,e=Array.prototype.slice.call(arguments),r=e.length,i={},a="",n=0,o=0,c=0,s=0,l=Object.prototype.toString,_=!0;for(c=0;c<r;c++)if("[object Array]"!==l.call(e[c])){_=!1;break}if(_){for(_=[],c=0;c<r;c++)_=_.concat(e[c]);return _}for(c=0,s=0;c<r;c++)if(t=e[c],"[object Array]"===l.call(t))for(o=0,n=t.length;o<n;o++)i[s++]=t[o];else for(a in t)t.hasOwnProperty(a)&&(parseInt(a,10)+""===a?i[s++]=t[a]:i[a]=t[a]);return i}!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.Blazy=e()}(this,function(){function t(t){var r=t._util;r.elements=s(t.options),r.count=r.elements.length,r.destroyed&&(r.destroyed=!1,t.options.container&&p(t.options.container,function(t){_(t,"scroll",r.validateT)}),_(window,"resize",r.saveViewportOffsetT),_(window,"resize",r.validateT),_(window,"scroll",r.validateT)),e(t)}function e(t){for(var e=t._util,i=0;i<e.count;i++){var a,n=e.elements[i],c=n;a=t.options;var s=c.getBoundingClientRect();a.container&&v&&(c=c.closest(a.containerClass))?(c=c.getBoundingClientRect(),a=!!r(c,h)&&r(s,{top:c.top-a.offset,right:c.right+a.offset,bottom:c.bottom+a.offset,left:c.left-a.offset})):a=r(s,h),(a||o(n,t.options.successClass))&&(t.load(n),e.elements.splice(i,1),e.count--,i--)}0===e.count&&t.destroy()}function r(t,e){return t.right>=e.left&&t.bottom>=e.top&&t.left<=e.right&&t.top<=e.bottom}function i(t,e,r){if(!o(t,r.successClass)&&(e||r.loadInvisible||0<t.offsetWidth&&0<t.offsetHeight))if(e=t.getAttribute(d)||t.getAttribute(r.src)){e=e.split(r.separator);var i=e[b&&1<e.length?1:0],s=t.getAttribute(r.srcset),l="img"===t.nodeName.toLowerCase(),f=(e=t.parentNode)&&"picture"===e.nodeName.toLowerCase();if(l||void 0===t.src){var h=new Image,v=function(){r.error&&r.error(t,"invalid"),c(t,r.errorClass),u(h,"error",v),u(h,"load",m)},m=function(){l?f||n(t,i,s):t.style.backgroundImage='url("'+i+'")',a(t,r),u(h,"load",m),u(h,"error",v)};f&&(h=t,p(e.getElementsByTagName("source"),function(t){var e=r.srcset,i=t.getAttribute(e);i&&(t.setAttribute("srcset",i),t.removeAttribute(e))})),_(h,"error",v),_(h,"load",m),n(h,i,s)}else t.src=i,a(t,r)}else"video"===t.nodeName.toLowerCase()?(p(t.getElementsByTagName("source"),function(t){var e=r.src,i=t.getAttribute(e);i&&(t.setAttribute("src",i),t.removeAttribute(e))}),t.load(),a(t,r)):(r.error&&r.error(t,"missing"),c(t,r.errorClass))}function a(t,e){c(t,e.successClass),e.success&&e.success(t),t.removeAttribute(e.src),t.removeAttribute(e.srcset),p(e.breakpoints,function(e){t.removeAttribute(e.src)})}function n(t,e,r){r&&t.setAttribute("srcset",r),t.src=e}function o(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function c(t,e){o(t,e)||(t.className+=" "+e)}function s(t){var e=[];t=t.root.querySelectorAll(t.selector);for(var r=t.length;r--;e.unshift(t[r]));return e}function l(t){h.bottom=(window.innerHeight||document.documentElement.clientHeight)+t,h.right=(window.innerWidth||document.documentElement.clientWidth)+t}function _(t,e,r){t.attachEvent?t.attachEvent&&t.attachEvent("on"+e,r):t.addEventListener(e,r,{capture:!1,passive:!0})}function u(t,e,r){t.detachEvent?t.detachEvent&&t.detachEvent("on"+e,r):t.removeEventListener(e,r,{capture:!1,passive:!0})}function p(t,e){if(t&&e)for(var r=t.length,i=0;i<r&&!1!==e(t[i],i);i++);}function f(t,e,r){var i=0;return function(){var a=+new Date;a-i<e||(i=a,t.apply(r,arguments))}}var d,h,b,v;return function(r){if(!document.querySelectorAll){var a=document.createStyleSheet();document.querySelectorAll=function(t,e,r,i,n){for(n=document.all,e=[],t=t.replace(/\[for\b/gi,"[htmlFor").split(","),r=t.length;r--;){for(a.addRule(t[r],"k:v"),i=n.length;i--;)n[i].currentStyle.k&&e.push(n[i]);a.removeRule(0)}return e}}var n=this,o=n._util={};o.elements=[],o.destroyed=!0,n.options=r||{},n.options.error=n.options.error||!1,n.options.offset=n.options.offset||100,n.options.root=n.options.root||document,n.options.success=n.options.success||!1,n.options.selector=n.options.selector||".b-lazy",n.options.separator=n.options.separator||"|",n.options.containerClass=n.options.container,n.options.container=!!n.options.containerClass&&document.querySelectorAll(n.options.containerClass),n.options.errorClass=n.options.errorClass||"b-error",n.options.breakpoints=n.options.breakpoints||!1,n.options.loadInvisible=n.options.loadInvisible||!1,n.options.successClass=n.options.successClass||"b-loaded",n.options.validateDelay=n.options.validateDelay||25,n.options.saveViewportOffsetDelay=n.options.saveViewportOffsetDelay||50,n.options.srcset=n.options.srcset||"data-srcset",n.options.src=d=n.options.src||"data-src",v=Element.prototype.closest,b=1<window.devicePixelRatio,h={},h.top=0-n.options.offset,h.left=0-n.options.offset,n.revalidate=function(){t(n)},n.load=function(t,e){var r=this.options;void 0===t.length?i(t,e,r):p(t,function(t){i(t,e,r)})},n.destroy=function(){var t=this._util;this.options.container&&p(this.options.container,function(e){u(e,"scroll",t.validateT)}),u(window,"scroll",t.validateT),u(window,"resize",t.validateT),u(window,"resize",t.saveViewportOffsetT),t.count=0,t.elements.length=0,t.destroyed=!0},o.validateT=f(function(){e(n)},n.options.validateDelay,n),o.saveViewportOffsetT=f(function(){l(n.options.offset)},n.options.saveViewportOffsetDelay,n),l(n.options.offset),p(n.options.breakpoints,function(t){if(t.width>=window.screen.width)return d=t.src,!1}),setTimeout(function(){t(n)})}}),function(t){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],t):t(jQuery)}(function(t){function e(e){return!e||void 0!==e.allowPageScroll||void 0===e.swipe&&void 0===e.swipeStatus||(e.allowPageScroll=_),void 0!==e.click&&void 0===e.tap&&(e.tap=e.click),e||(e={}),e=t.extend({},t.fn.swipe.defaults,e),this.each(function(){var i=t(this),a=i.data(T);a||(a=new r(this,e),i.data(T,a))})}function r(e,r){function i(e){if(!(lt()||t(e.target).closest(r.excludedElements,Nt).length>0)){var i,a=e.originalEvent?e.originalEvent:e,n=a.touches,o=n?n[0]:a;return Rt=w,n?Wt=n.length:e.preventDefault(),Lt=0,Ft=null,Mt=null,Pt=0,Gt=0,Ut=0,Bt=1,qt=0,Qt=dt(),Dt=vt(),ct(),!n||Wt===r.fingers||r.fingers===g||D()?(ut(0,o),Vt=St(),2==Wt&&(ut(1,n[1]),Gt=Ut=yt(Qt[0].start,Qt[1].start)),(r.swipeStatus||r.pinchStatus)&&(i=L(a,Rt))):i=!1,i===!1?(Rt=x,L(a,Rt),i):(r.hold&&(te=setTimeout(t.proxy(function(){Nt.trigger("hold",[a.target]),r.hold&&(i=r.hold.call(Nt,a,a.target))},this),r.longTapThreshold)),_t(!0),null)}}function I(t){var e=t.originalEvent?t.originalEvent:t;if(Rt!==$&&Rt!==x&&!st()){var i,a=e.touches,n=a?a[0]:e,o=pt(n);if(Jt=St(),a&&(Wt=a.length),r.hold&&clearTimeout(te),Rt=k,2==Wt&&(0==Gt?(ut(1,a[1]),Gt=Ut=yt(Qt[0].start,Qt[1].start)):(pt(a[1]),Ut=yt(Qt[0].end,Qt[1].end),Mt=kt(Qt[0].end,Qt[1].end)),Bt=wt(Gt,Ut),qt=Math.abs(Gt-Ut)),Wt===r.fingers||r.fingers===g||!a||D()){if(Ft=Ct(o.start,o.end),q(t,Ft),Lt=$t(o.start,o.end),Pt=gt(),ht(Ft,Lt),(r.swipeStatus||r.pinchStatus)&&(i=L(e,Rt)),!r.triggerOnTouchEnd||r.triggerOnTouchLeave){var c=!0;if(r.triggerOnTouchLeave){var s=jt(this);c=Tt(o.end,s)}!r.triggerOnTouchEnd&&c?Rt=E(k):r.triggerOnTouchLeave&&!c&&(Rt=E($)),Rt!=x&&Rt!=$||L(e,Rt)}}else Rt=x,L(e,Rt);i===!1&&(Rt=x,L(e,Rt))}}function A(t){var e=t.originalEvent?t.originalEvent:t,i=e.touches;return i&&i.length?(ot(),!0):(st()&&(Wt=Yt),Jt=St(),Pt=gt(),G()||!P()?(Rt=x,L(e,Rt)):r.triggerOnTouchEnd||0==r.triggerOnTouchEnd&&Rt===k?(t.preventDefault(),Rt=$,L(e,Rt)):!r.triggerOnTouchEnd&&X()?(Rt=$,F(e,Rt,d)):Rt===k&&(Rt=x,L(e,Rt)),_t(!1),null)}function z(){Wt=0,Jt=0,Vt=0,Gt=0,Ut=0,Bt=1,ct(),_t(!1)}function O(t){var e=t.originalEvent?t.originalEvent:t;r.triggerOnTouchLeave&&(Rt=E($),L(e,Rt))}function H(){Nt.unbind(At,i),Nt.unbind(Et,z),Nt.unbind(zt,I),Nt.unbind(Ot,A),Ht&&Nt.unbind(Ht,O),_t(!1)}function E(t){var e=t,i=B(),a=P(),n=G();return!i||n?e=x:!a||t!=k||r.triggerOnTouchEnd&&!r.triggerOnTouchLeave?!a&&t==$&&r.triggerOnTouchLeave&&(e=x):e=$,e}function L(t,e){var r,i=t.touches;return Q()||W()||N()||D()?((Q()||W())&&(r=F(t,e,p)),(N()||D())&&r!==!1&&(r=F(t,e,f))):at()&&r!==!1?r=F(t,e,h):nt()&&r!==!1?r=F(t,e,b):it()&&r!==!1&&(r=F(t,e,d)),e===x&&z(t),e===$&&(i?i.length||z(t):z(t)),r}function F(e,i,_){var u;if(_==p){if(Nt.trigger("swipeStatus",[i,Ft||null,Lt||0,Pt||0,Wt,Qt]),r.swipeStatus&&(u=r.swipeStatus.call(Nt,e,i,Ft||null,Lt||0,Pt||0,Wt,Qt),u===!1))return!1;if(i==$&&R()){if(Nt.trigger("swipe",[Ft,Lt,Pt,Wt,Qt]),r.swipe&&(u=r.swipe.call(Nt,e,Ft,Lt,Pt,Wt,Qt),u===!1))return!1;switch(Ft){case a:Nt.trigger("swipeLeft",[Ft,Lt,Pt,Wt,Qt]),r.swipeLeft&&(u=r.swipeLeft.call(Nt,e,Ft,Lt,Pt,Wt,Qt));break;case n:Nt.trigger("swipeRight",[Ft,Lt,Pt,Wt,Qt]),r.swipeRight&&(u=r.swipeRight.call(Nt,e,Ft,Lt,Pt,Wt,Qt));break;case o:Nt.trigger("swipeUp",[Ft,Lt,Pt,Wt,Qt]),r.swipeUp&&(u=r.swipeUp.call(Nt,e,Ft,Lt,Pt,Wt,Qt));break;case c:Nt.trigger("swipeDown",[Ft,Lt,Pt,Wt,Qt]),r.swipeDown&&(u=r.swipeDown.call(Nt,e,Ft,Lt,Pt,Wt,Qt))}}}if(_==f){if(Nt.trigger("pinchStatus",[i,Mt||null,qt||0,Pt||0,Wt,Bt,Qt]),r.pinchStatus&&(u=r.pinchStatus.call(Nt,e,i,Mt||null,qt||0,Pt||0,Wt,Bt,Qt),u===!1))return!1;if(i==$&&M())switch(Mt){case s:Nt.trigger("pinchIn",[Mt||null,qt||0,Pt||0,Wt,Bt,Qt]),r.pinchIn&&(u=r.pinchIn.call(Nt,e,Mt||null,qt||0,Pt||0,Wt,Bt,Qt));break;case l:Nt.trigger("pinchOut",[Mt||null,qt||0,Pt||0,Wt,Bt,Qt]),r.pinchOut&&(u=r.pinchOut.call(Nt,e,Mt||null,qt||0,Pt||0,Wt,Bt,Qt))}}return _==d?i!==x&&i!==$||(clearTimeout(Zt),clearTimeout(te),Y()&&!tt()?(Kt=St(),Zt=setTimeout(t.proxy(function(){Kt=null,Nt.trigger("tap",[e.target]),r.tap&&(u=r.tap.call(Nt,e,e.target))},this),r.doubleTapThreshold)):(Kt=null,Nt.trigger("tap",[e.target]),r.tap&&(u=r.tap.call(Nt,e,e.target)))):_==h?i!==x&&i!==$||(clearTimeout(Zt),Kt=null,Nt.trigger("doubletap",[e.target]),r.doubleTap&&(u=r.doubleTap.call(Nt,e,e.target))):_==b&&(i!==x&&i!==$||(clearTimeout(Zt),Kt=null,Nt.trigger("longtap",[e.target]),r.longTap&&(u=r.longTap.call(Nt,e,e.target)))),u}function P(){var t=!0;return null!==r.threshold&&(t=Lt>=r.threshold),t}function G(){var t=!1;return null!==r.cancelThreshold&&null!==Ft&&(t=bt(Ft)-Lt>=r.cancelThreshold),t}function U(){return null===r.pinchThreshold||qt>=r.pinchThreshold}function B(){var t;return t=!r.maxTimeThreshold||!(Pt>=r.maxTimeThreshold)}function q(t,e){if(r.preventDefaultEvents!==!1)if(r.allowPageScroll===_)t.preventDefault();else{var i=r.allowPageScroll===u;switch(e){case a:(r.swipeLeft&&i||!i&&r.allowPageScroll!=v)&&t.preventDefault();break;case n:(r.swipeRight&&i||!i&&r.allowPageScroll!=v)&&t.preventDefault();break;case o:(r.swipeUp&&i||!i&&r.allowPageScroll!=m)&&t.preventDefault();break;case c:(r.swipeDown&&i||!i&&r.allowPageScroll!=m)&&t.preventDefault()}}}function M(){var t=V(),e=J(),r=U();return t&&e&&r}function D(){return!!(r.pinchStatus||r.pinchIn||r.pinchOut)}function N(){return!(!M()||!D())}function R(){var t=B(),e=P(),r=V(),i=J(),a=G(),n=!a&&i&&r&&e&&t;return n}function W(){return!!(r.swipe||r.swipeStatus||r.swipeLeft||r.swipeRight||r.swipeUp||r.swipeDown)}function Q(){return!(!R()||!W())}function V(){return Wt===r.fingers||r.fingers===g||!C}function J(){return 0!==Qt[0].end.x}function X(){return!!r.tap}function Y(){return!!r.doubleTap}function K(){return!!r.longTap}function Z(){if(null==Kt)return!1;var t=St();return Y()&&t-Kt<=r.doubleTapThreshold}function tt(){return Z()}function et(){return(1===Wt||!C)&&(isNaN(Lt)||Lt<r.threshold)}function rt(){return Pt>r.longTapThreshold&&Lt<y}function it(){return!(!et()||!X())}function at(){return!(!Z()||!Y())}function nt(){return!(!rt()||!K())}function ot(){Xt=St(),Yt=event.touches.length+1}function ct(){Xt=0,Yt=0}function st(){var t=!1;if(Xt){var e=St()-Xt;e<=r.fingerReleaseThreshold&&(t=!0)}return t}function lt(){return!(Nt.data(T+"_intouch")!==!0)}function _t(t){t===!0?(Nt.bind(zt,I),Nt.bind(Ot,A),Ht&&Nt.bind(Ht,O)):(Nt.unbind(zt,I,!1),Nt.unbind(Ot,A,!1),Ht&&Nt.unbind(Ht,O,!1)),Nt.data(T+"_intouch",t===!0)}function ut(t,e){var r=void 0!==e.identifier?e.identifier:0;return Qt[t].identifier=r,Qt[t].start.x=Qt[t].end.x=e.pageX||e.clientX,Qt[t].start.y=Qt[t].end.y=e.pageY||e.clientY,Qt[t]}function pt(t){var e=void 0!==t.identifier?t.identifier:0,r=ft(e);return r.end.x=t.pageX||t.clientX,r.end.y=t.pageY||t.clientY,r}function ft(t){for(var e=0;e<Qt.length;e++)if(Qt[e].identifier==t)return Qt[e]}function dt(){for(var t=[],e=0;e<=5;e++)t.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return t}function ht(t,e){e=Math.max(e,bt(t)),Dt[t].distance=e}function bt(t){if(Dt[t])return Dt[t].distance}function vt(){var t={};return t[a]=mt(a),t[n]=mt(n),t[o]=mt(o),t[c]=mt(c),t}function mt(t){return{direction:t,distance:0}}function gt(){return Jt-Vt}function yt(t,e){var r=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return Math.round(Math.sqrt(r*r+i*i))}function wt(t,e){var r=e/t*1;return r.toFixed(2)}function kt(){return Bt<1?l:s}function $t(t,e){return Math.round(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)))}function xt(t,e){var r=t.x-e.x,i=e.y-t.y,a=Math.atan2(i,r),n=Math.round(180*a/Math.PI);return n<0&&(n=360-Math.abs(n)),n}function Ct(t,e){var r=xt(t,e);return r<=45&&r>=0?a:r<=360&&r>=315?a:r>=135&&r<=225?n:r>45&&r<135?c:o}function St(){var t=new Date;return t.getTime()}function jt(e){e=t(e);var r=e.offset(),i={left:r.left,right:r.left+e.outerWidth(),top:r.top,bottom:r.top+e.outerHeight()};return i}function Tt(t,e){return t.x>e.left&&t.x<e.right&&t.y>e.top&&t.y<e.bottom}var It=C||j||!r.fallbackToMouseEvents,At=It?j?S?"MSPointerDown":"pointerdown":"touchstart":"mousedown",zt=It?j?S?"MSPointerMove":"pointermove":"touchmove":"mousemove",Ot=It?j?S?"MSPointerUp":"pointerup":"touchend":"mouseup",Ht=It?null:"mouseleave",Et=j?S?"MSPointerCancel":"pointercancel":"touchcancel",Lt=0,Ft=null,Pt=0,Gt=0,Ut=0,Bt=1,qt=0,Mt=0,Dt=null,Nt=t(e),Rt="start",Wt=0,Qt=null,Vt=0,Jt=0,Xt=0,Yt=0,Kt=0,Zt=null,te=null;try{Nt.bind(At,i),Nt.bind(Et,z)}catch(e){t.error("events not supported "+At+","+Et+" on jQuery.swipe")}this.enable=function(){return Nt.bind(At,i),Nt.bind(Et,z),Nt},this.disable=function(){return H(),Nt},this.destroy=function(){H(),Nt.data(T,null),Nt=null},this.option=function(e,i){if(void 0!==r[e]){if(void 0===i)return r[e];r[e]=i}else t.error("Option "+e+" does not exist on jQuery.swipe.options");return null}}var i="1.6.9",a="left",n="right",o="up",c="down",s="in",l="out",_="none",u="auto",p="swipe",f="pinch",d="tap",h="doubletap",b="longtap",v="horizontal",m="vertical",g="all",y=10,w="start",k="move",$="end",x="cancel",C="ontouchstart"in window,S=window.navigator.msPointerEnabled&&!window.navigator.pointerEnabled,j=window.navigator.pointerEnabled||window.navigator.msPointerEnabled,T="TouchSwipe",I={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,hold:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"label, button, input, select, textarea, a, .noSwipe",preventDefaultEvents:!0};t.fn.swipe=function(r){var i=t(this),a=i.data(T);if(a&&"string"==typeof r){if(a[r])return a[r].apply(this,Array.prototype.slice.call(arguments,1));t.error("Method "+r+" does not exist on jQuery.swipe")}else if(!(a||"object"!=typeof r&&r))return e.apply(this,arguments);return i},t.fn.swipe.version=i,t.fn.swipe.defaults=I,t.fn.swipe.phases={PHASE_START:w,PHASE_MOVE:k,PHASE_END:$,PHASE_CANCEL:x},t.fn.swipe.directions={LEFT:a,RIGHT:n,UP:o,DOWN:c,IN:s,OUT:l},t.fn.swipe.pageScroll={NONE:_,HORIZONTAL:v,VERTICAL:m,AUTO:u},t.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:g}}),Garment.prototype.getCurrentLayers=function(){return this.current},Garment.prototype.parseImages=function(t,e,r){layers=this.getLayers(),layers=this.parseLayers(layers,e,r),final_images=[];for(key in t){var i=t[key];array_push(final_images,[layers[i.layer].src+i.src,i.zIndex,i.class,i.render])}return final_images},Garment.prototype.renderDraw=function(t,e,r){var i=this;t||(t="STD"),this.current.size=t,"man_suit2"==i.product_type&&"without_model"==i.current.view&&"man_pants"==this.current.config._active_block&&(this.current.config._active_block="man_jacket"),"blouse_cuffs"==i.last_change||"blouse_cuff"==i.last_change?(this.current.inner_strip_desactive=!0,i.last_change=""):this.current.inner_strip_desactive=!1;var a=this.renderGetImages(),n=$(".loading"),o=i.render;if("BIG"==t&&(o=i.render_zoom,n=$(".image_render_full .loading")),webp_support)for(var c in a){var s=a[c][0].replace("png","webp");a[c][0]=s}o.find("img").addClass("delete"),e!=r&&o.find("img.delete").remove();var l=[];for(var _ in a){var u=o.find("img[src$='"+a[_][0]+"']");u.length?(u.attr("class",""),a[_][2]&&u.addClass(a[_][2])):l.push(_)}if(l.length){n.addClass("active");var p=0;for(var _ in l){var f=a[l[_]][3];0!=f&&(f+="/"),u=$('<img onerror = "" src="'+a[l[_]][0]+'" alt="" render = '+f+">").on("load",function(){p++,p==l.length&&(n.removeClass("active"),o.find("img").show(),o.find("img.delete").remove(),$(".loading_personalize").hide())}).hide().appendTo(o).css("zIndex",a[l[_]][1]).attr("class","").each(function(){}).on("error",function(){var t=$(this).attr("render"),e=$(this);e.hide(),"/services/render_shirt/render_shirt_to_jacket/"==t?$.ajax({url:t+i.current.fabric.shirt_to_jacket_id+"/BIG/"+i.current.view,async:!1,type:"get",success:function(t){if("error"!=t){var r=t;e.attr("src",r+"?ok=true"),e.show()}}}):"/services/render_shirt/render_shirt_to_jacket_open/"==t?$.ajax({url:t+i.current.fabric.shirt_to_jacket_id,async:!1,type:"get",success:function(t){if("error"!=t){var r=t;e.attr("src",r+"?ok=true"),e.show()}}}):"/services/render_shirt/render_shirt_to_pants/"==t?$.ajax({url:t+i.current.fabric.shirt_to_jacket_id+"/BIG/"+i.current.view,async:!1,type:"get",success:function(t){if("error"!=t){var r=t;e.attr("src",r+"?ok=true"),e.show()}}}):"/services/render_shirt/render_shirt_to_pants_open/"==t?$.ajax({url:t+i.current.fabric.shirt_to_jacket_id,async:!1,type:"get",success:function(t){if("error"!=t){var r=t;e.attr("src",r+"?ok=true"),e.show()}}}):"/services/render_shirt/render_shirt_to_smoking/"==t&&$.ajax({url:t+i.current.fabric.shirt_to_jacket_id+"/BIG/"+i.current.view,async:!1,type:"get",success:function(t){if("error"!=t){var r=t;e.attr("src",r+"?ok=true"),e.show()}}}),p++,p==l.length&&(n.removeClass("active"),o.find("img").show(),o.find("img.delete").remove(),$(".loading_personalize").hide())}),a[l[_]][2]&&u.addClass(a[l[_]][2])}}else o.find("img.delete").remove()},Garment.prototype.parseLayers=function(t,e,r){r||(r="STD");var i=1,a=!1,n=!1;if("undefined"!=typeof e.extras.button_holes_threads){if(e.extras.button_holes_threads["holes-color"]){a=!0;var o=e.extras.button_holes_threads["holes-color"]}if(e.extras.button_holes_threads["threads-color"]){n=!0;var c=e.extras.button_holes_threads["threads-color"]}}var s=!1;"undefined"!=typeof e.extras.contrasts&&"1"==e.extras.contrasts.contrast&&(s=!0,"undefined"==typeof e.extras.contrasts.contrasts_flap||empty(e.extras.contrasts.contrasts_flap)||(e.fabric.extra_satin_jacket_lapel=e.extras.contrasts.contrasts_flap),"undefined"==typeof e.extras.contrasts.contrasts_pockets||empty(e.extras.contrasts.contrasts_pockets)||(e.fabric.extra_satin_jacket_pockets=e.extras.contrasts.contrasts_pockets),"undefined"==typeof e.extras.contrasts.contrasts_buttons||empty(e.extras.contrasts.contrasts_buttons)||(e.fabric.extra_satin_jacket_buttons=e.extras.contrasts.contrasts_buttons,e.fabric.extra_satin_pants_buttons=e.extras.contrasts.contrasts_buttons),"undefined"==typeof e.extras.contrasts.contrasts_pants||empty(e.extras.contrasts.contrasts_pants)||(e.fabric.extra_satin_pants_ribbon=e.extras.contrasts.contrasts_pants)),view=e.view,"without_model"==e.view&&(view="front");for(k in t){t[k];for(key in e.fabric){var l=e.fabric[key];strpos(key,"_")!==!1&&"lining_id"!=key&&(t[k].src=str_replace("#"+key+"#",l,t[k].src))}switch(t[k].src.indexOf("new_man/pants")>0&&"without_model"==e.view&&(view="folded"),t[k].src.indexOf("new_man/jacket")>0&&"without_model"==e.view&&(view="front"),t[k].src=str_replace("#view#",view,t[k].src),
    t[k].src=str_replace("#size#",r,t[k].src),t[k].src=str_replace("#model#",i,t[k].src),this.product_type){case"man_shirt":t[k].src=str_replace("#neck_fabric_id#",this.current.extras.neck_fabric.fabric_id,t[k].src),t[k].src=str_replace("#cuffs_fabric_id#",e.extras.cuffs_fabric.fabric_id,t[k].src),t[k].src=str_replace("#patches_fabric_id#",e.extras.patches.fabric_id,t[k].src),a&&(t[k].src=str_replace("#hole_code_extra#",o,t[k].src)),n&&(t[k].src=str_replace("#thread_code_extra#",c,t[k].src)),"undefined"!=typeof this.current.extras.winter_lining&&"personalizado"==this.current.extras.winter_lining.contrast&&(t[k].src=str_replace("#winter_lining_id#",this.current.extras.winter_lining.color,t[k].src));break;case"man_jacket":case"man_suit":case"man_suit2":case"man_smoking":if(t[k].src=str_replace("#shirt_to_jacket_id#",this.current.fabric.shirt_to_jacket_id,t[k].src),t[k].src=str_replace("#man_jacket#",this.current.fabric.man_smoking,t[k].src),"undefined"!=typeof this.current.extras.metal_buttons&&"personalizado"==this.current.extras.metal_buttons.contrast?t[k].src=str_replace("#botones_jacket_id#",this.current.extras.metal_buttons.type,t[k].src):t[k].src=str_replace("#botones_jacket_id#",this.current.fabric._button_code,t[k].src),"undefined"!=typeof this.current.extras.metal_buttons){if("undefined"!=typeof this.current.extras.button_holes_threads&&"undefined"!=typeof this.current.extras.button_holes_threads["threads-color"]&&this.current.extras.button_holes_threads["threads-color"]&&"personalizado"!=this.current.extras.metal_buttons.contrast){var _=this.current.extras.button_holes_threads["threads-color"];t[k].src=str_replace("#hilos_jacket_id#",_,t[k].src)}}else if("undefined"!=typeof this.current.extras.button_holes_threads&&"undefined"!=typeof this.current.extras.button_holes_threads["threads-color"]){var _=this.current.extras.button_holes_threads["threads-color"];t[k].src=str_replace("#hilos_jacket_id#",_,t[k].src)}if("undefined"!=typeof this.current.extras.button_holes_threads)if("undefined"!=typeof this.current.extras.button_holes_threads["holes-color"]){if(this.current.extras.button_holes_threads["holes-color"]){var u=this.current.extras.button_holes_threads["holes-color"];t[k].src=str_replace("#ojales_jacket_id#",u,t[k].src)}}else{var p="dark",f=["white","beige","green","pink","orange","yellow","purple","light"],d=[1083,1444,1477,1479,1283,1081,1082,1062,1457],h=$('#fabric a[rel="'+this.current.fabric.man_jacket+'"]').attr("tone");jQuery.inArray(h,f)>=0&&(p="light"),jQuery.inArray(this.current.fabric.man_jacket,d)>=0&&(p="light"),t[k].src=str_replace("#ojales_jacket_id#",p,t[k].src)}if("personalizado"==this.current.extras.lining.contrast||"padded"==this.current.extras.lining.contrast?t[k].src=str_replace("#lining_id#",this.current.extras.lining.lining_id,t[k].src):"unlined"==this.current.extras.lining.contrast?t[k].src=str_replace("#lining_id#",this.current.fabric.unlined_lining,t[k].src):t[k].src=str_replace("#lining_id#",this.current.fabric.lining_id,t[k].src),"undefined"!=typeof this.current.extras.waistcoat_lining&&"personalizado"==this.current.extras.waistcoat_lining.contrast?t[k].src=str_replace("#lining_id_waistcoat#",this.current.extras.waistcoat_lining.lining_id,t[k].src):t[k].src=str_replace("#lining_id_waistcoat#",this.current.fabric.waistcoat_lining_id,t[k].src),"undefined"!=typeof this.current.extras.waistcoat_lining_back&&"personalizado"==this.current.extras.waistcoat_lining_back.contrast?t[k].src=str_replace("#lining_id_back_waistcoat#",this.current.extras.waistcoat_lining_back.lining_id,t[k].src):t[k].src=str_replace("#lining_id_back_waistcoat#",this.current.fabric.waistcoat_lining_id,t[k].src),"undefined"!=typeof this.current.extras.neck_lining&&this.current.extras.neck_lining.color&&(t[k].src=str_replace("#cuello_id#",this.current.extras.neck_lining.color,t[k].src)),"undefined"!=typeof this.current.extras.patches&&this.current.extras.patches.patches&&(t[k].src=str_replace("#coderas_id#",this.current.extras.patches.patches,t[k].src)),"undefined"!=typeof this.current.extras.waistcoat_metal_buttons){if("undefined"!=typeof this.current.extras.waistcoat_button_holes_threads&&"undefined"!=typeof this.current.extras.waistcoat_button_holes_threads["threads-color"]&&this.current.extras.waistcoat_button_holes_threads["threads-color"]){var _=this.current.extras.waistcoat_button_holes_threads["threads-color"];t[k].src=str_replace("#waistcoat_hilos_code#",_,t[k].src)}}else if("undefined"!=typeof this.current.extras.waistcoat_button_holes_threads&&"undefined"!=typeof this.current.extras.waistcoat_button_holes_threads["threads-color"]){var _=this.current.extras.waistcoat_button_holes_threads["threads-color"];t[k].src=str_replace("#waistcoat_hilos_code#",_,t[k].src)}if("undefined"!=typeof this.current.extras.waistcoat_metal_buttons){if("undefined"!=typeof this.current.extras.waistcoat_button_holes_threads&&"undefined"!=typeof this.current.extras.waistcoat_button_holes_threads["holes-color"]&&this.current.extras.waistcoat_button_holes_threads["holes-color"]){var u=this.current.extras.waistcoat_button_holes_threads["holes-color"];t[k].src=str_replace("#waistcoat_ojales_code#",u,t[k].src)}}else if("undefined"!=typeof this.current.extras.waistcoat_button_holes_threads&&"undefined"!=typeof this.current.extras.waistcoat_button_holes_threads["holes-color"]){var u=this.current.extras.waistcoat_button_holes_threads["holes-color"];t[k].src=str_replace("#waistcoat_ojales_code#",u,t[k].src)}"undefined"!=typeof this.current.extras.waistcoat_metal_buttons&&"personalizado"==this.current.extras.waistcoat_metal_buttons.contrast?t[k].src=str_replace("#waistcoat_button_code_id#",this.current.extras.waistcoat_metal_buttons.type,t[k].src):t[k].src=str_replace("#waistcoat_button_code_id#",this.current.fabric._button_code,t[k].src),"undefined"!=typeof this.current.extras.quilted_waistcoat&&this.current.extras.quilted_waistcoat.color&&(t[k].src=str_replace("#quilted_waistcoat_id#",this.current.extras.quilted_waistcoat.color,t[k].src)),"man_smoking"==this.product_type&&("undefined"!=typeof this.current.extras.contrasts&&this.current.extras.contrasts.contrasts_buttons?t[k].src=str_replace("#satin_jacket_buttons#",this.current.extras.contrasts.contrasts_buttons,t[k].src):t[k].src=str_replace("#satin_jacket_buttons#",this.current.satin_jacket_buttons,t[k].src),"undefined"!=typeof this.current.extras.contrasts&&this.current.extras.contrasts.contrasts_flap?t[k].src=str_replace("#satin_jacket_lapel#",this.current.extras.contrasts.contrasts_flap,t[k].src):t[k].src=str_replace("#satin_jacket_lapel#",this.current.satin_jacket_lapel,t[k].src),"undefined"!=typeof this.current.extras.contrasts&&this.current.extras.contrasts.contrasts_pockets?t[k].src=str_replace("#satin_jacket_pockets#",this.current.extras.contrasts.contrasts_pockets,t[k].src):t[k].src=str_replace("#satin_jacket_pockets#",this.current.satin_jacket_pockets,t[k].src),"undefined"!=typeof this.current.extras.contrasts&&this.current.extras.contrasts.contrasts_buttons?t[k].src=str_replace("#satin_pants_buttons#",this.current.extras.contrasts.contrasts_buttons,t[k].src):t[k].src=str_replace("#satin_pants_buttons#",this.current.satin_pants_buttons,t[k].src),"undefined"!=typeof this.current.extras.contrasts&&this.current.extras.contrasts.contrasts_pants?t[k].src=str_replace("#satin_pants_ribbon#",this.current.extras.contrasts.contrasts_pants,t[k].src):t[k].src=str_replace("#satin_pants_ribbon#",this.current.satin_pants_ribbon,t[k].src));break;case"man_waistcoat":if("personalizado"==this.current.extras.waistcoat_lining.contrast?t[k].src=str_replace("#lining_id_waistcoat#",this.current.extras.waistcoat_lining.lining_id,t[k].src):t[k].src=str_replace("#lining_id_waistcoat#",this.current.fabric.waistcoat_lining_id,t[k].src),"personalizado"==this.current.extras.waistcoat_lining_back.contrast?t[k].src=str_replace("#lining_id_back_waistcoat#",this.current.extras.waistcoat_lining_back.lining_id,t[k].src):t[k].src=str_replace("#lining_id_back_waistcoat#",this.current.fabric.waistcoat_lining_id,t[k].src),"undefined"!=typeof this.current.extras.waistcoat_button_holes_threads){if("undefined"!=typeof this.current.extras.waistcoat_button_holes_threads["threads-color"]&&this.current.extras.waistcoat_button_holes_threads["threads-color"]){var _=this.current.extras.waistcoat_button_holes_threads["threads-color"];t[k].src=str_replace("#waistcoat_hilos_code#",_,t[k].src)}if("undefined"!=typeof this.current.extras.waistcoat_button_holes_threads["holes-color"]&&this.current.extras.waistcoat_button_holes_threads["holes-color"]){var u=this.current.extras.waistcoat_button_holes_threads["holes-color"];t[k].src=str_replace("#waistcoat_ojales_code#",u,t[k].src)}}"undefined"!=typeof this.current.extras.waistcoat_metal_buttons&&"personalizado"==this.current.extras.waistcoat_metal_buttons.contrast?t[k].src=str_replace("#waistcoat_button_code_id#",this.current.extras.waistcoat_metal_buttons.type,t[k].src):t[k].src=str_replace("#waistcoat_button_code_id#",this.current.fabric._button_code,t[k].src);break;case"man_coat":"undefined"!=typeof this.current.extras.quilted_waistcoat&&this.current.extras.quilted_waistcoat.color&&(t[k].src=str_replace("#quilted_waistcoat_id#",this.current.extras.quilted_waistcoat.color,t[k].src)),"undefined"!=typeof this.current.extras.contrast_collar&&this.current.extras.contrast_collar.color&&(t[k].src=str_replace("#contrast_collar_id#",this.current.extras.contrast_collar.color,t[k].src)),"custom"==this.current.extras.coat_lining.contrast||"padded"==this.current.extras.coat_lining.contrast?t[k].src=str_replace("#lining_id#",this.current.extras.coat_lining.lining_id,t[k].src):t[k].src=str_replace("#lining_id#",this.current.fabric.lining_id,t[k].src),t[k].src=str_replace("#zipper_color#",this.current.fabric.zipper_color,t[k].src),t[k].src=str_replace("#ribbon_color#",this.current.fabric.ribbon_color,t[k].src),t[k].src=str_replace("#button_code#",this.current.fabric.button_code,t[k].src)}t[k].src=str_replace("#pant_code#",this.current.fabric.pant_code,t[k].src),t[k].src=str_replace("#shoes#",this.current.fabric.shoe_color,t[k].src),t[k].src=str_replace("#tie#",this.current.fabric.tie,t[k].src),load_to_local?t[k].src=t[k].src.replace(/^\//,"http://lrender.tailor4less.com/"):t[k].src=t[k].src.replace(/^\//,window.cdn_host)}return t},Garment.prototype.renderInitials=function(){function t(t,e){for(var r in e)t.setAttribute(r,e[r])}var e=this,r=e.product_type.replace("woman_","");r+="_","woman_suitpants"==e.product_type||"woman_suitskirt"==e.product_type?r="jacket_":"man_shirt"==e.product_type||"man_jacket"==e.product_type||"man_suit"==e.product_type||"man_suit2"==e.product_type||"man_smoking"==e.product_type?r="":"man_waistcoat"==e.product_type&&(r="waistcoat_"),r+="initials";var i=e.current.extras[r],a=i.text,n=i.color_custom,o=i.pos,c=i.type;if(a&&n&&c&&("front"==e.current.view||"without_model"==e.current.view||"folded"==e.current.view)){24==c?c="Arial":21==c||19==c?c="Monotype Corsiva":23==c||74==c?c="Times New Roman":22==c?c="Rockwell":22!=c&&77!=c||(c="Rockwell"),20==n?n="2361ad":21==n?n="ffcf10":22==n?n="a48239":23==n?n="e63b85":26==n?n="dd2535":27==n?n="ffffff":28==n?n="34a547":29==n?n="000000":24==n?n="b3b3b3":35==n?n="ff7912":36==n?n="731422":37==n?n="5d1970":38==n?n="b8f2f2":39==n?n="3d2a26":40==n&&(n="4477cf"),9==n?n="ffcf10":11==n?n="2361ad":12==n?n="ffffff":13==n?n="a48239":14==n?n="741422":15==n?n="b3b3b3":16==n?n="3d2a26":17==n?n="000000":18==n?n="e63b85":19==n?n="34a547":25==n?n="eb1d1d":31==n?n="ff7912":32==n?n="5f1970":33==n?n="b8f2f2":34==n&&(n="4477cf");var s="<div id='initials_3d'></div>";$("#initials_svg").append(s);var l=$("#initials_svg").empty().get(0);l.setAttribute("width",$(".image_render .layers").width());var _=document.createElementNS("http://www.w3.org/2000/svg","text");_.textContent=a;var u="7",p=1e3;switch(o||(o="interior"),o){case"high":switch(e.current.view){case"front":p=ie_navigator?45:155,t(_,{x:253,y:p,transform:"rotate(3,170,155)"}),u="7";break;case"back":break;case"side":t(_,{x:263,y:145,transform:"rotate(5,0,0)","letter-spacing":"-2px"}),u="8";break;case"folded":t(_,{x:310,y:350,transform:"rotate(1,170,155)"}),u="12"}break;case"medium":switch(e.current.view){case"front":p=ie_navigator?153:253,t(_,{x:253,y:253,transform:"rotate(2,170,155)"});break;case"back":break;case"side":t(_,{x:273,y:233,transform:"rotate(5,0,0)","letter-spacing":"-3px"}),u="8";break;case"folded":}break;case"low":switch(e.current.view){case"front":p=ie_navigator?235:335,t(_,{x:256,y:335,transform:"rotate(2,170,155)"});break;case"back":break;case"side":break;case"folded":}break;case"cuff":switch(e.current.view){case"front":"man_shirt"==e.product_type?(p=ie_navigator?300:40,t(_,{x:370,y:415,transform:"rotate(8,180,145)"}),u="5"):(p=ie_navigator?300:40,t(_,{x:355,y:420,transform:"rotate(7,180,145)"}));break;case"back":break;case"side":break;case"folded":}break;case"interior":switch(e.current.view){case"front":case"without_model":t(_,{x:176,y:150,transform:"rotate(345,160,80)"}),u="20";break;case"back":break;case"side":break;case"folded":}}t(_,{"font-family":c,"font-size":u+"px",fill:"#"+n}),l.appendChild(_)}else $("#initials_svg").empty()},Garment.prototype.relationsApply=function(t,e){function r(e,r){var n=$(e.css_selector,i.container);if(!n.length)return!0;switch(e.rel_type){case"disable":if(r){var o=!1;for(var c in i._relations_active)if(c!=t)for(var s in i._relations_active[c])if("disable"==i._relations_active[c][s].rel_type){var l=i._relations_active[c][s];if(l.block!=e.block)continue;if(l.field_name!=e.field_name)continue;if(l.field_values&&e.field_values);else if(l.field_values);else if(!e.field_values){o=!0;break}}if(o)break}var _=r?"show":"hide";if("fabric"==e.step)!r&&$.inArray(e.block,a)<0&&a.push(e.block);else if("extra"==e.step)if(e.field_values)for(var u in e.field_values)"show"==_?n.removeClass("not_show"):n.addClass("not_show");else n[_](),"show"==_?n.removeClass("not_show"):n.addClass("not_show");else if(e.field_values)if(n.hasClass("box_opt")||n.hasClass("subbox_opt")){var p=!1;for(var u in e.field_values)"checkbox"==e.field_values[u]?($(".checkbox_option",n)[_](),"show"==_?$(".checkbox_option",n).removeClass("not_show"):$(".checkbox_option",n).addClass("not_show")):($('.option_trigger[rel="'+e.field_values[u]+'"]',n)[_](),"show"==_?$('.option_trigger[rel="'+e.field_values[u]+'"]',n).removeClass("not_show"):$('.option_trigger[rel="'+e.field_values[u]+'"]',n).addClass("not_show"),"hide"==_?$('.option_trigger[rel="'+e.field_values[u]+'"]',n).addClass("no_active"):$('.option_trigger[rel="'+e.field_values[u]+'"]',n).removeClass("no_active"),$('.option_trigger[rel="'+e.field_values[u]+'"]',n).hasClass("active")&&(p=!0));p&&$(".option_trigger:not(.no_active)",n).first().click()}else for(var u in e.field_values){var f=n.find('input[value="'+e.field_values[u]+'"]');if(f.closest(".option")[_](),"show"==_?f.closest(".option").removeClass("not_show"):f.closest(".option").addClass("not_show"),"show"==_?(f.closest(".option").addClass("visible"),f.closest(".option").removeClass("oculto")):(f.closest(".option").addClass("oculto"),f.closest(".option").removeClass("visible")),f.is(":active")){var d=f.attr("name");i.mobile_enabled?$("#"+d+"_opt label").not(".oculto").first().children("input").click():$("div."+d+" label:visible:first").children("input").click()}}else n[_](),"show"==_?n.removeClass("not_show"):n.addClass("not_show"),r&&(n.find("input:checked").length||n.find("input:eq(0)").prop("selected",1).click());break;case"set":if(!id_cart_product&&!id_shop_order_detail&&!id_feed_product){if("config"!=e.step)break;if(!e.field_values)break;if(n.hasClass("box_opt")||n.hasClass("subbox_opt"))$('.option_trigger[rel="'+e.field_values[0]+'"]',n).click();else{var f=n.find('input[value="'+e.field_values[u]+'"]'),d=f.attr("name");i.mobile_enabled?$("#"+d+"_opt label").not(".oculto").first().children("input").click():$("div."+d+" label:visible:first").children("input").click()}}break;case"default":}}var i=this,a=[];if("undefined"!=typeof this._relations_active[t])for(var n in this._relations_active[t])r(this._relations_active[t][n],!0);this._relations_active[t]=[];for(var n in e){var o=this.relationParse(e[n]);r(o),this._relations_active[t].push(o)}},Garment.prototype.relationParse=function(t){var e,r,i={rel_type:!1,step:!1,block:!1,field_name:!1,field_values:!1,css_selector:!1};if(e=t.split("#"),i.rel_type=e[0],e=e[1].split(":"),r="#"+e[0],i.step=e[0],e.length>1&&(i.block=e[1]),e.length>2){if("shirt_neck_options"==e[2])r=".box_opt div.neck_options";else if("shirt_neck_no_interfacing"==e[2])r='.box_opt div[name="'+e[2]+'"]';else if("type_flap"==e[2])r=".box_opt #type_flap";else if("extra"==i.step)r=".container_options ul.options_list li."+e[2];else{r=".container_options ul.options_list li."+e[2];var a=$(r,this.container);a.length||(r=".box_opt .subbox_opt#"+e[2])}i.field_name=e[2]}return e.length>3&&(r="buttonthreads_color"==e[3]?" .box_opt#"+e[2]+" div."+e[3]:"extra"==i.step?" .box_opt#"+e[2]+' .option_trigger[rel="'+e[3]+'"]':"#"+e[2],i.field_values=e[3].trim("[]").split(",")),i.css_selector=r,i};var fabricPreview=new function(){this.preview_fabric=!1,this.hidden=!0,this.samples_window=!1,String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},this.init=function(t){var e=this;this.preview_fabric||(this.preview_fabric=$(".preview_fabric")),this.active_info_bars=t,this.active_info_bars?($(".info",this.preview_fabric).addClass("openable"),this.preview_fabric.on("click",".samples",function(t){var r=$("a",this).attr("href"),i=r;if(r.indexOf(window.location.hostname)==-1&&(i="https://"+window.location.hostname+r),!e.samples_window||e.samples_window.closed)return e.samples_window=window.open(i,"_blank"),!1;var a=r.match(/\?(.*)$/);if(a){for(var n={},o=a[1].split("&"),c=0;c<o.length;c++){var s=o[c].split("=");n[decodeURIComponent(s[0])]=decodeURIComponent(s[1]||"")}e.samples_window.postMessage(n,i),e.samples_window.focus()}return!1}),this.preview_fabric.on("click",".more_info",function(t){return!!$(".info",this.preview_fabric).hasClass("openable")&&($(".info",e.preview_fabric).hasClass("open")?($(".info",e.preview_fabric).removeClass("open"),e.hidden=!0):($(".info",e.preview_fabric).addClass("open"),e.hidden=!1),!1)}),this.preview_fabric.on("click",".hide_info",function(t){return $(".info",e.preview_fabric).removeClass("open"),e.hidden=!0,!1}),this.preview_fabric.on("click",".info",function(t){return!!$(".info",this.preview_fabric).hasClass("openable")&&($(".info",e.preview_fabric).hasClass("open")?($(".info",e.preview_fabric).removeClass("open"),e.hidden=!0):($(".info",e.preview_fabric).addClass("open"),e.hidden=!1),!1)})):($(".info",this.preview_fabric).removeClass("openable"),e.hidden=!0);var r=$(window).width();r>1440&&($(".info",e.preview_fabric).addClass("open"),e.hidden=!1)},this.close=function(){this.preview_fabric.hide(),this.hidden=!0},this.show=function(t,e,r,i,a){this.hidden=!0;var n="",o="";"lining"==e?(n="default",o="big"):(n=r,n=n.replace("woman_",""),n=n.replace("man_",""),"pants"!=n&&"skirt"!=n&&"jacket"!=n&&"suit2"!=n&&"waistcoat"!=n&&"smoking"!=n&&"suitpants"!=n&&"suitskirt"!=n||(n="suit"),o="huge");var c=t.id_fabric,s=window.cdn_host,l=e;"extra"==l&&(l="fabric");var _=s+"dimg/"+l+"/"+n+"/"+c+"_"+o+".jpg";$(".image img",this.preview_fabric).attr("src",_),$(".image img",this.preview_fabric).attr("onerror","this.src='"+_+"';"),"undefined"!=typeof $("a.link_samples").attr("href")&&$("a.link_samples",this.preview_fabric).attr("href",$("a.link_samples").attr("href").split("?")[0]+"?fabric_type=suit&ref="+c),$(".header .new").hide(),$(".fabric_options_description .category_group").removeClass("active"),$(".fabric_options .category_group .more").css("visibility","visible"),$(".category_group",this.preview_fabric).removeClass("grey"),$(".season, .thread_style, .brightness,.stretchy_text, .material, .tone,.details .weight, .thread_count, .opacity, .waterproof, .samples, .samples, .fabric_options, .super_shiny, .stretchy",this.preview_fabric).hide(),$(".info",this.preview_fabric).removeClass("openable");var u=t.title;if($(".details .title",this.preview_fabric).html(u),$(".info[class*='fabric_type_']",this.preview_fabric).removeClass(function(t,e){return(e.match(/(^|\s)fabric_type_\S+/g)||[]).join(" ")}),$(".info",this.preview_fabric).addClass("fabric_type_"+n),"fabric"==e){$(".info",this.preview_fabric).addClass("openable"),"undefined"!=typeof t.samples&&t.samples>0&&$(".samples",this.preview_fabric).show(),$(".fabric_options",this.preview_fabric).show();var p=t.new;"1"==p&&$(".header .new").show();var f=t.composition;"linen"==f&&(f="100linen");for(var d,h=/(\d+)([a-z]+)/g,b=[],v=!1;d=h.exec(f);)b.push(d[1]+"% "+("undefined"==typeof i[d[2]]?d[2]:i[d[2]]));b.length?v=b.join(" &amp; "):"undefined"!=typeof i[f]&&(v=i[f]),v&&$(".header .composition",this.preview_fabric).html(" - "+v).show();var m=i[t.season];m&&$(".details .season",this.preview_fabric).html(m.capitalize()).show();var g=t.thread_style;g&&$(".details .thread_style",this.preview_fabric).html(" - "+g.capitalize()).show();var y=t.brightness,w=i[y];"midshining"!=y&&"shining"!=y||$(".details .brightness",this.preview_fabric).html(" - "+w.capitalize()).show(),"midshining"!=t.brightness&&"shining"!=t.brightness||$(".details .super_shiny",this.preview_fabric).show();var k=i[t.tone];k&&$(".details .tone",this.preview_fabric).html(" - "+k.capitalize()).show();var x=t.fabric_weight;x>0&&("undefined"==typeof a||"en-uk"!=a&&"en-us"!=a?x+=" gr/m2":(x=Math.round(.042187*x*100)/100,x+=" oz/yd2"),$(".details .weight",this.preview_fabric).html(" - "+x).show());var C=t.thread_count;C>0&&$(".details .thread_count",this.preview_fabric).html(" - Super "+C.capitalize()+"s").show();var S=i["opacity_"+t.opacity],j=t.opacity;S&&"full"!=j&&$(".details .opacity",this.preview_fabric).html(" - "+S.capitalize()).show();var T="";t.price>0?(T=format_price(t.price,"small_symbol",window.currency_json),T="(+"+T+")",$(".category_group.category .price",this.preview_fabric).html(T)):$(".category_group.category .price_box",this.preview_fabric).html("");var I=t.category_group;$(".fabric_options .category_group").removeClass("active"),$(".fabric_options_description .category_group").removeClass("active"),"premium"==I?$(".fabric_options .category_group.premium").addClass("active"):"limited"==I&&$(".fabric_options .category_group.limited").addClass("active");var A=t.tags;A&&(A=A.split(","));var z=!1,O=!1,H=!1,E=!1;for(var L in A)"oeko"==A[L]&&(z=!0),"easy"==A[L]&&(O=!0),"wrinkle"==A[L]&&(H=!0),"waterproof"==A[L]&&(E=!0);if(1==z&&$(".fabric_options .category_group.oeko").addClass("active"),1==O&&$(".fabric_options .category_group.easy").addClass("active"),1==H&&$(".fabric_options .category_group.wrinkle").addClass("active"),1==E){var F=i.waterproof;$(".details .waterproof",this.preview_fabric).html(" - "+F.capitalize()).show()}if(t.stretchy>0){var P=i.stretchy;$(".details .stretchy_text",this.preview_fabric).html(" - "+P.capitalize()).show(),$(".details .stretchy",this.preview_fabric).show()}var v=!1,v=i[f];"100% merino wool"==v&&$(".fabric_options .category_group.wool").addClass("active");var G=!1,G=t.shirt_yarn;"1"==G&&$(".fabric_options .category_group.2ply").addClass("active");var U=t.bars.excelence,B=$(".bar.excelence");$(".subar",B).removeClass("active");for(var q=1;q<=U;q++)$(".subar.bar_"+q,B).addClass("active");var M=t.bars.hot,D=$(".bar.warmth");$(".subar",D).removeClass("active");for(var q=1;q<=M;q++)$(".subar.bar_"+q,D).addClass("active");var N=t.bars.weight,R=$(".bar.weight");$(".subar",R).removeClass("active");for(var q=1;q<=N;q++)$(".subar.bar_"+q,R).addClass("active");if($(".bar.weight .subar").html(" "),t.fabric_weight>0){x=t.fabric_weight;var W=q-1;"undefined"==typeof a||"en-uk"!=a&&"en-us"!=a?x+=" gr/m2":(x=Math.round(.042187*x*100)/100,x+=" oz/yd2"),$(".bar.weight .bar_"+W).html("<span>"+x+"</span>")}var Q=t.bars.fineza,V=$(".bar.fineza");$(".subar",V).removeClass("active");for(var q=1;q<=Q;q++)$(".subar.bar_"+q,V).addClass("active")}else if("lining"==e||"extra"==e){$(".info",this.preview_fabric).removeClass("openable").removeClass("open");var y=t.brightness,w=i[y];w&&$(".details .brightness",this.preview_fabric).html(w.capitalize()).show();var J=i[t.material];J&&("woman_trenchcoat"!=this.product_type&&"man_trenchcoat"!=this.product_type&&y?$(".details .material",this.preview_fabric).html(" - "+J.capitalize()).show():$(".details .material",this.preview_fabric).html(J.capitalize()).show()),$(".details .composition").hide(),$(".details .composition").hide()}this.preview_fabric.show()}};Garment.prototype.fabricSelect=function(t,e,r){"undefined"==typeof r&&(r=!0);var i=this;$("#fabric .fabric_list .fabric_box").removeClass("checked"),e.addClass("checked");var a=$("span",e).attr("rel"),n="category",o=$("span",e).attr(n),c=$("span",e).attr("bc"),s=$("span",e).attr("zc"),l=$("span",e).attr("rc"),_=$("span",e).attr("hc"),u=$("span",e).attr("tc"),p=$("span",e).attr("cc"),f=$("span",e).attr("pc"),d=$("span",e).attr("si"),h=$("span",e).attr("li"),b=$("span",e).attr("uli"),v=$("span",e).attr("lco"),m=$("span",e).attr("soc"),g=($("span",e).attr("br"),fabric_options_i18n[$("span",e).attr("bri")],$("span",e).attr("idt")),y=$("span",e).attr("simple_composition"),w=fabric_options_i18n[$("span",e).attr("sci")],k=$("span",e).attr("sco"),x=($("span",e).attr("texture"),$("span",e).attr("category_group")),C=fabric_options_i18n[$("span",e).attr("cgi")],S=$("span",e).attr("vdet"),j=$("span",e).attr("nop");if(i.multi_fabric_active){var T=$(".action_column .fabric_group."+i.multi_fabric_active);$(".simple_composition .name",T).html(w);var I="";"basic"==x?I="?":"premium"==x?I="&":"limited"==x&&(I="%"),"basic"==x?$(".category_group .name",T).hide():$(".category_group .name",T).html(C).show()}else{$(".action_column .simple_composition .name").html(w);var I="";"basic"==x?I="?":"premium"==x?I="&":"limited"==x&&(I="%"),"basic"==x?$(".action_column .category_group .name").hide():$(".action_column .category_group .name").html(C).show()}var A=$("span",e).attr("ddl");if("1"==A?($(".extra_linings").addClass("disable_dark_linings"),$(".box_opt.lining").addClass("disable_dark_linings"),$("li.neck_lining").addClass("dark_fabric_mode"),"undefined"!=typeof i.current.extras.neck_lining&&"undefined"!=i.current.extras.neck_lining.color&&$(".box_opt.neck_lining .option_trigger.zero_value").click()):i.multi_fabric_active&&"man_pants"!=i.multi_fabric_active&&($(".extra_linings").removeClass("disable_dark_linings"),$(".box_opt.lining").removeClass("disable_dark_linings"),$("li.neck_lining").removeClass("dark_fabric_mode")),"man_jacket"==i.product_type){var z=$("span",e).attr("season");"summer"==z||"linen"==y||"linen-blends"==y?($("#quilted_waistcoat .option_trigger.zero_value").click(),$("#extra .quilted_waistcoat").hide()):$("#extra .quilted_waistcoat").show()}if(i.has_extra_lining){var O=$('input[name="'+i.has_extra_lining+'[lining_id]"]').val();"undefined"!=O&&"1"==A&&$(".extra_linings .lining_"+O).parent().hasClass("dark")&&$(".extra_linings .lining_box").not(".dark").first().click();var w=$("span",e).attr("simple_composition");"linen"==w?($('.option_trigger[rel="padded"]').hide(),$("#extra .options_list .patches").hide()):($('.option_trigger[rel="padded"]').show(),$("#extra .options_list .patches").show())}if("woman_suitpants"==i.product_type||"woman_suitskirt"==i.product_type||"man_suit"==i.product_type||"man_suit2"==i.product_type||"man_suit3"==i.product_type||"man_smoking"==i.product_type)if(i.multi_fabric_active){var H=i.multi_fabric_active;$('input[name="fabric['+H+']"]',t).val(a),i.current.fabric[H]=a}else $('input[name="fabric['+i.multi_fabric_options[0]+']"]',t).val(a),$('input[name="fabric['+i.multi_fabric_options[1]+']"]',t).val(a),$('input[name="fabric['+i.multi_fabric_options[2]+']"]',t).val(a),i.current.fabric[i.multi_fabric_options[0]]=a,i.current.fabric[i.multi_fabric_options[1]]=a,i.current.fabric[i.multi_fabric_options[2]]=a,i.current.fabric.button_code=c,i.current.fabric._button_code=c,i.current.fabric.waistcoat_button_code=c,i.current.fabric.pants_button_code=c,i.current.fabric.zipper_color=s,i.current.fabric.ribbon_color=l;else $('input[name="fabric['+i.product_type+']"]',t).val(a),i.current.fabric[i.product_type]=a,i.current.fabric.button_code=c,i.current.fabric._button_code=c,i.current.fabric.waistcoat_button_code=c,i.current.fabric.pants_button_code=c,i.current.fabric.zipper_color=s,i.current.fabric.ribbon_color=l;for(var E in i.fabric)if(!i.multi_fabric_active||E==i.multi_fabric_active){if("man_suit2"==i.product_type||"man_suit3"==i.product_type||"man_smoking"==i.product_type)i.updateFabricPrices(E,o,!1,e);else{i.price_detail["fabric_"+E]=0;for(var L in i.fabric[E].price)"undefined"!=typeof o&&"undefined"!=typeof i.fabric[E].price[L][o]&&(i.price_detail["fabric_"+E]=i.fabric[E].price[L][o])}var F=$("span",e).attr("dsc");if("man_suit3"==i.real_product_type)var F=$("span",e).attr("dsc_suit3");F&&!i.multi_fabric_active?i.price_detail.fabric_discount=F:i.price_detail.fabric_discount=0}"man_shirt"==i.product_type?(i.current.fabric.hole_code_fabric=_,i.current.fabric.hole_code_fabric||(i.current.fabric.hole_code_fabric=107),i.current.fabric.thread_code_fabric=u,i.current.fabric.thread_code_fabric||(i.current.fabric.thread_code_fabric=107),i.current.fabric.cuff_code=p,i.current.fabric.cuff_code||(i.current.fabric.cuff_code=1),i.current.fabric.pant_code=f,i.current.fabric.pant_code||(i.current.fabric.pant_code=1),i.current.fabric.shoe_color=m,i.current.fabric.shoe_color||(i.current.fabric.shoe_color=1),i.shirt_style_click||(i.current.neck_open=j,i.current.neck_open||(i.current.neck_open=0),i.current.view_detail=S,i.current.view_detail||(i.current.view_detail="inside"))):"man_jacket"==i.product_type||"man_suit"==i.product_type||"man_suit2"==i.product_type||"man_smoking"==i.product_type?i.multi_fabric_active?("man_jacket"==i.multi_fabric_active&&(i.current.fabric.button_code=c,i.current.fabric._button_code=c,i.current.fabric.shirt_to_jacket_id=d,i.current.fabric.shirt_to_jacket_id||(i.current.fabric.shirt_to_jacket_id=699),i.current.fabric.pant_code=f,i.current.fabric.pant_code||(i.current.fabric.pant_code=1),i.current.fabric.lining_id=h,i.current.fabric.lining_id||(i.current.fabric.lining_id=59),i.current.fabric.unlined_lining=b,i.current.fabric.unlined_lining||(i.current.fabric.unlined_lining=59),i.current.fabric.label_color=v,i.current.fabric.label_color||(i.current.fabric.label_color=0),i.current.fabric.shoe_color=m,i.current.fabric.shoe_color||(i.current.fabric.shoe_color=1),i.current.fabric.tie=g,i.current.fabric.tie||(i.current.fabric.tie=1),"man_smoking"==i.product_type&&(i.current.satin_jacket_buttons=k,i.current.satin_jacket_buttons&&"0"!=k||(i.current.satin_jacket_buttons=1),i.current.satin_jacket_lapel=k,i.current.satin_jacket_lapel&&"0"!=k||(i.current.satin_jacket_lapel=1),i.current.satin_jacket_pockets=k,i.current.satin_jacket_pockets&&"0"!=k||(i.current.satin_jacket_pockets=1),i.current.satin_pants_buttons=k,i.current.satin_pants_buttons&&"0"!=k||(i.current.satin_pants_buttons=1),i.current.satin_pants_ribbon=k,i.current.satin_pants_ribbon&&"0"!=k||(i.current.satin_pants_ribbon=1))),"man_waistcoat"==i.multi_fabric_active&&(i.current.fabric.waistcoat_button_code=c,i.current.fabric.waistcoat_lining_id=h,i.current.fabric.waistcoat_lining_id||(i.current.fabric.waistcoat_lining_id=59)),"man_pants"==i.multi_fabric_active&&(i.current.fabric.pants_button_code=c)):(i.current.fabric.button_code=c,i.current.fabric._button_code=c,i.current.fabric.waistcoat_button_code=c,i.current.fabric.pants_button_code=c,i.current.fabric.shirt_to_jacket_id=d,i.current.fabric.shirt_to_jacket_id||(i.current.fabric.shirt_to_jacket_id=699),i.current.fabric.pant_code=f,i.current.fabric.pant_code||(i.current.fabric.pant_code=1),i.current.fabric.lining_id=h,i.current.fabric.lining_id||(i.current.fabric.lining_id=59),i.current.fabric.waistcoat_lining_id=h,
i.current.fabric.waistcoat_lining_id||(i.current.fabric.waistcoat_lining_id=59),i.current.fabric.unlined_lining=b,i.current.fabric.unlined_lining||(i.current.fabric.unlined_lining=59),i.current.fabric.label_color=v,i.current.fabric.label_color||(i.current.fabric.label_color=0),i.current.fabric.shoe_color=m,i.current.fabric.shoe_color||(i.current.fabric.shoe_color=1),i.current.fabric.tie=g,i.current.fabric.tie||(i.current.fabric.tie=1),"man_smoking"==i.product_type&&(i.current.satin_jacket_buttons=k,i.current.satin_jacket_buttons&&"0"!=k||(i.current.satin_jacket_buttons=1),i.current.satin_jacket_lapel=k,i.current.satin_jacket_lapel&&"0"!=k||(i.current.satin_jacket_lapel=1),i.current.satin_jacket_pockets=k,i.current.satin_jacket_pockets&&"0"!=k||(i.current.satin_jacket_pockets=1),i.current.satin_pants_buttons=k,i.current.satin_pants_buttons&&"0"!=k||(i.current.satin_pants_buttons=1),i.current.satin_pants_ribbon=k,i.current.satin_pants_ribbon&&"0"!=k||(i.current.satin_pants_ribbon=1))):"man_pants"==i.product_type?(i.current.fabric.shirt_to_jacket_id=d,i.current.fabric.shirt_to_jacket_id||(i.current.fabric.shirt_to_jacket_id=699),i.current.fabric.shoe_color=m,i.current.fabric.shoe_color||(i.current.fabric.shoe_color=1),i.current.fabric.pants_button_code=c):"man_waistcoat"==i.product_type?(i.current.fabric.shirt_to_jacket_id=d,i.current.fabric.shirt_to_jacket_id||(i.current.fabric.shirt_to_jacket_id=699),i.current.fabric.pant_code=f,i.current.fabric.pant_code||(i.current.fabric.pant_code=1),i.current.fabric.waistcoat_lining_id=h,i.current.fabric.waistcoat_lining_id||(i.current.fabric.waistcoat_lining_id=59),i.current.fabric.unlined_lining=b,i.current.fabric.unlined_lining||(i.current.fabric.unlined_lining=59),i.current.fabric.label_color=v,i.current.fabric.label_color||(i.current.fabric.label_color=0),i.current.fabric.shoe_color=m,i.current.fabric.shoe_color||(i.current.fabric.shoe_color=1),i.current.fabric.tie=g,i.current.fabric.tie||(i.current.fabric.tie=1),i.current.fabric._button_code=c,i.current.fabric._button_code||(i.current.fabric._button_code=2)):"man_coat"==i.product_type&&(i.current.fabric.lining_id=h,i.current.fabric.lining_id||(i.current.fabric.lining_id=57),i.current.fabric.lining_id=h,i.current.fabric.lining_id||(i.current.fabric.lining_id=57)),i.updatePrice(),r&&i.renderDraw(),i.fabric_preview_open&&$("span.thumb_preview",e).click(),"man_jacket"==i.product_type&&"seersucker"==y?i.showSeersuckerWarning(a):i.closeSeersuckerWarning()},Garment.prototype.initConfigure=function(){var t=this,e=t.container,r=e.find("#config"),i=r.find(".container_options"),a=r.find(".box_opt"),n=r.find(".checkbox_option"),o=r.find(".neck_options.neck"),c=r.find(".neck_options.cuff"),s=!1;i.on("click","span",function(){var e=$(this).hasClass("submenu");if(e){var a=$(this).attr("rel");return $(this).hasClass("min")?($(this).removeClass("min"),$('li[product="'+a+'"]',r).slideToggle().removeClass("invisible")):($(this).addClass("min"),$('li[product="'+a+'"]',r).slideToggle().addClass("invisible")),setTimeout(function(){$(".container_options",r).perfectScrollbar("update")},300),!1}if(i.addClass("min"),s&&t.hideOptionBox(s,r),s=this.getAttribute("href").replace(/^[^#]*#/,""),$("#"+s).addClass("active"),$(this).addClass("active"),$(".preview_fabric").hide(),"woman_suitpants"==t.product_type||"woman_suitskirt"==t.product_type||"man_suit"==t.product_type||"man_suit2"==t.product_type){var n=$(this).attr("product");t.changeActiveBlock(n,!0)}var o=t.views.config[s];return o&&(t.inArray(t.current.view,o)||(t.changeView(o[0]),"folded"==o[0]&&"man_shirt"==t.product_type&&t.show_force_view_message(!0))),!1}),$(".submenu:first").click(),i.on("click","a.shirt_cut",function(){t.change_style_shirt("casual")}),a.on("click","a.back",function(){return i.removeClass("min"),s&&$("#"+s).removeClass("active"),i.find("li a.active").removeClass("active"),!1}),a.on("click",".option_trigger",function(){t.last_change=$(this).parent().attr("id"),$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active");var e=$(this).parent().hasClass("combined_block");if(e){var r=this.getAttribute("rel"),a=$(this).parent().find("input");a.val(r).change(),input_name=a.attr("name"),input_value=a.val();var n=$("#"+input_name).attr("views");n&&(n=n.split(","),t.inArray(t.current.view,n)||t.changeView(n[0])),"undefined"!=typeof t.product_config[input_name]&&t.relationsApply(input_name,t.product_config[input_name][input_value]),$(this).parent().attr("icon-change")&&t.change_icon_trigger($(this),i),"jacket_style"==input_name&&"crossed"==r&&$('#jacket_buttons .option_trigger[rel="4"]').click()}else{var r=this.getAttribute("rel"),a=$(this).parent().find("input");a.val(r).change(),input_name=a.attr("name"),input_value=a.val(),"man_suit2"==t.product_type&&"waistcoat"==input_name&&"1"==input_value?(price=parseFloat(a.attr("price")),t.convetToSuit3(price,!0)):"man_suit2"==t.product_type&&"waistcoat"==input_name&&"0"==input_value?t.convetToSuit2():"jacket_style_combined"==input_name,"undefined"!=typeof t.product_config[input_name]&&t.relationsApply(input_name,t.product_config[input_name][input_value]),$(this).parent().attr("icon-fixed")||t.change_icon_trigger($(this),i)}if("waistcoat"==input_name&&t.changeActiveBlock("man_waistcoat",!0),t.current_extra_option){var n=t.views.config[t.current_extra_option];n&&(t.inArray(t.current.view,n)||(t.changeView(n[0]),"folded"==n[0]&&t.show_force_view_message(!0)))}}),c.on("click","label",function(){var t=$(this).attr("rel");return $(this).parent().find("label").removeClass("checked"),$(this).addClass("checked"),$('.neck_options.neck div[name="shirt_neck_no_interfacing"] .box_options input[value="'+t+'"]').parent().click(),!1}),n.on("click","label",function(){$(this).attr("rel");$(this).parent().find("label").removeClass("checked"),$(this).addClass("checked");var t=$(this).attr("rel"),e=$(this).attr("option_filter");if(1==t){$("#"+e).addClass("slanted");var r=$("#"+e+" .option_trigger.active").attr("equival");$("#"+e+' .option_trigger[rel="'+r+'"]').click()}else{$("#"+e).removeClass("slanted");var r=$("#"+e+" .option_trigger.active").attr("equival");$("#"+e+' .option_trigger[rel="'+r+'"]').click()}return!1}),o.on("click","label",function(){var e=$(this).attr("rel"),r=$(this).parent().parent().attr("name"),i=$("input",this).val();return"shirt_neck_buttons"==r?($(this).parent().find("label").removeClass("checked"),$(this).parent().find("input").prop("checked",!1),$(this).addClass("checked"),$("input",this).prop("checked",!0)):($(this).parent().find("label").removeClass("checked"),$(this).parent().find("input").prop("checked",!1),$('.neck_options.cuff div[name="shirt_neck_no_interfacing"] label').removeClass("checked"),$('.neck_options.cuff label[rel="'+e+'"]').addClass("checked"),$(this).addClass("checked"),$("input",this).prop("checked",!0),"undefined"!=typeof t.product_config[r]&&t.relationsApply(r,t.product_config[r][i])),t.current.config[r]=i,"shirt_neck_buttons"==r&&t.renderDraw(),!1}),o.on("click","a.tooltip",function(){$("div.tooltip",o).toggleClass("active")}),$("a.tooltip",o).bind("touchstart",function(t){$("div.tooltip",o).addClass("active")}),$("a.tooltip",o).bind("touchend",function(t){$("div.tooltip",o).removeClass("active")}),$("input",r).change(function(e){var r=$(this).attr("name"),i=$(this).val();if("jacket_style_combined"==r){var a=i.split("_"),n=a[0],o=2;o="mao"==n?5:a[1],t.current.config.jacket_style=n,t.current.config.jacket_buttons=o}else t.current.config[r]=i;t.renderDraw()})},Garment.prototype.initFabric=function(){function t(){var t=$(".fabric_options_fix").height(),e=$(".multifabric_selectors").height(),r=t+e;$(".fabric_list").css("margin-bottom",r)}function e(t,e){$("#fabric .fabric_options_fix .filter_title").html(t),e?$("#fabric .filter_section").addClass("pointer"):$("#fabric .filter_section ").removeClass("pointer")}function r(){$("#personalize_fabrics_info_popup").addClass("active")}function i(){$("#personalize_fabrics_split").addClass("active")}function a(t){if(n.multi_fabric_active=t,0==n.multi_fabric_active){$("#fabric .fabric_list").removeClass("multi_fabric").removeClass("three"),$(".multifabric_selectors").hide(),n.stepSetURL("fabric");var e=$('input[name="fabric['+n.multi_fabric_options[0]+']"]',n.container).val();$('input[name="fabric['+n.multi_fabric_options[1]+']"]').val(e),$('input[name="fabric['+n.multi_fabric_options[2]+']"]').val(e),n.current.fabric[n.multi_fabric_options[0]]=e,n.current.fabric[n.multi_fabric_options[1]]=e,n.current.fabric[n.multi_fabric_options[2]]=e,$(".fabric_box .price.general").addClass("visible"),$(".fabric_box .price.split").removeClass("visible"),$(".action_column .fabric_group").hide(),$(".action_column .fabric_group.general").show();var r=$('.fabric_box div[rel="'+e+'"]',p).parent();n.fabricSelect($("#fabric"),r)}else{$("#fabric .fabric_list").addClass("multi_fabric"),"man_suit3"==n.real_product_type&&$("#fabric .fabric_list").addClass("three"),$(".multifabric_selectors").show(),n.multi_fabric_active=n.multi_fabric_options[0];var i=n.current.fabric.man_jacket,a=$('#fabric .image[rel="'+i+'"] a').attr("category");n.updateFabricPrices("man_jacket",a,!0);var i=n.current.fabric.man_pants,a=$('#fabric .image[rel="'+i+'"] a').attr("category");if(n.updateFabricPrices("man_pants",a,!0),"man_suit3"==n.real_product_type){var i=n.current.fabric.man_waistcoat,a=$('#fabric .image[rel="'+i+'"] a').attr("category");n.updateFabricPrices("man_waistcoat",a,!0)}n.price_detail.fabric_man_suit2=0,n.price_detail.fabric_man_suit3=0,$(".action_column .fabric_group.general").hide();var o=["man_jacket","man_pants"];"man_suit3"==n.real_product_type&&o.push("man_waistcoat");for(var c=0;c<o.length;c++)$(".action_column .fabric_group."+o[c]).show()}h.removeClass("active"),n.fabricPriceActive()}var n=this,o=$("#fabric"),c=(o.find(".filter_section"),$(".filters.fabric_step")),s=c.find(".menu_filter"),l=(s.find(".filter li"),o.find(".active_filters")),_=(l.find("ul"),o.find(".fabric_options")),u=o.find(".fabric_options_fix"),p=o.find(".fabric_list"),f=p.find(".fabric_box"),d=$("#personalize_fabrics_info_popup"),h=$("#personalize_fabrics_split"),b=[];"undefined"!=typeof winter_blazer_landing&&"yes"==winter_blazer_landing||$('li [rel="winter_tweed"]').hide(),f.each(function(){var t=140,e=$(".info .title",this).width(),r=$(".info .price",this).width(),i=e+r,a=t-r-5,n={width:a,"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"};i>t&&$(".info .title",this).css(n)},function(){$(".info .title",this).css("width","auto")}),$("#fabric .fabric_options_fix").on("click",".pointer",function(){c.addClass("active")}),d.on("click",".link",function(){var t=$(this),e=(t.attr("filter_cat"),t.attr("filter"));t.filter=e,n.applyFilterFabric(t,!1,!0),d.removeClass("active")}),"man_suit"!=n.product_type&&"man_suit2"!=n.product_type||$(".fabric_box",o).each(function(){var t=$(this),e=$("a.fabric",t);e.attr("simple_composition"),e.attr("fw")}),p.on("click",".fabric_box:not(.out_of_stock)",function(){return"undefined"!=typeof n.out_of_stock_control.fabric&&"ok"!==n.out_of_stock_control.fabric&&delete n.out_of_stock_control.fabric,$(".fabric_box.checked",p).removeClass("checked"),n.fabricSelect(o,$(this)),!1}),s.find(".item_menu_filter").each(function(){b.push($(this).attr("rel"))});var v=$(".left_filters");v.on("click","a",function(){switch($("li",v).removeClass("active"),$(this).parent().addClass("active"),c.removeClass("active"),d.removeClass("active"),h.removeClass("active"),$(this).attr("rel")){case"all":n.push_dataLayer("config_"+n.product_type,"step2:filter_type_all"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top",""),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"new":n.pre_filter_active=!0,n.push_dataLayer("config_"+n.product_type,"step2:filter_type_new"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top","");var t=[];t.filter="new",n.applyFilterFabric(t,!1,!1),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"best_sell":n.pre_filter_active=!0,n.push_dataLayer("config_"+n.product_type,"step2:filter_type_best_sell"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top","");var t=[];t.filter="best_seller",n.applyFilterFabric(t,!1,!1),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"premium":n.pre_filter_active=!0,n.push_dataLayer("config_"+n.product_type,"step2:filter_type_premium"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top","");var t=[];t.filter="premium",n.applyFilterFabric(t,!1,!1),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"promo":n.pre_filter_active=!0,n.push_dataLayer("config_"+n.product_type,"step2:filter_type_promo"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top","");var t=[];t.filter="promo",n.applyFilterFabric(t,!1,!1),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"summer":n.pre_filter_active=!0,n.push_dataLayer("config_"+n.product_type,"step2:filter_type_summer"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top","");var t=[];t.filter="summer",n.applyFilterFabric(t,!1,!1),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"winter":n.pre_filter_active=!0,n.push_dataLayer("config_"+n.product_type,"step2:filter_type_winter"),n.removeAllFilters(o,f,_,u,s),p.css("margin-top","");var t=[];t.filter="winter",n.applyFilterFabric(t,!1,!1),tablet_device||$(".fabric_list").perfectScrollbar("update"),e($(this).parent().attr("message"));break;case"filter":n.pre_filter_active&&(n.removeAllFilters(o,f,_,u,s),n.pre_filter_active=!1),c.addClass("active"),n.closeThumbFabric(),n.isFF()?setTimeout(function(){$(".background_fixed",c).show()},600):$(".background_fixed",c).show(),e($(this).parent().attr("message"),"pointer");break;case"multi":c.removeClass("active"),i();break;case"info":c.removeClass("active"),r()}return!1}),h.on("click","a.back",function(){h.removeClass("active")}),h.on("click","a.back",function(){h.removeClass("active")}),h.on("click",".option_trigger",function(){$(".option_trigger",h).removeClass("active"),$(this).addClass("active");var e=$(this).attr("rel");e=0!=e&&"man_jacket",a(e),t()}),$(".multifabric_selectors").on("click","label",function(){$(".multifabric_selectors label").removeClass("checked"),$(this).addClass("checked");var t=$(this).attr("rel");n.multi_fabric_active=t,n.fabricPriceActive()}),c.on("click","a.back",function(){return o.show(),c.removeClass("active"),!1}),d.on("click","a.back",function(){return o.show(),d.removeClass("active"),!1}),c.on("click",".item_menu",function(){$(this).parent().toggleClass("active"),$(this).toggleClass("active");$(this).next().slideToggle().toggleClass("active");$(".filters .menu_filter .content").animate({scrollTop:$(this).offset().top},1e3),tablet_device||$(".filters .menu_filter .content").perfectScrollbar("update")}).find("ul.sub_menu_filter").hide(),s.on("click",".filter li",function(){var t=$(this).parents(".sub_menu_filter");$(this).hasClass("all")?t.find(".filter li").removeClass("active"):t.find(".filter li.all").removeClass("active"),$(this).toggleClass("active"),n.check_auto_all_select(t)}),l.on("click","li",function(){$(this).remove();var e=$(this).attr("rel");$(this).attr("rel_type");s.find("li[rel="+e+"]").removeClass("active");var r=[];return l.find("li").each(function(){var t=$(this).attr("rel"),e=$(this).attr("rel_type");"undefined"==typeof r[e]&&(r[e]=[]),r[e].push(t)}),0===$(".active_filters li").length&&($(".filter_title").hide(),$(".filter_title.all_fabrics").show()),c.find("ul.sub_menu_filter").each(function(){n.check_auto_all_select($(this))}),t(),n.update_fabric_list(f,b,r,o),tablet_device||$(".fabric_list").perfectScrollbar("update"),!1});var m=c.find(".apply"),g=!1,y=[];m.on("click","a",function(){return n.push_dataLayer("config_"+n.product_type,"step2:filter_applied"),y=[],$("li",l).remove(),s.find(".item_menu_filter").each(function(t){var e=$(this),r=e.attr("rel");y[r]=[],e.find(".filter li.active").not(".all").each(function(){g=!0;var t=$(this).attr("rel"),e=$(this).find("a").html();y[r].push(t),l.append("<li rel_type="+r+" rel="+t+"><a href='javascript:;'><div class='cruz'>k</div><div class='title'>"+e+"</div></a></li>")}),0==y[r].length&&delete y[r]}),t(),g&&(l.show(),$(".filter_title").hide(),$(".filter_title.add_filters").show(),n.update_fabric_list(f,b,y,o)),o.show(),c.removeClass("active"),tablet_device||$(".fabric_list").perfectScrollbar("update"),!1}),$(".check_multiple_fabric",n.container).click(function(){n.multi_fabric?activeMultiFabric("desactive"):activeMultiFabric("active")}),$(".multiple_fabric_options").on("click",".option",function(){$(".multiple_fabric_options .option").removeClass("active");var t=$(this).attr("id");n.multi_fabric=t,$(this).addClass("active")}),$(".fabric_box").each(function(){$(".composition span.trad",this).html(fabric_options_i18n[$(".composition span.trad",this).html()]).parent().addClass("visible")})},Garment.prototype.keychain_isset=function(t,e){for(var r=t,i=0;i<e.length;i++){if("undefined"==typeof r[e[i]])return!1;r=r[e[i]]}return!0},Garment.prototype.initExtras=function(){var t=this,e=t.container,r=e.find("#extra"),i=r.find(".container_options"),a=r.find(".box_opts"),n=a.find(".box_opt"),o=(a.find('[data-extra-type*="standart"]'),a.find('[data-extra-type*="fabric"]'),a.find('[data-extra-type*="threads"]'),a.find(".initials"),r.find(".extra_fabrics")),c=o.find(".fabric_list"),s=r.find(".extra_linings"),l=s.find(".lining_list"),_=$("#extra"),u=_.find(".filter_section"),p=$(".filters.extra_step"),f=p.find(".menu_filter"),d=(f.find(".filter li"),_.find(".active_filters")),h=d.find("ul"),b=_.find(".fabric_options"),v=_.find(".fabric_options_fix"),c=_.find(".fabric_list"),m=c.find(".fabric_box"),l=_.find(".lining_list"),m=l.find(".lining_box"),g=[];i.on("click","span",function(){var e=$(this).hasClass("submenu");if(e){var a=$(this).attr("rel");return $(this).hasClass("min")?($(this).removeClass("min"),$('li[product="'+a+'"]',r).slideToggle().removeClass("invisible")):($(this).addClass("min"),$('li[product="'+a+'"]',r).slideToggle().addClass("invisible")),setTimeout(function(){$(".container_options",r).perfectScrollbar("update")},300),!1}t.closeThumbFabric(),t.closeSeersuckerWarning(),t.closeInitialsImage(),i.addClass("min"),$(this).addClass("active"),t.current_extra_option&&t.hideOptionBox(t.current_extra_option,_),t.extra_fabrics_active&&o.removeClass("active"),t.extra_linings_active&&s.removeClass("active"),p.removeClass("active"),t.removeAllFilters(_,m,b,v,f),t.current_extra_option=this.getAttribute("href").replace(/^[^#]*#/,""),$("#"+t.current_extra_option,_).addClass("active");var n=t.views.extra[t.current_extra_option];return n&&(t.inArray(t.current.view,n)||(t.changeView(n[0]),"folded"==n[0]&&t.show_force_view_message(!0))),t.complex&&("waistcoat_button_holes_threads"==t.current_extra_option||"waistcoat_initials"==t.current_extra_option||"waistcoat_metal_buttons"==t.current_extra_option?t.changeActiveBlock("man_waistcoat",!0):"lining"!=t.current_extra_option||"man_suit2"!=t.product_type&&"man_suit3"!=t.product_type?"sash"==t.current_extra_option&&"without_model"!=t.current.view?t.changeActiveBlock("man_pants",!1):"waistcoat_lining_back"==t.current_extra_option&&"without_model"!=t.current.view?t.changeActiveBlock("man_waistcoat",!1):t.changeActiveBlock(t.multi_fabric_options[0],!0):t.changeActiveBlock("man_jacket_only",!0)),"initials"==t.current_extra_option&&("man_jacket"!=t.product_type&&"man_suit"!=t.product_type&&"man_suit2"!=t.product_type||t.showInitialsImage()),"quilted_waistcoat"!=t.current_extra_option||t.quilted_alert||t.showQuilterWaistcoatAlert(),"winter_lining"!=t.current_extra_option||t.winter_lining_alert||t.showWinterLiningAlert(),!1}),n.on("click","a.back",function(){return t.closeInitialsImage(),i.removeClass("min"),t.current_extra_option&&($("#"+t.current_extra_option).removeClass("active"),t.hideOptionBox(t.current_extra_option,n)),i.find("li a.active").removeClass("active"),!1}),$("div.box_opt",a).each(function(){var e=this.getAttribute("data-extra-type"),r=this.getAttribute("id");t.current.extras[r]=[],"function"==typeof t["initExtra_"+e]&&t["initExtra_"+e].apply(t,[r,$(this)])}),$("input",_).change(function(){t.renderDraw()}),c.on("click",".fabric_box:not(.out_of_stock)",function(){t.keychain_isset(t.out_of_stock_control,["extras","fabric",t.current_fabric_activator_parent.attr("id")])&&delete t.out_of_stock_control.extras.fabric[t.current_fabric_activator_parent.attr("id")];var e=$(this).find(".image").attr("rel");if(n=$(this).parent(),t.id_box_opt_fabric)return t.set_extra_fabric(t.id_box_opt_fabric,option_fabric_trigger_selected,t.current_fabric_activator_parent,e),t.fabric_preview_open&&$("span.thumb_preview",this).click(),!1}),l.on("click",".lining_box:not(.out_of_stock)",function(){t.keychain_isset(t.out_of_stock_control,["extras","lining",t.current_fabric_activator_parent.attr("id")])&&delete t.out_of_stock_control.extras.lining[t.current_fabric_activator_parent.attr("id")];var e=$(this).find(".image").attr("rel");if(n=$(this).parent(),t.id_box_opt_fabric)return t.current._show_lining=!0,t.has_extra_lining=t.id_box_opt_fabric,t.set_extra_lining(t.id_box_opt_fabric,option_fabric_trigger_selected,t.current_fabric_activator_parent,e,$(this)),t.current._show_lining=!1,t.fabric_preview_open&&$("span.thumb_preview",this).click(),!1}),o.on("click",".back",function(){return extra_fabrics_active=!1,o.removeClass("active"),t.current_fabric_activator_parent.addClass("active"),!1}),s.on("click",".back",function(){return extra_linings_active=!1,s.removeClass("active"),t.current_fabric_activator_parent.addClass("active"),!1}),c.on("click",".fabric_box:not(.out_of_stock)",function(){return c.find(".fabric_box.checked").removeClass("checked"),$(this).addClass("checked"),!1}),l.on("click",".lining_box:not(.out_of_stock)",function(){return l.find(".lining_box.checked").removeClass("checked"),$(this).addClass("checked"),!1}),f.find(".item_menu_filter").each(function(){g.push($(this).attr("rel"))}),u.on("click","a.filter_button",function(){p.addClass("active"),t.isFF()?setTimeout(function(){$(".background_fixed",p).show()},600):$(".background_fixed",p).show()}),p.on("click","a.back",function(){return _.show(),p.removeClass("active"),!1}),p.on("click",".item_menu",function(){$(this).parent().toggleClass("active"),$(this).toggleClass("active");$(this).next().slideToggle().toggleClass("active")}).find("ul.sub_menu_filter").hide(),f.on("click",".filter li",function(){var e=$(this).parents(".sub_menu_filter");$(this).hasClass("all")?e.find(".filter li").removeClass("active"):e.find(".filter li.all").removeClass("active"),$(this).toggleClass("active"),t.check_auto_all_select(e)}),d.on("click","li",function(){$(this).remove(),t.resize_height_fabric_options_fix(b,v);var e=$(this).attr("rel");$(this).attr("rel_type");f.find("li[rel="+e+"]").removeClass("active");var r=[];return h.find("li").each(function(){var t=$(this).attr("rel"),e=$(this).attr("rel_type");"undefined"==typeof r[e]&&(r[e]=[]),r[e].push(t)}),p.find("ul.sub_menu_filter").each(function(){t.check_auto_all_select($(this))}),t.update_fabric_list(m,g,r,_),!1});var y=p.find(".apply"),w=!1,k=[];y.on("click","a",function(){return h.html(""),f.find(".item_menu_filter").each(function(t){var e=$(this),r=e.attr("rel");k[r]=[],e.find(".filter li.active").not(".all").each(function(){w=!0;var t=$(this).attr("rel"),e=$(this).find("a").html();k[r].push(t),h.prepend("<li rel_type="+r+" rel="+t+"><a href='javascript;:'><div class='cruz'>k</div><div class='title'>"+e+"</div></a></li>")}),0==k[r].length&&delete k[r]}),w&&(d.show(),t.update_fabric_list(m,g,k,_)),_.show(),p.removeClass("active"),t.resize_height_fabric_options_fix(b,v),!1}),$(".quilted_waistcoat .tooltip_info").click(function(){t.showQuilterWaistcoatAlert()}),$(".quilted_waistcoat_alert").click(function(){t.hideQuilterWaistcoatAlert()}),$(".winter_lining .tooltip_info").click(function(){t.showWinterLiningAlert()}),$(".winter_lining_alert").click(function(){t.hideWinterLiningAlert()})},Garment.prototype.initExtra_standart=function(t,e){var r=this;e.on("click",".option_trigger",function(){var t=$(this).parent().attr("id");$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active");var e=$(this).attr("rel"),i=$(this).parent().find("input");if(i.val(e),$(this).hasClass("zero_value"))r.extraSetPrice(t,0);else{var a=parseFloat($(this).parent().attr("data-price"));isNaN(a)&&(a=0),r.extraSetPrice(t,a)}i.val(e).change(),input_name=i.attr("name"),input_value=i.val(),"undefined"!=typeof r.product_config[input_name].contrast&&r.relationsApply(input_name,r.product_config[input_name].contrast[input_value])})},Garment.prototype.initExtra_initials=function(t,e){function r(e){if(n){var r=$('input[name="'+t+'[text]"]',e).val();a.current.extras[t].text=r;var i=$('input[name="'+t+'[color_custom]"]',e).val();a.current.extras[t].color_custom=i;var o=$('input[name="'+t+'[type]"]:checked',e).val();a.current.extras[t].type=o;var c=$('input[name="'+t+'[pos]"]:checked',e).val();a.current.extras[t].pos=c}else a.current.extras[t]=[];"man_coat"!=this.product_type&&"man_trenchcoat"!=this.product_type&&a.renderInitials()}function i(){$(".list_common_color .common_color",e).removeClass("checked");var t=$(".list_common_color .common_color",e).first().attr("rel");$('input[name="initials[color_custom]"]',e).val(t),$(".list_common_color .common_color",e).first().addClass("checked")}var a=this,n=!1;$(document).ready(function(){$(window).keydown(function(t){if(13==t.keyCode)return t.preventDefault(),!1})}),$('input[name="'+t+'[text]"]',e).keyup(function(i){i.keyCode||i.which;if(""!=$(this).val()){n=!0;var o=parseFloat(e.attr("data-price"));isNaN(o)&&(o=0),a.extraSetPrice(t,o)}else a.extraSetPrice(t,0),n=!1;r(e)}),e.on("click",".remove",function(){return $("#txt_initial",e).val("").change(),i(),a.extraSetPrice(t,0),n=!1,r(e),!1});var o=e.find(".box_font_initial");o.on("click","label",function(){return o.find("label.checked").removeClass("checked"),$(this).addClass("checked"),$("input",o).prop("checked",!1),$("input",$(this)).prop("checked",!0),""!=$('input[name="'+t+'[text]"]').val()&&(n=!0),r(e),!1});var c=e.find(".box_position_initial");c.on("click","label",function(){return c.find("label.checked").removeClass("checked"),$(this).addClass("checked"),$("input",c).prop("checked",!1),$("input",$(this)).prop("checked",!0),""!=$('input[name="'+t+'[text]"]').val()&&(n=!0),r(e),!1});var s=$(".list_common_color",e);s.on("click",".common_color",function(){$(this).parent().find(".common_color.checked").removeClass("checked");var i=$(this).attr("rel");if($(this).parent().find("input").val(i).change(),$(this).addClass("checked"),""!=$('input[name="'+t+'[text]"]').val()&&(n=!0),n){var o=parseFloat(e.attr("data-price"));isNaN(o)&&(o=0),a.extraSetPrice(t,o)}return r(e),!1})},Garment.prototype.initExtra_threads=function(t,e){var r=this;e.on("click",".option_trigger",function(){$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active"),$(".button_holes_section").removeClass("active");var t=$(this).attr("rel");t?(r.buttons_holes_opened=!0,$(".buttonholes_color").addClass("active"),"lapel"!=t&&$(".buttonthreads_color").addClass("active")):($("input",e).val(""),$(".list_common_color .common_color",e).removeClass("checked"));var i=this.getAttribute("rel");$(this).parent().find("input").val(i).change()}),$("input",e).change(function(){r.trigger("changeButtonHoles"+t,[e])}),this.bind("changeButtonHoles"+t,function(e){r.saveExtraBoxButtonsHoles(t,e)});var i=$(".list_common_color",e);i.on("click",".common_color",function(){$(this).parent().find(".common_color.checked").removeClass("checked");var t=$(this).attr("rel");return $(this).parent().find("input").val(t).change(),$(this).addClass("checked"),!1})},Garment.prototype.initExtra_colors=function(t,e){function r(){var r=!1,a=0;"contrasts"==t?($(".colors_section.active",e).each(function(){$("input",this).each(function(){""!=$(this).val()&&++a})}),a>=1&&(r=!0)):($(".colors_section.active",e).each(function(){""!=$("input",this).val()&&++a}),1==a&&(r=!0)),r?(price=parseFloat(e.attr("data-price")),rel=$(".option_trigger.active",e).attr("rel"),isNaN(price)&&(price=0),i.extraSetPrice(t,price),"undefined"!=typeof i.product_config[t].contrast&&i.relationsApply(t+"[contrast]",i.product_config[t].contrast[rel])):(rel=parseFloat(e.attr("rel")),i.extraSetPrice(t,0),"undefined"!=typeof i.product_config[t].contrast&&i.relationsApply(t+"[contrast]",i.product_config[t].contrast[rel]))}var i=this;e.on("click",".option_trigger",function(){$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active"),$(".colors_section",e).removeClass("active");var r=$(this).attr("rel");r?$(".colors_section",e).addClass("active"):($("input",e).val(""),$(".list_common_color .common_color",e).removeClass("checked"));var i=this.getAttribute("rel");$(this).parent().find("input").val(i).change(),"quilted_waistcoat"==t&&r&&$(".box_color",e).first().click(),"contrast_collar"==t&&r&&$(".box_color",e).first().click()}),$("input",e).change(function(){r()});var a=$(".list_common_color",e);a.on("click",".common_color",function(){$(this).parent().find(".common_color.checked").removeClass("checked");var t=$(this).attr("rel");return $(this).parent().find("input").val(t).change(),$(this).addClass("checked"),!1})},Garment.prototype.set_extra_fabric=function(t,e,r,i){var a=this,n=e.attr("rel");$('input[name="'+t+'[contrast]"]',r).val(n),i&&$('input[name="'+t+'[fabric_id]"]',r).val(i),$(".option_trigger",r).removeClass("active"),e.addClass("active");var o=parseFloat($("#"+t).attr("data-price"));isNaN(o)&&(o=0),a.extraSetPrice(t,o),$('input[name="'+t+'[contrast]"]',r).val(n).change(),"undefined"!=typeof a.product_config[t][n]&&a.relationsApply(t+"[contrast]",a.product_config[t][n])},Garment.prototype.set_extra_lining=function(t,e,r,i,a){var n=this,o=e.attr("rel");if($('input[name="'+t+'[contrast]"]',r).val(o),i&&$('input[name="'+t+'[lining_id]"]',r).val(i),$(".option_trigger",r).removeClass("active"),e.addClass("active"),"waistcoat_lining_back"==n.id_box_opt_fabric)var c=parseFloat(e.attr("data-price"));else if(a)var c=parseFloat($(".lining",a).attr("data-price"));else var c=parseFloat($("#"+t).attr("data-price"));isNaN(c)&&(c=0),n.extraSetPrice(t,c),$('input[name="'+t+'[contrast]"]',r).val(o).change(),"undefined"!=typeof n.product_config[t][o]&&n.relationsApply(t+"[contrast]",n.product_config[t][o])},Garment.prototype.initExtra_fabrics=function(t,e){var r=this,i=$("#extra",r.container),a=(i.find(".fabric_options"),i.find(".fabric_options_fix"),$(".extra_fabrics",r.container)),n=a.find(".fabric_list"),o=(n.find(".fabric_box"),$(".filters.extra_step",r.container)),c=o.find(".menu_filter"),s=(c.find(".filter li"),i.find(".active_filters"));s.find("ul");e.on("click",".option_trigger",function(){if(r.closeThumbFabric(),r.closeInitialsImage(),r.closeSeersuckerWarning(),r.id_box_opt_fabric=$(this).parent().attr("id"),option_fabric_trigger_selected=$(this),$(this).hasClass("fabric_activator")){r.last_change=$(this).parent().attr("id"),r.extra_fabrics_active=!0,r.current_fabric_activator_parent=$(this).parent(),r.current_fabric_activator_parent.removeClass("active"),$(".fabric_box.checked",a).removeClass("checked");var e=$('input[name="'+r.id_box_opt_fabric+'[fabric_id]"]',r.current_fabric_activator_parent).val();$('.fabric_box [rel="'+e+'"]',a).parent().addClass("checked"),e&&r.set_extra_fabric(r.id_box_opt_fabric,option_fabric_trigger_selected,r.current_fabric_activator_parent,e),a.addClass("active"),setTimeout(function(){r.bLazy_fabric&&r.bLazy_fabric.revalidate()},200),r.scrolltoFabric(".extra_fabrics");var i=$(this).attr("rel");return"cuffs_fabric"==t&&"inner"==i&&(r.changeView("front"),
    r.change_style_shirt("inner_sleeve")),!1}$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active");option_fabric_trigger_selected.attr("rel");$('input[name="'+r.id_box_opt_fabric+'[fabric_id]"]',$(this).parent()).val(""),$('input[name="'+r.id_box_opt_fabric+'[contrast]"]',$(this).parent()).val(""),r.extraSetPrice(t,0),r.keychain_isset(r.out_of_stock_control,["extras","fabric",t])&&delete r.out_of_stock_control.extras.fabric[t],$('input[name="'+r.id_box_opt_fabric+'[fabric_id]"]',$(this).parent()).val("").change()})},Garment.prototype.initExtra_lining=function(t,e){var r=this;r.has_extra_lining=!1;var i=$("#extra",r.container),a=(i.find(".fabric_options"),i.find(".fabric_options_fix"),$(".extra_linings",r.container)),n=a.find(".lining_list"),o=(n.find(".lining_box"),$(".filters.extra_step",r.container)),c=o.find(".menu_filter"),s=(c.find(".filter li"),i.find(".active_filters"));s.find("ul");e.on("click",".option_trigger",function(){r.closeThumbFabric(),r.closeSeersuckerWarning(),r.id_box_opt_fabric=$(this).parent().attr("id"),option_fabric_trigger_selected=$(this);var e=option_fabric_trigger_selected.attr("rel");if($(this).hasClass("lining_activator")){var i=$(this).attr("filter");i&&(a.removeClass("personalizado"),a.removeClass("padded"),a.addClass(i)),r.extra_linings_active=!0,r.current_fabric_activator_parent=$(this).parent(),r.current_fabric_activator_parent.removeClass("active"),$(".lining_box.checked",a).removeClass("checked");var n=$('input[name="'+r.id_box_opt_fabric+'[lining_id]"]',r.current_fabric_activator_parent).val();return $('.lining_box [rel="'+n+'"]',a).parent().addClass("checked"),"waistcoat_lining_back"==r.id_box_opt_fabric?($(".lining_list .price").removeClass("active"),$(".lining_list .diamond").removeClass("active")):($(".lining_list .price").addClass("active"),$(".lining_list .diamond").addClass("active")),a.addClass("active"),tablet_device||a.perfectScrollbar("update"),setTimeout(function(){r.bLazy_fabric&&r.bLazy_fabric.revalidate()},200),"undefined"!=typeof r.product_config[r.id_box_opt_fabric]&&"undefined"!=typeof r.product_config[r.id_box_opt_fabric].options&&r.relationsApply(r.id_box_opt_fabric+"[contrast]",r.product_config[r.id_box_opt_fabric].options[e]),!1}if($(this).hasClass("lining_unlined")){$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active");var o=parseFloat($(this).attr("data-price"));r.keychain_isset(r.out_of_stock_control,["extras","lining",t])&&delete r.out_of_stock_control.extras.lining[t],$('input[name="'+r.id_box_opt_fabric+'[lining_id]"]').val("unlined"),$('input[name="'+r.id_box_opt_fabric+'[contrast]"]').val("unlined").change(),r.extraSetPrice(t,o),r.renderDraw(),"undefined"!=typeof r.product_config[r.id_box_opt_fabric]&&r.relationsApply(r.id_box_opt_fabric+"[contrast]",r.product_config[r.id_box_opt_fabric].options[e])}else if($(this).hasClass("same_as_front")){$(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active");var o=parseFloat($(this).attr("data-price"));$('input[name="'+r.id_box_opt_fabric+'[lining_id]"]').val(r.current.fabric.man_waistcoat),$('input[name="'+r.id_box_opt_fabric+'[contrast]"]').val("same_as_front").change(),r.extraSetPrice(t,o),r.keychain_isset(r.out_of_stock_control,["extras","lining",t])&&delete r.out_of_stock_control.extras.lining[t],r.renderDraw(),"undefined"!=typeof r.product_config[r.id_box_opt_fabric]&&"undefined"!=typeof r.product_config[r.id_box_opt_fabric].options&&r.relationsApply(r.id_box_opt_fabric+"[contrast]",r.product_config[r.id_box_opt_fabric].options[e])}else $(this).parent().find(".option_trigger").removeClass("active"),$(this).addClass("active"),$('input[name="'+r.id_box_opt_fabric+'[lining_id]"]',$(this).parent()).val(""),$('input[name="'+r.id_box_opt_fabric+'[contrast]"]',$(this).parent()).val(""),r.extraSetPrice(t,0),r.keychain_isset(r.out_of_stock_control,["extras","lining",t])&&delete r.out_of_stock_control.extras.lining[t],$('input[name="'+r.id_box_opt_fabric+'[lining_id]"]',$(this).parent()).val("").change(),"undefined"!=typeof r.product_config[r.id_box_opt_fabric]&&"undefined"!=typeof r.product_config[r.id_box_opt_fabric].options&&r.relationsApply(r.id_box_opt_fabric+"[contrast]",r.product_config[r.id_box_opt_fabric].options[e])})},Garment.prototype.resize_render_viewport_init=function(){var t=this.render_info.viewport;this.current_view="",this.current_product="",this.current_view_ratio="",this.viewport_full={},this.viewport_zoom={},this.viewport=t;var e=$(window).width();for(var r in t){this.current_view||(this.current_view=r),this.viewport_full[r]={w:0,h:0,top:this.viewport[r].base.h},this.viewport[r].base.ratio=0;for(var i in this.viewport[r])"base"!=i&&(this.viewport[r][i].ratio=this.viewport[r][i].h/this.viewport[r][i].w,this.current_product||(this.current_product=i),this.viewport[r].base.ratio<this.viewport[r][i].ratio&&(this.viewport[r].base.ratio=this.viewport[r][i].ratio),this.viewport[r][i].w>this.viewport_full[r].w&&(this.viewport_full[r].w=this.viewport[r][i].w),this.viewport[r][i].h+this.viewport[r][i].top>this.viewport_full[r].h&&(this.viewport_full[r].h=this.viewport[r][i].h+this.viewport[r][i].top),this.viewport[r][i].top<this.viewport_full[r].top&&(this.viewport_full[r].top=this.viewport[r][i].top));this.viewport_full[r].h=this.viewport_full[r].h-this.viewport_full[r].top,this.viewport_full[r].ratio=this.viewport_full[r].h/this.viewport_full[r].w;var a=e/this.viewport[r].base.w;a>2&&(a=2),this.viewport_zoom[r]={},this.viewport_zoom[r].h=Math.round(this.viewport[r].base.h*a),this.viewport_zoom[r].w=Math.round(this.viewport[r].base.w*a)}},Garment.prototype.resize_render_viewport=function(t,e,r){function i(t,e,r,i){var a={width:0,left:0,top:0};return t<e?(a.width=i/e,a.left=(r-a.width)/2):a.width=r,a}var a=this,n=$("#available_window"),o=n.find(".viewport"),c=n.height(),s=n.width(),l=c/s;if("full"==a.current_product){var _=i(l,a.viewport_full[a.current.view].ratio,s,c),u=_.width/a.viewport_full[a.current.view].w,p=a.viewport_full[a.current.view].h*u;_.top=-a.viewport_full[a.current.view].top*u}else{var _=i(l,a.viewport[a.current.view].base.ratio,s,c),u=_.width/a.viewport[a.current.view].base.w,p=a.viewport[a.current.view][a.current_product].h*u;_.top=-a.viewport[a.current.view][a.current_product].top*u}if(p<c&&(_.top+=(c-p)/2),_.top>0&&(_.top=0),$("form.garment_form").hasClass("hide_face")&&("man_smoking"==this.product_type||"man_suit2"==this.product_type)&&"man_jacket"==this.current_product&&("front"==a.current.view||"back"==a.current.view)){var f=.3*p;"back"!=a.current.view||"man_smoking"!=this.product_type&&"man_suit2"!=this.product_type||(f=.2*p),_.top=_.top-f}o.css(_)},Garment.prototype.updateConfiguratedProduct=function(t){function e(t,e){for(var r=e.length,i=0;i<r;i++)if(e[i]==t)return!0;return!1}function r(t,e,r){var i={};for(var a in t)i[a]=t[a];for(var a in e)i[a]=e[a];for(var a in r)i[a]=r[a];return i}var i=this,a=$("#config",i.container),n=$("#fabric",i.container),o=$("#extra",i.container);"default"==t&&(product=this.current);var c=!1;"undefined"!=typeof product.config.pants_chinos&&(c=product.config.pants_chinos),"man_pants"==i.product_type&&"1"==c?($(".fabric_options_fix").hide(),$(".fabric_list").css("margin-top","0px"),$('.option_trigger[rel="rounded"]').hide()):"man_pants"==i.product_type&&"1"!=c?($('.filters .filter li[rel="cotton"]').hide(),$('.option_trigger[rel="rounded_chinos"]').hide(),$('#fabric .fabric_box .image a[simple_composition="cotton"]').parent().parent().remove()):$('.option_trigger[rel="rounded_chinos"]').hide();var s=product.config;if(s){$(".option_trigger",a).removeClass("active");for(k in s)if("_active_block"!=k){if(i.current.config[k]=s[k],"shirt_neck_no_interfacing"==k||"shirt_neck_buttons"==k)$('input[name="'+k+'"]',a).each(function(){var t=$(this).val();t==s[k]?($(this).parent().addClass("checked"),$(this).attr("checked",!0),"shirt_neck_no_interfacing"==k&&$("label#cuff_interfacing_"+t).addClass("checked")):($(this).parent().removeClass("checked"),$(this).attr("checked",!1),"shirt_neck_no_interfacing"==k&&$("label#cuff_interfacing_"+t).removeClass("checked"))});else if("jacket_pockets_type"==k||"smoking_pockets_type"==k){var l=$('.box_opt[id="'+k+'"] .option_trigger[rel="'+s[k]+'"]',a);l.addClass("active"),l.hasClass("slanted")&&$("#jacket_pockets_type").addClass("slanted"),l.hasClass("slanted")&&$("#smoking_pockets_type").addClass("slanted"),$('input[name="'+k+'"]',a).val(s[k])}else if("waistcoat"==k&&"1"==s[k]){var _=$("#input_waistcoat").attr("price");_=parseFloat(_),i.convetToSuit3(_,!1)}else if("jacket_style_combined"==k){var u=s[k].split("_"),p=u[0],f=2;f="mao"==p?5:u[1],i.current.config.jacket_style=p,i.current.config.jacket_buttons=f,"mao"==p?i.current.config.jacket_style_combined=p:i.current.config.jacket_style_combined=p+"_"+f,$('input[name="jacket_style_combined"]',a).val(i.current.config.jacket_style_combined)}else $('input[name="'+k+'"]',a).val(s[k]);$('.box_opt[id="'+k+'"] .option_trigger[rel="'+s[k]+'"]',a).addClass("active"),$('.subbox_opt[id="'+k+'"] .option_trigger[rel="'+s[k]+'"]',a).addClass("active");var l=$('.box_opt[id="'+k+'"] .option_trigger[rel="'+s[k]+'"]',a);l.parent().attr("icon-fixed")||i.change_icon_trigger(l,$(".container_options",a)),"undefined"!=typeof i.product_config[k]&&i.relationsApply(k,i.product_config[k][s[k]])}}var d=["shirt_neck","shirt_cuff","shirt_patches","blouse_neck","blouse_cuff","neck_fabric","cuffs_fabric"],h=["shirt_threads","blouse_threads","jacket_threads","button_holes_threads","waistcoat_button_holes_threads","coat_threads","threads"],b=["coat_lining","lining","waistcoat_lining","waistcoat_lining_back"],v=["patches"],m=["tuxedo","type_flap"];if("man_suit2"==i.product_type&&"undefined"!=typeof product.extras&&"undefined"!=typeof product.extras.man_jacket)var g=r(product.extras.man_jacket,product.extras.man_pants,product.extras.man_waistcoat);else var g=product.extras;if(g)for(k in g)if(k.indexOf("initials")>-1){var y=$('.box_opt[id="'+k+'"]',o);i.updateExtraInitials(g[k],y,k)}else if(e(k,d)){var w=$('.box_opt[id="'+k+'"]',o);i.updateExtraFabric(k,g[k],w)}else if(e(k,v)&&"man_shirt"==i.product_type){var w=$('.box_opt[id="'+k+'"]',o);i.updateExtraPatches(k,g[k],w)}else if(e(k,h)){var w=$('.box_opt[id="'+k+'"]',o);i.updateExtraThreads(k,g[k],w)}else if(e(k,b)){var w=$('.box_opt[id="'+k+'"]',o);i.updateExtraLining(k,g[k],w)}else if(e(k,m)){var w=$('.box_opt[id="'+k+'"]',o);i.updateExtraStandart(k,g[k],w)}else{var w=$('.box_opt[id="'+k+'"]',o);i.updateExtraOther(k,g[k],w)}var x=product.fabric;if(x||(x=this.current),x){var C=i.product_type;if("woman_suitpants"==C||"woman_suitskirt"==C||"man_suit"==C||"man_suit2"==C||"man_suit3"==C){var S=x[i.multi_fabric_options[0]],j=x[i.multi_fabric_options[1]],T=x[i.multi_fabric_options[2]];i.current.fabric[i.multi_fabric_options[0]]=S,i.current.fabric[i.multi_fabric_options[1]]=j,i.current.fabric[i.multi_fabric_options[2]]=T;var I=!1;if(S!=j&&(I=!0),T&&S!=T&&(I=!0),I){$('#personalize_fabrics_split .option_trigger[rel="1"]',i.container).click();var w=$('.fabric_list .fabric_box div[rel="'+S+'"]');if(!w.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[0]]=A,w=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}var z=$('.fabric_list .fabric_box div[rel="'+j+'"]');if(!z.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[1]]=A,z=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}if(i.multi_fabric_active=i.multi_fabric_options[1],i.fabricSelect(n,z.parent(),!1),T){var T=$('.fabric_list .fabric_box div[rel="'+T+'"]');if(!T.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[2]]=A,T=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}i.multi_fabric_active=i.multi_fabric_options[2],i.fabricSelect(n,T.parent(),!1)}i.multi_fabric_active=i.multi_fabric_options[0],i.fabricSelect(n,w.parent())}else{var w=$('.fabric_list .fabric_box div[rel="'+S+'"]');if(!w.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[0]]=A,i.current.fabric[i.multi_fabric_options[1]]=A,i.current.fabric[i.multi_fabric_options[2]]=A,w=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}i.fabricSelect(n,w.parent())}}else if("man_smoking"==C){var S=x[i.multi_fabric_options[0]],j=x[i.multi_fabric_options[1]];if(i.current.fabric[i.multi_fabric_options[0]]=S,i.current.fabric[i.multi_fabric_options[1]]=j,S!=j){$('#personalize_fabrics_split .option_trigger[rel="1"]',i.container).click();var w=$('.fabric_list .fabric_box div[rel="'+S+'"]');if(!w.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[0]]=A,w=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}var z=$('.fabric_list .fabric_box div[rel="'+j+'"]');if(!z.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[1]]=A,z=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}i.multi_fabric_active=i.multi_fabric_options[1],i.fabricSelect(n,z.parent()),i.multi_fabric_active=i.multi_fabric_options[0],i.fabricSelect(n,w.parent())}else{var w=$('.fabric_list .fabric_box div[rel="'+S+'"]');if(!w.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[i.multi_fabric_options[0]]=A,i.current.fabric[i.multi_fabric_options[1]]=A,w=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}i.fabricSelect(n,w.parent())}}else if("man_shirt"!=C&&"man_jacket"!=C&&"man_pants"!=C&&"man_waistcoat"!=C||"default"==t){var O=x[C];i.current.fabric[C]=O;var w=$('#fabric .fabric_list .fabric_box div[rel="'+O+'"]');if(!w.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[C]=A,w=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}i.fabricSelect(n,w.parent())}else{var O=x.id_t4l_fabric;i.current.fabric[C]=O;var w=$('#fabric .fabric_list .fabric_box div[rel="'+O+'"]');if(!w.length){var A=$("#fabric .fabric_list .fabric_box div.image").first().attr("rel");i.current.fabric[C]=A,w=$('#fabric .fabric_list .fabric_box div[rel="'+A+'"]')}i.fabricSelect(n,w.parent())}}},Garment.prototype.updateExtraInitials=function(t,e,r){if(0!=t.length){var i=this;$('input[name="'+r+'[text]"]',e).val(t.text),$('input[name="'+r+'[type]"]',e).prop("checked",!1),$('input[name="'+r+'[type]"]',e).parent().removeClass("checked");var a=$('input[name="'+r+'[type]"][value="'+t.type+'"]');a.prop("checked",!0).parent().addClass("checked"),$("div.common_color",e).removeClass("checked"),$('input[name="'+r+'[color_custom]"]',e).val(t.color_custom),$('div.common_color[rel="'+t.color_custom+'"]',e).addClass("checked"),$('input[name="'+r+'[pos]"]',e).prop("checked",!1),$('input[name="'+r+'[pos]"]',e).parent().removeClass("checked");var n=$('input[name="'+r+'[pos]"][value="'+t.pos+'"]');n.prop("checked",!0).parent().addClass("checked");var o=parseFloat(e.attr("data-price"));isNaN(o)&&(o=0),i.extraSetPrice(r,o),i.current.extras[r].text=t.text,i.current.extras[r].color_custom=t.color_custom,i.current.extras[r].type=t.type,i.current.extras[r].pos=t.pos,"man_coat"!=this.product_type&&"man_trenchcoat"!=this.product_type&&i.renderInitials()}},Garment.prototype.updateExtraFabric=function(t,e,r){if(0==e.length)return void $(".option_trigger.zero_value",r).addClass("active");var i=this,a="";$(".option_trigger",r).removeClass("active"),"man_shirt"==i.product_type?e.id_t4l_fabric.in&&e.id_t4l_fabric.out?(a="full",$('input[name="'+t+'[contrast]"]',r).val(a),$('input[name="'+t+'[fabric_id]"]',r).val(e.id_t4l_fabric.in),$('.option_trigger[rel="full"]',r).addClass("active")):e.id_t4l_fabric.in?(a="inner",$('input[name="'+t+'[contrast]"]',r).val(a),$('input[name="'+t+'[fabric_id]"]',r).val(e.id_t4l_fabric.in),$('.option_trigger[rel="inner"]',r).addClass("active")):e.id_t4l_fabric.out&&(a="outer",$('input[name="'+t+'[contrast]"]',r).val(a),$('input[name="'+t+'[fabric_id]"]',r).val(e.id_t4l_fabric.out),$('.option_trigger[rel="outer"]',r).addClass("active")):($('input[name="'+t+'[contrast]"]',r).val(e.contrast),$('input[name="'+t+'[fabric_id]"]',r).val(e.fabric_id),$('.option_trigger[rel="'+e.contrast+'"]',r).addClass("active"));var n=parseFloat($("#"+t).attr("data-price"));i.extraSetPrice(t,n),"undefined"!=typeof i.product_config[t]&&i.relationsApply(t,i.product_config[t][a])},Garment.prototype.updateExtraPatches=function(t,e,r){if(0==e.length)return void $(".option_trigger.zero_value",r).addClass("active");var i=this;$(".option_trigger",r).removeClass("active"),$('input[name="'+t+'[contrast]"]',r).val("custom"),$('input[name="'+t+'[fabric_id]"]',r).val(e.id_t4l_fabric),$('.option_trigger[rel="custom"]',r).addClass("active");var a=parseFloat($("#"+t).attr("data-price"));i.extraSetPrice(t,a)},Garment.prototype.updateExtraStandart=function(t,e,r){if(0==e.length)return void $(".option_trigger.zero_value",r).addClass("active");var i=this;$('input[name="'+t+'"]',r).val(e),$(".option_trigger.active",r).removeClass("active"),$('.option_trigger[rel="'+e+'"]',r).addClass("active");var a=parseFloat($("#"+t).attr("data-price"));i.extraSetPrice(t,a),"undefined"!=typeof i.product_config[t]&&i.relationsApply(t,i.product_config[t][e])},Garment.prototype.updateExtraOther=function(t,e,r){var i=this;if(0==e.length)return void $(".option_trigger.zero_value",r).addClass("active");$('input[name="'+t+'[contrast]"]',r).val(e.contrast),"jacket_metal_button"==t?$('input[name="'+t+'[type]"]',r).val(e.type):"metal_buttons"==t?$('input[name="'+t+'[type]"]',r).val(e.type):"waistcoat_metal_buttons"==t?$('input[name="'+t+'[type]"]',r).val(e.type):"contrasts"==t?($('input[name="contrasts[contrast]"]',r).val(e.contrast),$('input[name="contrasts[contrasts_flap]"]',r).val(e.contrasts_flap),$('input[name="contrasts[contrasts_buttons]"]',r).val(e.contrasts_buttons),$('input[name="contrasts[contrasts_pants]"]',r).val(e.contrasts_pants),$('input[name="contrasts[contrasts_pockets]"]',r).val(e.contrasts_pockets)):$('input[name="'+t+'[color]"]',r).val(e.color),$(".option_trigger.active",r).removeClass("active"),$('.option_trigger[rel="'+e.contrast+'"]',r).addClass("active"),$(".colors_section",r).addClass("active"),"jacket_metal_button"==t?$('.colors_section .common_color[rel="'+e.type+'"]',r).addClass("checked"):"metal_buttons"==t?$('.colors_section .common_color[rel="'+e.type+'"]',r).addClass("checked"):"contrasts"==t?($('.color_block.contrasts_flap .common_color[rel="'+e.contrasts_flap+'"]',r).addClass("checked"),$('.color_block.contrasts_buttons .common_color[rel="'+e.contrasts_buttons+'"]',r).addClass("checked"),$('.color_block.contrasts_pants .common_color[rel="'+e.contrasts_pants+'"]',r).addClass("checked"),$('.color_block.contrasts_pockets .common_color[rel="'+e.contrasts_pockets+'"]',r).addClass("checked")):$('.colors_section .common_color[rel="'+e.color+'"]',r).addClass("checked");var a=parseFloat($("#"+t).attr("data-price"));i.extraSetPrice(t,a),"undefined"!=typeof i.product_config[t]&&"undefined"!=typeof i.product_config[t].contrast&&i.relationsApply(t,i.product_config[t].contrast[e.contrast])},Garment.prototype.updateExtraLining=function(t,e,r){if(0==e.length)return void $(".option_trigger.zero_value",r).addClass("active");var i=this,a="";if($(".option_trigger",r).removeClass("active"),$('input[name="'+t+'[contrast]"]',r).val(e.contrast),$('input[name="'+t+'[lining_id]"]',r).val(e.lining_id),$('.option_trigger[rel="'+e.contrast+'"]',r).addClass("active"),"unlined"==e.contrast){i.changeView("without_model");var n=parseFloat($('.option_trigger[rel="'+e.contrast+'"]',r).attr("data-price"))}else if("same_as_front"==e.contrast){i.changeView("without_model");var n=parseFloat($('.option_trigger[rel="'+e.contrast+'"]',r).attr("data-price"))}else{var n=parseFloat($("#"+t).attr("data-price")),o=$(".extra_linings .lining_list .lining_box div.lining_"+e.lining_id).parent();if(o.hasClass("padded")&&($(".option_trigger",r).removeClass("active"),$('.option_trigger[rel="padded"]',r).addClass("active")),"waistcoat_lining_back"==t)var n=parseFloat($("#waistcoat_lining_back").attr("data-price"));else var n=parseFloat($(".lining",o).attr("data-price"))}i.extraSetPrice(t,n),"undefined"!=typeof i.product_config[t]&&i.relationsApply(t,i.product_config[t][a])},Garment.prototype.updateExtraThreads=function(t,e,r){var i=this;if(0==e.length)return void $(".option_trigger.zero_value",r).addClass("active");$(".button_holes_section",r).addClass("active"),$(".option_trigger.active",r).removeClass("active"),"man_shirt"==i.product_type?($('.option_trigger[rel="'+e.position+'"]',r).addClass("active"),$('input[name="'+t+'[contrast]"]',r).val(e.position),e.apply_at&&($('.option_trigger[rel="'+e.apply_at+'"]',r).addClass("active"),$('input[name="'+t+'[contrast]"]',r).val(e.apply_at)),e.buttonthreads_color&&($('.buttonthreads_color .list_common_color .common_color[rel="'+e.buttonthreads_color+'"]').addClass("checked"),$('input[name="'+t+'[threads][color]"]').val(e.buttonthreads_color)),e.buttonholes_color&&($('.buttonholes_color .list_common_color .common_color[rel="'+e.buttonholes_color+'"]').addClass("checked"),$('input[name="'+t+'[holes][color]"]').val(e.buttonholes_color))):($('.option_trigger[rel="'+e.contrast+'"]',r).addClass("active"),$('input[name="'+t+'[contrast]"]',r).val(e.contrast),e.threads.color&&($('.buttonthreads_color .list_common_color .common_color[rel="'+e.threads.color+'"]').addClass("checked"),$('input[name="'+t+'[threads][color]"]').val(e.threads.color)),e.holes.color&&($('.buttonholes_color .list_common_color .common_color[rel="'+e.holes.color+'"]').addClass("checked"),$('input[name="'+t+'[holes][color]"]').val(e.holes.color)));var a=parseFloat($("#"+t).attr("data-price"));i.extraSetPrice(t,a)},Garment.prototype.stepNext=function(){switch(this.step){case"fabric":return this.multi_fabric?this.stepSetURL(this.multi_fabric_options[1].replace("man_","fabric_")):this.stepSetURL("config");case"fabric_pants":return this.stepSetURL("config");case"fabric_skirt":return this.stepSetURL("config");case"config":if("undefined"==typeof this.extra){this.container.submit();break}return this.stepSetURL("extra");case"extra":this.container.submit()}},Garment.prototype.gaEvent=function(t){var e=t;"zoom"==t&&(e="zoom_model"),this.push_dataLayer("config_"+this.product_type,"step:"+e)},Garment.prototype.stepPrev=function(){switch(this.step){case"config":return!1;case"fabric":return this.stepSetURL("config");case"extra":return this.stepSetURL("fabric")}},Garment.prototype.stepSetURL=function(t){$(".preview_fabric",this.container).hide(),"extra"==t?$(".preview_fabric",this.container).addClass("extra"):$(".preview_fabric",this.container).removeClass("extra"),History.pushState({step:t},this.window_title,"?step="+t)},Garment.prototype.stepSwitch=function(t){if(this.gaEvent(t),"zoom"==t){$(".image_render_full").addClass(this.current.view),$(".image_render_full .layers").html("");var e={width:this.viewport_zoom[this.current.view].w,height:this.viewport_zoom[this.current.view].h,"margin-left":-(this.viewport_zoom[this.current.view].w/2)};return"man_shirt"==this.product_type&&"folded"!=this.current.view&&(e["margin-top"]=-(this.viewport_zoom[this.current.view].h/5)),"man_pants"==this.product_type&&"front"==this.current.view&&(e["margin-top"]=-(this.viewport_zoom[this.current.view].h/4)),$(".image_render_full .viewport").css(e),$(".image_render_full").addClass("active"),this.renderDraw("BIG"),!1}if(this.closeSeersuckerWarning(),this.closeInitialsImage(),$(".image_render_full").removeClass(this.current.view),$(".image_render_full").removeClass("active"),"fabric"!=t&&$("#personalize_fabrics_info_popup").removeClass("active"),"fabric"!=t&&$("#personalize_fabrics_split").removeClass("active"),"man_jacket"!=this.current.config._active_block&&"man_suit2"==this.product_type&&(this.current.config._active_block="man_jacket",this.renderDraw()),"secondari"==this.position_render&&this.desactivePositionRenderSecondari(),"fabric"==t&&this.fabric_new&&(this.scrolltoFabric(".fabric_list"),this.fabric_new=!0),t||(t="config"),this.step!=t){if("fabric"==t||"fabric_pants"==t||"fabric_skirt"==t?($(".image_render",this.container).addClass("fabric_step"),$(".preview_fabric").addClass("fabric_step")):($(".image_render",this.container).removeClass("fabric_step"),$(".preview_fabric").removeClass("fabric_step")),"fabric_pants"==t||"fabric_skirt"==t){this.multi_fabric=t.replace("fabric_","man_"),$("#fabric .fabric_box .price.split").removeClass("visible"),$("#fabric .fabric_box .price.split."+this.multi_fabric).addClass("visible"),$("#fabric .fabric_list .fabric_box").removeClass("checked");var r=$('input[name="fabric['+this.multi_fabric+']"]').val();$('#fabric .fabric_list .fabric_box div[rel="'+r+'"]').parent().addClass("checked")}if("fabric"==t&&this.multi_fabric){this.multi_fabric="man_jacket",$("#fabric .fabric_list .fabric_box").removeClass("checked");var r=$('input[name="fabric['+this.multi_fabric+']"]').val();$('#fabric .fabric_list .fabric_box div[rel="'+r+'"]').parent().addClass("checked")}this.trigger("changeStep",[t]),"fabric"!=t||tablet_device||$(".fabric_list").perfectScrollbar("update"),"extra"!=t&&"fabric"!=t||this.remarketing(t),this.resize_render_viewport(this.current.view,!1,!1)}},Garment.prototype.remarketing=function(t,e){if("undefined"==typeof window.remarketing||!window.remarketing)return!1;var r=this,i=document.location.pathname.replace("personalize/","remarketing/");if("extra"==t){var e=$.extend({action:"getSimilarID",product_type:this.product_type},this.current);$.getJSON(i,e,function(t){!t.error&&t.id&&dataLayer.push({event:"productView",eventSource:"personalize_extras",product_type:r.product_type,product_id:t.id})})}else if("fabric_filter"==t||"fabric"==t){var e=$.extend({action:"getSimilarsID",product_type:this.product_type},e);$.getJSON(i,e,function(t){!t.error&&t.ids&&dataLayer.push({event:"productsView",eventSource:"personalize_filter",product_type:r.product_type,product_ids:t.ids})})}},Garment.prototype.bind=function(t,e){"undefined"==typeof this._events[t]&&(this._events[t]=[]),this._events[t].push(e)},Garment.prototype.trigger=function(t,e){if("undefined"!=typeof this._events[t])for(var r in this._events[t])this._events[t][r].apply(this,e)},Garment.prototype.unbind=function(t,e){if("undefined"!=typeof this._events[t]){var r=this._events[t].indexOf(e);r>-1&&this._events[t].splice(r,1)}},Garment.prototype.parse_query_string=function(t,e){if(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=r.exec(t);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))}var a,n=/\+/g,o=/([^&=]+)=?([^&]*)/g,c=function(t){return decodeURIComponent(t.replace(n," "))},s=t.replace(/^\?/,"");for(urlParams={};a=o.exec(s);)urlParams[c(a[1])]=c(a[2]);return urlParams},Garment.prototype.scrolltoFabric=function(t){setTimeout(function(){var e=0,r=$(t+" .fabric_box.checked");r.length&&(e=r.offset().top-200),$(t).animate({scrollTop:e},500)},600)},Garment.prototype.initGarment=function(){function t(){var t=navigator.userAgent.toLowerCase();return t.indexOf("msie")!=-1&&parseInt(t.split("msie")[1])}this.initCommon(),this.formInit(),this.initConfigure(),this.initFabric(),this.initExtras(),this.updatePrice();var e=!0,r=this;$(document).ready(function(){fabricPreview.init(e),r.initFabricOutOfStock()}),filter_fabric&&this.applyFilterFabric(filter_fabric,!1,!0),"undefined"!=typeof Blazy?this.bLazy_fabric=new Blazy({container:".fabric_container_lazy",success:function(t){t.parentNode.className=t.parentNode.className.replace(/\loading\b/,"")},error:function(t,e){dataLayer.push({event:"blazy_error"})}}):this.bLazy_fabric=!1,this.bLazy_fabric&&this.bLazy_fabric.revalidate(),8==t()&&$(window).resize(function(){var t=$(window).height(),e=.54*t,r=e/2;$(".image_render .layers").css("width",e+"px"),$(".image_render .layers").css("margin-left","-"+r+"px"),$(".image_render .loading").css("width",e+"px"),$(".image_render .loading").css("margin-left","-"+r+"px");var i=.174*t;$(".image_render .layers IMG.shirt").css("top",i+"px");var a=.55*t;$(".image_render .layers IMG.pant").css("top",a+"px");var n=$(window).width();if(n>1080)$(".image_render_full .layers IMG.shirt").css("top","347px"),$(".image_render_full .layers IMG.pant").css("top","1100px");else{var o=.315*n;$(".image_render_full .layers IMG.shirt").css("top",o+"px");var c=1*n;$(".image_render_full .layers IMG.pant").css("top",c+"px")}}),tablet_device?($(".container_options").addClass("overflow_scroll"),$(".box_opt").addClass("overflow_scroll"),$("#fabric .fabric_list").addClass("overflow_scroll"),$(".filters .menu_filter .content").addClass("overflow_scroll")):($(".container_options").perfectScrollbar({suppressScrollX:!0}),$(".box_opt").perfectScrollbar(),$("#fabric .fabric_list").perfectScrollbar({suppressScrollX:!0}),$(".filters .menu_filter .content").perfectScrollbar({suppressScrollX:!0}),$("#personalize_fabrics_info_popup").perfectScrollbar({suppressScrollX:!0}));var r=this;$(window).resize(function(){r.resize_render_viewport(r.current.view)});var i=$(".option_title");i.each(function(){var t=$(this).attr("data-shorttext");t&&t.toLowerCase().indexOf("_tip")>=0&&(t=$(this).html()),$(this).parents("span").append('<div class="shorttext">'+t+"</div>")}),"undefined"!=typeof winter_blazer_landing&&"yes"==winter_blazer_landing&&r.showQuilterWaistcoatAlert(),id_cart_product||id_shop_order_detail||default_alterate?this.updateConfiguratedProduct():this.updateConfiguratedProduct("default")},Garment.prototype.initFabricOutOfStock=function(){var t=this,e=!1;if(out_of_stock){var r=!1;if(e={},"undefined"!=typeof out_of_stock.fabric&&(e.fabric=out_of_stock.fabric,r||(t.showFabricOutOfStock("fabric",out_of_stock.fabric,"fabric"),r=!0)),"undefined"!=typeof out_of_stock.extras){if(e.extras={},"undefined"!=typeof out_of_stock.extras.lining){e.extras.lining={};for(var i in out_of_stock.extras.lining)e.extras.lining[i]=out_of_stock.extras.lining[i],r||(t.showFabricOutOfStock("lining",out_of_stock.extras.lining[i],i),r=!0)}if("undefined"!=typeof out_of_stock.extras.fabric){e.extras.fabric={};for(var a in out_of_stock.extras.fabric)e.extras.fabric[a]=out_of_stock.extras.fabric[a],r||(t.showFabricOutOfStock("fabric",out_of_stock.extras.fabric[a],a),r=!0)}}}t.out_of_stock_control=e,$(".popup_warning_fabric_out").click(function(){t.hideFabricOutOfStock()})},Garment.prototype.showFabricOutOfStock=function(t,e,r){var i=this;"fabric"!=r&&$("#extra li."+r+" a",i.container).click();var a=window.cdn_host,n="",o="big";"lining"==t?n="default":(n=i.product_type,n=n.replace("woman_",""),n=n.replace("man_",""),"pants"!=n&&"skirt"!=n&&"jacket"!=n&&"suit2"!=n&&"waistcoat"!=n&&"smoking"!=n&&"suitpants"!=n&&"suitskirt"!=n||(n="suit"));var c=a+"dimg/"+t+"/"+n+"/"+e+"_"+o+".jpg";$(".popup_warning_fabric_out .image img").attr("src",c),$(".popup_warning_fabric_out").removeClass("fabric_out").removeClass("lining_out").addClass(t+"_out").show()},Garment.prototype.allFabricsAndLiningsOk=function(){var t=this;if("undefined"!=typeof t.out_of_stock_control.fabric)return t.showFabricOutOfStock("fabric",t.out_of_stock_control.fabric,"fabric"),!1;if("undefined"!=typeof t.out_of_stock_control.extras){if("undefined"!=typeof t.out_of_stock_control.extras.lining)for(var e in t.out_of_stock_control.extras.lining)if("ok"!==t.out_of_stock_control.extras.lining[e])return t.showFabricOutOfStock("lining",t.out_of_stock_control.extras.lining[e],e),!1;if("undefined"!=typeof t.out_of_stock_control.extras.fabric)for(var r in t.out_of_stock_control.extras.fabric)if("ok"!==t.out_of_stock_control.extras.fabric[r])return t.showFabricOutOfStock("fabric",t.out_of_stock_control.extras.fabric[r],r),!1}return!0},Garment.prototype.applyFilterFabric=function(t,e,r){var i=this;"undefined"==typeof e&&(hide_fabric=!1),
"undefined"==typeof r&&(r=!0),$(".filters.fabric_step").find('.sub_menu_filter .filter li[rel="'+t.filter+'"]').addClass("active").parent().find("li.all").removeClass("active"),applied_filters=[];var a=$("#fabric"),n=$("#fabric .fabric_list .fabric_box"),o=$("#fabric .active_filters"),c=(o.find("ul"),$(".filters.fabric_step")),s=c.find(".menu_filter"),l=a.find(".fabric_options"),_=a.find(".fabric_options_fix"),u=a.find(".fabric_list"),p=!1;$(".filters.fabric_step").find(".item_menu_filter").each(function(t){var e=$(this),i=e.attr("rel");applied_filters[i]=[],e.find(".filter li.active").not(".all").each(function(){p=!0;var t=$(this).attr("rel"),e=$(this).find("a").html();if(applied_filters[i].push(t),r){var a=$(".left_filters");$("li",a).removeClass("active"),$('li[rel="filter"]').addClass("active"),o.append("<li rel_type="+i+" rel="+t+"><a href='javascript;:'><div class='cruz'>k</div><div class='title'>"+e+"</div></a></li>")}}),applied_filters[i].length<=0&&delete applied_filters[i]});var f=($(".fabric_options_fix").height(),[]);s.find(".item_menu_filter").each(function(){f.push($(this).attr("rel"))}),p&&(o.show(),i.update_fabric_list(n,f,applied_filters,$("#fabric"))),e&&($("#fabric").addClass("active"),c.removeClass("active"),i.resize_height_fabric_options_fix(l,_,u),$("#fabric").removeClass("active"))},Garment.prototype.formInit=function(){var t=this;$(this.container).submit(function(){return t.formSubmit()})},Garment.prototype.formSubmit=function(){this.allow_redirect=!0;var t=this;if(!t.allFabricsAndLiningsOk())return!1;var e="1";id_cart_product&&(e=id_cart_product),$(this.container).append('<input type="hidden" name="next" value="'+e+'" />');var r=!1;return id_crossell_feed_product&&(r=id_crossell_feed_product),$(this.container).append('<input type="hidden" name="id_crossell_feed_product" value="'+r+'" />'),!0},Garment.prototype.isSpecialView=function(t){var e=t.split("_");return"sp"==e[0]},Garment.prototype.changeView=function(t){this.show_force_view_message(!1);var e=this.current.view;this.current.view=t,$(".image_render").removeClass(e),$(".image_render").addClass(t),$(".image_render .views li.active").removeClass("active"),$('.image_render .views li[rel="'+t+'"]').addClass("active"),"folded"==t?$(".image_render .layers").addClass("folded"):$(".image_render .layers").removeClass("folded"),"man_suit2"!=this.product_type&&"man_suit3"!=this.product_type||(this.changeActiveBlock("man_jacket",!0),this.moveRender("down")),this.renderDraw("STD",e,t),"man_shirt"==this.product_type&&this.renderInitials(),$(window).resize()},Garment.prototype.change_style_shirt=function(t){var e=this;e.shirt_style_click=!0,t||(t="business"==e.current.style?"casual":("casual"==e.current.style,"business"));var r=$(".image_render .options_render a.style"),i=$("span",r),a=e.shirt_styles[t];"auto"!=t&&$(".title",r).hide(),"auto"!=t&&(e.current.style=t),"auto"!=a.view_detail&&(e.current.view_detail=a.view_detail),"auto"!=a.neck_open&&(e.current.neck_open=a.neck_open),"auto"!=a.inner_sleeve&&(e.current.inner_sleeve=a.inner_sleeve),"auto"!=a.icon&&i.html(a.icon),"auto"!=t&&$(".title."+a.title_to_show,r).show(),e.renderDraw()},Garment.prototype.change_style_shirt_simple=function(t){var e=this;e.shirt_style_click=!0;var r=e.shirt_styles[t],i=$(".image_render .options_render a.style"),a=$("span",i);e.current.style=t,"auto"!=r.view_detail&&(e.current.view_detail=r.view_detail),"auto"!=r.neck_open&&(e.current.neck_open=r.neck_open),"auto"!=r.inner_sleeve&&(e.current.inner_sleeve=r.inner_sleeve),"auto"!=r.icon&&a.html(r.icon),"auto"!=r.title_to_show&&("auto"!=t&&$(".title",i).hide(),$(".title."+r.title_to_show,i).show()),e.renderDraw()},Garment.prototype.change_style_pocket_square=function(){var t=this;t.current.extras.handkerchief.contrast&&("recto"==t.current.pocket_square?t.current.pocket_square="normal":t.current.pocket_square="recto",t.renderDraw())},Garment.prototype.change_style_quilted_waistcoat=function(){var t=this;"abierto"==t.current.quilted_waistcoat?t.current.quilted_waistcoat="cerrado":t.current.quilted_waistcoat="abierto",t.renderDraw()},Garment.prototype.initCommon=function(){function t(){function t(t,i,a,n,o){return"vw"==a?e*i/100+"px":"vh"==a?r*i/100+"px":"vmax"==a?Math.max(r,e)*i/100+"px":"vmin"==a?Math.min(r,e)*i/100+"px":""}var e=$(window).width(),r=$(window).height();$("img.resize_fix").each(function(){var e=this.getAttribute("resize_fix");return"undefined"==typeof e||void this.setAttribute("style",e.replace(/(\d*)(vh|vw|vmax|vmin)/g,t))})}var e=this,r=$(".image_render",e.container);$(".preview_fabric",e.container);this.bind("changeStep",function(t){if($(".step a.active").removeClass("active"),$(".block.active").removeClass("active"),$(".filters.active").removeClass("active"),$(".container_options ul li a.active").removeClass("active"),$(".container_options.min").removeClass("min"),$(".box_opt.active").removeClass("active"),e.step=t,$(".step ."+e.step).addClass("active"),$("#"+e.step+".block").addClass("active"),"woman_suitpants"==e.product_type||"woman_suitskirt"==e.product_type||"man_suit"==e.product_type||"man_suit2"==e.product_type){var r=t.replace("fabric_",""),i=e.multi_fabric_options[1].replace("man_","");e.multi_fabric&&r==i&&$("#fabric.block").addClass("active")}var a=".fabric_container_lazy";"extra"==t&&(a=".extra_container_lazy"),"undefined"!=typeof Blazy?this.bLazy_fabric=new Blazy({container:a,success:function(t){t.parentNode.className=t.parentNode.className.replace(/\loading\b/,"")},error:function(t,e){dataLayer.push({event:"blazy_error"})}}):this.bLazy_fabric=!1,this.bLazy_fabric&&this.bLazy_fabric.revalidate()}),History.Adapter.bind(window,"statechange",function(){var t=History.getState(),r="fabric",i=["config","fabric","fabric_pants","extra","zoom"];jQuery.inArray(t.data.step,i)!=-1&&(r=t.data.step),e.stepSwitch(r)}),$(".step").on("click","a",function(){var t=$(this).attr("rel");return e.stepSetURL(t),!1}),$("a.step_next").click(function(){return e.stepNext(),!1}),$(window).resize(t),t();var i=this.parse_query_string(window.location.search);i.step||(i.step="fabric"),History.replaceState(i,window.title),$(window).trigger("statechange");for(var a in extra_prices)$('#extra .box_opts .box_opt[id="'+a+'"]').attr("data-price",extra_prices[a]);var n=[];$("#config .container_options span",e.container).each(function(){var t=this.getAttribute("href");if(!t)return!0;t=t.replace(/^[^#]*#/,"");var e=$(this).attr("rel");e&&(e=e.split(","),n[t]=e)}),e.views.config=n;var o=[];$("#extra .container_options span",e.container).each(function(){var t=this.getAttribute("href");if(!t)return!0;t=t.replace(/^[^#]*#/,"");var e=$(this).attr("rel");e&&(e=e.split(","),o[t]=e)}),e.views.extra=o,$(".views").on("click","li",function(){var t=$(this).attr("rel");return $(this).parent().find("li").removeClass("active"),$(this).addClass("active"),e.changeView(t),!1}),$(".bottom_click").click(function(){"shirt_outside"==e.current.style?e.change_style_shirt_simple("shirt_inside"):e.change_style_shirt_simple("shirt_outside")}),$(".neck_click").click(function(){"neck_open"==e.current.style?e.change_style_shirt_simple("neck_close"):e.change_style_shirt_simple("neck_open")}),$(".cuff_click_left").click(function(){1==e.current.inner_sleeve?e.change_style_shirt_simple("cuff_close"):e.change_style_shirt_simple("cuff_open")}),$(".cuff_click_right").click(function(){1==e.current.inner_sleeve?e.change_style_shirt_simple("cuff_close"):e.change_style_shirt_simple("cuff_open")}),$(".pocket_square").click(function(){e.change_style_pocket_square()}),$(".quilted_waistcoat_click").click(function(){e.change_style_quilted_waistcoat()}),$(".options_render",r).on("click","a.fabric",function(){this.fabric_preview_open=!0;var t=e.product_type;t.replace("man_","");"woman_suitpants"!=e.product_type&&"woman_suitskirt"!=e.product_type||(t="woman_jacket"),"man_suit"!=e.product_type&&"man_suit2"!=e.product_type||(t="man_jacket"),"man_smoking"==e.product_type&&(t="man_jacket");var r=e.current.fabric[t],i=$('#fabric .image[rel="'+r+'"] span.thumb_preview');return e.showPreviewFabric(i,"fabric"),!1}),$(".options_render",r).on("click","a.style",function(){return e.change_style_shirt(),!1}),$(".options_render",r).on("click","a.plus",function(){return"less"==e.zoom?(e.current_product=e.multi_fabric_options[0],e.resize_render_viewport(e.current.view,!1,!1),e.zoom="normal",$("span","a.less").show()):e.stepSetURL("zoom"),!1}),$(".options_render",r).on("click","a.without_jacket",function(){return e.changeActiveBlock(!1,!1),!1}),$(".options_render",r).on("click","a.movement",function(){return e.moveRender(),!1}),$(".options_render",r).on("click","a.less",function(){e.current_product;return e.current_product="full",e.resize_render_viewport(e.current.view,!1,!0),e.zoom="less",$("span",$(this)).hide(),!1}),$(".image_render_full").click(function(){History.back()}),null!=show_prices_customer&&(show_prices_customer.hasOwnProperty("show_customer_prices")||($(".diamond").hide(),$(".price").hide(),$(".options_list .tags").hide())),e.initThumbFabric(),$(".extras.title_combined").hide()},Garment.prototype.moveRender=function(t){var e=this;"up"==t?($("li.movement a").addClass("moved"),e.current_product=e.multi_fabric_options[1],e.resize_render_viewport(e.current.view,!1,!1)):"down"==t?($("li.movement a").removeClass("moved"),e.current_product=e.multi_fabric_options[0],e.resize_render_viewport(e.current.view,!1,!1)):($("li.movement a").toggleClass("moved"),e.current_product==e.multi_fabric_options[1]?e.current_product=e.multi_fabric_options[0]:e.current_product=e.multi_fabric_options[1],e.resize_render_viewport(e.current.view,!1,!1))},Garment.prototype.hideOptionBox=function(t,e){var r=this;$("#"+t,e).removeClass("active"),$("a."+t,e).removeClass("active"),"shirt_threads"==t&&r.trigger("hideOptionBox",[])},Garment.prototype.show_force_view_message=function(t){t?$("#show_force_view_message").addClass("move"):$("#show_force_view_message").removeClass("move")},Garment.prototype.changeActiveBlock=function(t,e){return"undefined"==typeof e&&(e=!1),"undefined"==typeof change_icon&&(change_icon=!0),("man_suit2"==this.product_type||"man_suit3"==this.product_type)&&"man_pants"==t&&"without_model"==this.current.view||(e&&(t==this.multi_fabric_options[0]||"man_waistcoat"==t?$(".options_render a.movement").removeClass("moved"):$(".options_render a.movement").addClass("moved"),"man_jacket_only"==t?this.current_product="man_jacket":this.current_product=t,this.resize_render_viewport(this.current.view,!1,!1)),t||(t="man_jacket"==this.current.config._active_block||"man_smoking_jacket"==this.current.config._active_block||"man_smoking"==this.current.config._active_block?"1"==this.current.config.waistcoat?this.multi_fabric_options[2]:this.multi_fabric_options[1]:this.multi_fabric_options[0]),this.current.config._active_block!=t&&("man_jacket"!=t?$(".options_render li.without_jacket",this.container).addClass("active"):$(".options_render li.without_jacket",this.container).removeClass("active"),this.current.config._active_block=t,void("no_render"!=render&&this.renderDraw())))},Garment.prototype.convetToSuit3=function(t,e){var r=this;if(t=parseFloat(t),$('input[name="waistcoat"]').val(1),r.price_detail.waistcoat=t,r.updatePrice(),r.real_product_type="man_suit3",$("#fabric .fabric_list").addClass("three"),$("#fabric .fabric_box .price.split").removeClass("visible"),$("#fabric .fabric_box .price.split.man_suit3").addClass("visible"),$(".extras.title_combined").show(),$('.multifabric_selectors label[rel="man_waistcoat"]').show(),r.fabricPriceActive(),e){var i=r.current.fabric.man_jacket,a=$('#fabric .image[rel="'+i+'"] a').attr("category"),n=$('#fabric .fabric_box div[rel="'+i+'"]').parent();r.updateFabricPrices(!1,a,!0,n)}},Garment.prototype.convetToSuit2=function(){var t=this;$('input[name="waistcoat"]').val(0),t.price_detail.waistcoat=0,t.updatePrice(),t.real_product_type="man_suit2",$(".extras.title_combined").hide(),$("#fabric .fabric_list").removeClass("three"),$("#fabric .fabric_box .price.split").removeClass("visible"),$("#fabric .fabric_box .price.split.man_suit2").addClass("visible"),$('.multifabric_selectors label[rel="man_waistcoat"]').hide();var e=t.current.fabric.man_jacket,r=$('#fabric .image[rel="'+e+'"] a').attr("category");t.current.extras.waistcoat_button_holes_threads=[],t.current.extras.waistcoat_initials=[],t.current.extras.waistcoat_lining=[],t.extraSetPrice("waistcoat_button_holes_threads",0),t.extraSetPrice("waistcoat_initials",0),t.extraSetPrice("waistcoat_lining",0),t.fabricPriceActive();var i=$('#fabric .fabric_box div[rel="'+e+'"]').parent();t.updateFabricPrices(!1,r,!0,i)},Garment.prototype.change_icon_trigger=function(t,e){var r=t.attr("rel-icon"),i=t.attr("option_name");r=$("span.icon",t).html(),$("a."+i+" .option_icon",e).html(r)},Garment.prototype.check_auto_all_select=function(t){var e=t.find("li.active").not(".all");0==e.length&&t.find("li.all").addClass("active")},Garment.prototype.update_fabric_list=function(t,e,r,i){var a=!1;if(r.simple_composition){for(var n=r.simple_composition.length-1;n>=0;n--){if("filcoupe"==r.simple_composition[n])var a=!0;"woolmark"==r.simple_composition[n]&&(r.c=["100woolmerino"],e.push("c"),r.simple_composition.splice(n,1)),"stretchy"==r.simple_composition[n]&&(r.st=["2","1"],e.push("st"),r.simple_composition.splice(n,1))}r.simple_composition.length<1&&delete r.simple_composition}if(r.characteristics){for(var n=r.characteristics.length-1;n>=0;n--)"2ply"==r.characteristics[n]&&("undefined"==typeof r.tags&&(r.tags=[]),r.tags.push("yarn"),e.push("tags"),r.characteristics.splice(n,1)),"wrinkle"==r.characteristics[n]&&("undefined"==typeof r.tags&&(r.tags=[]),r.tags.push("wrinkle"),e.push("tags"),r.characteristics.splice(n,1)),"easy"==r.characteristics[n]&&("undefined"==typeof r.tags&&(r.tags=[]),r.tags.push("easy"),e.push("tags"),r.characteristics.splice(n,1)),"oeko"==r.characteristics[n]&&("undefined"==typeof r.tags&&(r.tags=[]),r.tags.push("oeko"),e.push("tags"),r.characteristics.splice(n,1)),"stretchy"==r.characteristics[n]&&("undefined"==typeof r.tags&&(r.tags=[]),r.tags.push("stretchy"),e.push("tags"),r.characteristics.splice(n,1));r.characteristics.length<1&&delete r.characteristics}if(r.category_group){for(var n=r.category_group.length-1;n>=0;n--){var o=r.category_group[n];switch(o){case"new":case"best_seller":case"promo":r[o]=[1],e.push(o),r.category_group.splice(n,1)}}r.category_group.length<1&&delete r.category_group}var c=this;t.each(function(){var t=$(this);t.addClass("active");var i=$(this).find("span");for(var n in e)if(void 0!=r[e[n]])if(a&&"simple_composition"==e[n]){var o=i.attr("thread_style");r[e[n]].indexOf(o)==-1&&t.removeClass("active")}else if("tags"==e[n]){var s=!1,l=r[e[n]];for(var _ in l)if("stretchy"==l[_]){var u=i.attr("st");u>0&&(s=!0)}else if("yarn"==l[_]){var p=i.attr("y");"1"==p&&(s=!0)}else{var f=i.attr("t");f.indexOf(l[_])!=-1&&(s=!0)}s||t.removeClass("active")}else if("simple_composition"==e[n]){var o=i.attr("simple_composition"),s=!1;for(var d in r[e[n]]){var h=r[e[n]][d];o.indexOf(h)!=-1&&(s=!0)}s||t.removeClass("active")}else if("season"==e[n]&&"winter_tweed"==r[e[n]][0]){var b=i.attr("season"),v=i.attr("simple_composition");"winter"!=b&&"tweed"!=v&&t.removeClass("active")}else{var o=i.attr(e[n]);r[e[n]].indexOf(o)==-1&&r[e[n]]!=o&&t.removeClass("active")}if("man_suit"==c.product_type||"man_suit2"==c.product_type){i.attr("simple_composition"),i.attr("fw")}});var s=$(".fabric_list .fabric_box.active",i).length;0==s?$(".empty_fabrics",i).addClass("active"):$(".empty_fabrics",i).removeClass("active");var l=$(".lining_list .lining_box.active",i).length;0==l?$(".empty_linings",i).addClass("active"):$(".empty_linings",i).removeClass("active"),this.bLazy_fabric&&this.bLazy_fabric.revalidate(),this.remarketing("fabric_filter",r)},Garment.prototype.resize_height_fabric_options_fix=function(t,e,r){var i=t.height(),a=$(".multifabric_selectors").height();e.height(i),this.multi_fabric_active&&(i+=a),r&&r.css("margin-top",i)},Garment.prototype.updateFabricPrices=function(t,e,r,i){var a=this;if(a.multi_fabric_active&&t&&("man_suit2"==a.product_type||"man_suit3"==a.product_type)){a.price_detail.fabric_man_suit2=0,a.price_detail.fabric_man_suit3=0,a.price_detail["fabric_"+t]=0;for(var n in a.fabric[t].price)"undefined"!=typeof e&&"undefined"!=typeof a.fabric[t].price[n][e]&&(a.price_detail["fabric_"+t]=a.fabric[t].price[n][e])}else if(a.multi_fabric_active&&t&&"man_smoking"==a.product_type){a.price_detail["fabric_"+t]=0;for(var n in a.fabric[t].price)"undefined"!=typeof e&&"undefined"!=typeof a.fabric[t].price[n][e]&&(a.price_detail["fabric_"+t]=a.fabric[t].price[n][e])}else if(t)if(t==a.real_product_type){a.price_detail["fabric_"+t]=0;for(var n in a.fabric[t].price)"undefined"!=typeof e&&"undefined"!=typeof a.fabric[t].price[n][e]&&(a.price_detail["fabric_"+t]=a.fabric[t].price[n][e])}else a.price_detail["fabric_"+t]=0;else for(var t in a.fabric)if(t==a.real_product_type){a.price_detail["fabric_"+t]=0;for(var n in a.fabric[t].price)"undefined"!=typeof e&&"undefined"!=typeof a.fabric[t].price[n][e]&&(a.price_detail["fabric_"+t]=a.fabric[t].price[n][e])}else a.price_detail["fabric_"+t]=0;if(r){var o=$("a",i).attr("dsc");if("man_suit3"==a.real_product_type)var o=$("a",i).attr("dsc_suit3");o&&!a.multi_fabric_active?a.price_detail.fabric_discount=o:a.price_detail.fabric_discount=0,a.updatePrice()}},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},Garment.prototype.showPreviewFabric=function(t,e){this.push_dataLayer("config_"+this.product_type,"step:zoom_fabric");var r=this;r.fabric_preview_open=!0,r.closeSeersuckerWarning();var i=t.prev().attr("price");"man_suit2"==r.product_type&&"man_suit3"==r.real_product_type&&(i=t.prev().attr("man_suit3")),r.complex&&r.multi_fabric_active&&(i=t.prev().attr(r.multi_fabric_active));var t={id_fabric:t.prev().attr("rel"),title:t.prev().attr("name"),new:t.prev().attr("new"),composition:t.prev().attr("c"),season:t.prev().attr("season"),thread_style:t.prev().attr("thread_style"),brightness:t.prev().attr("br"),tone:t.prev().attr("tp"),fabric_weight:t.prev().attr("fw"),thread_count:t.prev().attr("tco"),opacity:t.prev().attr("opacity"),rank:t.prev().attr("r"),category_group:t.prev().attr("cgi"),tags:t.prev().attr("t"),shirt_yarn:t.prev().attr("y"),material:t.prev().attr("material"),stretchy:t.prev().attr("st"),samples:t.prev().attr("sam"),bars:{excelence:t.prev().attr("b_ex"),hot:t.prev().attr("b_cal"),weight:t.prev().attr("b_pes"),fineza:t.prev().attr("b_fin")},price:i};fabricPreview.show(t,e,r.product_type,fabric_options_i18n,region)},Garment.prototype.initThumbFabric=function(){var t=this,e=$(".preview_fabric",t.container),r=$(".seersucker_warning",t.container);$(".fabric_box").on("click","span.thumb_preview",function(){var e=$(this).parents(".sidebar-options").attr("id");return t.showPreviewFabric($(this),e),!1}),e.click(function(){t.closeThumbFabric()}),$(".action_column",t.container).on("click",".category_group span",function(){t.fabric_preview_open=!0;var e=t.product_type;e.replace("man_","");"man_suit"!=t.product_type&&"man_suit2"!=t.product_type||(e="man_jacket"),t.multi_fabric_active&&(e=$(this).parents(".fabric_group").attr("rel"));var r=t.current.fabric[e],i=$('#fabric .image[rel="'+r+'"] span.thumb_preview');return t.showPreviewFabric(i,"fabric"),!1}),$(".action_column",t.container).on("click",".simple_composition .name",function(){t.fabric_preview_open=!0;var e=t.product_type;e.replace("man_","");"man_suit"!=t.product_type&&"man_suit2"!=t.product_type||(e="man_jacket"),t.multi_fabric_active&&(e=$(this).parents(".fabric_group").attr("rel"));var r=t.current.fabric[e],i=$('#fabric .image[rel="'+r+'"] span.thumb_preview');return t.showPreviewFabric(i,"fabric"),!1}),$(".lining_box").on("click","span.thumb_preview",function(){return t.showPreviewFabric($(this),"lining"),!1}),e.on("click",".close",function(){t.closeThumbFabric()}),t.container.on("click",".seersucker_warning",function(){t.closeSeersuckerWarning()}),r.on("click",".close",function(){t.closeSeersuckerWarning()})},Garment.prototype.showInitialsImage=function(){var t=this;t.initials_image=!0;var e=window.cdn_host;dev_mode&&(e="");$("#available_window .initials .image img").attr("src",e+"/images/man/jacket/initials/initials.jpg");$("#available_window .initials",t.container).show()},Garment.prototype.closeInitialsImage=function(){var t=this;t.initials_image=!1,$("#available_window .initials",t.container).hide()},Garment.prototype.closeSeersuckerWarning=function(){var t=this,e=$(".seersucker_warning",t.container);t.preview_seersucker_warning=!1,e.hide()},Garment.prototype.showSeersuckerWarning=function(t){var e=this;e.seersucker_warning=!0;var r="huge",i=$(".seersucker_warning",e.container);i.show();var a=window.cdn_host;dev_mode&&(a=""),$(".image img",i).attr("src",a+"/dimg/fabric/suit/"+t+"_"+r+".jpg")},Garment.prototype.closeThumbFabric=function(){var t=this;t.fabric_preview_open=!1,fabricPreview.close()},Garment.prototype.isFF=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},Garment.prototype.fabricPriceActive=function(){var t=this;0==t.multi_fabric_active?($("#fabric .price").removeClass("visible"),$("#fabric .price."+t.real_product_type).addClass("visible"),$("#fabric .fabric_list .fabric_box.checked").removeClass("checked"),$('#fabric .fabric_list .fabric_box div[rel="'+t.current.fabric[t.multi_fabric_options[0]]+'"]').parent().addClass("checked")):($("#fabric .price").removeClass("visible"),$("#fabric .price."+t.multi_fabric_active).addClass("visible"),$("#fabric .fabric_list .fabric_box.checked").removeClass("checked"),$('#fabric .fabric_list .fabric_box div[rel="'+t.current.fabric[t.multi_fabric_active]+'"]').parent().addClass("checked"),setTimeout(function(){var t=0,e=$("#fabric .fabric_list .fabric_box.checked");e.length&&(t=e.offset().top-200),$("#fabric .fabric_list").animate({scrollTop:t},500)},600))},Garment.prototype.push_dataLayer=function(t,e){dataLayer&&dataLayer.push({event:"configurator",eventCategory:t,eventAction:e,eventLabel:"desktop"})},Garment.prototype.showQuilterWaistcoatAlert=function(){var t=this;t.quilted_alert=!0,$(".quilted_waistcoat_alert",t.container).show();var e=window.cdn_host;dev_mode&&(e="");var r="jacket";"man_coat"==t.product_type&&(r="coat"),$(".quilted_waistcoat_alert .image img",t.container).attr("src",e+"images/man/"+r+"/quilted_waistcoat_alert.jpg")},Garment.prototype.hideQuilterWaistcoatAlert=function(){var t=this;$(".quilted_waistcoat_alert",t.container).hide()},Garment.prototype.showWinterLiningAlert=function(){var t=this;t.winter_lining_alert=!0,$(".winter_lining_alert",t.container).show();var e=window.cdn_host;dev_mode&&(e=""),$(".winter_lining_alert .image img",t.container).attr("src",e+"/images/man/shirt/winter_lining_alert_3.jpg")},Garment.prototype.hideWinterLiningAlert=function(){var t=this;$(".winter_lining_alert",t.container).hide()},Garment.prototype.hideFabricOutOfStock=function(){$(".popup_warning_fabric_out").hide()},Garment.prototype.validateStateButtonHoles=function(t){var e=!1,r=0;return $(".color_section.active, .thread_section.active",t).each(function(){""!=$("input",this).val()&&++r}),r>=1&&(e=!0),e},Garment.prototype.saveExtraBoxButtonsHoles=function(t,e){var r=this,i=r.validateStateButtonHoles(e);if(i){var a=(e.attr("id"),[]);a=[];var n=$("input#input_button_holes_threads",e).val(),o=0;""!=n&&(o=parseFloat(e.attr("data-price")),isNaN(o)&&(o=0)),r.extraSetPrice(t,o),"undefined"!=typeof r.product_config[t].contrast&&r.relationsApply(t+"[contrast]",r.product_config[t].contrast.all)}else r.extraSetPrice(t,0),"undefined"!=typeof r.product_config[t].contrast&&r.relationsApply(t+"[contrast]",r.product_config[t].contrast[""])},Garment.prototype.restoreBoxHoles=function(t,e){var r=this,i=r.validateStateButtonHoles(e)?0:1;if(i){$(".color_section input",e).val(""),$(".color_section .common_color.checked").removeClass("checked"),$(".color_section",e).removeClass("active"),$(".option_trigger",e).removeClass("active");var a=e.attr("id");if(!r.extra_threads_state)return $(".option_trigger.zero_value",e).addClass("active"),!0;var n=r.extra_threads_state["input_"+a];if("only_cuffs"==n){$("[rel="+n+"]",e).addClass("active"),$("input[name="+a+"]",e).val(n);var o=r.extra_threads_state.input_only_cuffs;$('.color_section .list_common_color[rel="'+n+'"] .common_color[rel="'+o+'"]').addClass("checked"),$('.color_section .list_common_color[rel="'+n+'"] input').val(o),$(".color_section."+n,e).addClass("active")}else""==n&&($("[rel="+n+"]",e).addClass("active"),$("input[name="+a+"]",e).val(n),$(".color_section.only_cuffs",e).addClass("active"),$(".color_section.all",e).addClass("active"));r.renderDraw()}},Garment.prototype.removeAllFilters=function(t,e,r,i,a){var n=this,o=[];t.find(".active_filters li").each(function(){$(this).remove()}),n.update_fabric_list(e,o,o,t),t.find(".extra_fabrics").scrollTop(0),a.find(".item_menu_filter.active .sub_menu_filter").removeClass("active").hide(),a.find(".item_menu_filter.active").removeClass("active"),a.find(".item_menu.active").removeClass("active"),a.find(".filter li.active").removeClass("active"),a.find(".filter li.all").addClass("active")},Garment.prototype.extraSetPrice=function(t,e){var r=this;if(t.indexOf("_initials")==-1)if(e>0){var i=$("#"+t,r.container);$("input",i).each(function(){var e=$(this).attr("name_current"),i=$(this).val();"tuxedo"!=t&&"type_flap"!=t?r.current.extras[t][e]=i:r.current.extras[t]=i})}else{var i=$("#"+t,r.container);r.current.extras[t]=[],"contrasts"==t&&$("input",i).each(function(){var e=$(this).attr("name_current");r.current.extras[t][e]=""})}"handkerchief"==t&&e>0?r.pocket_square.show():r.pocket_square.hide(),this.price_detail[t]=e,this.updatePrice(),e>0?("quilted_waistcoat"==t&&$(".quilted_waistcoat_click").addClass("active"),"contrasts"==t||"type_flap"==t?$('#extra .container_options ul a[href="satin_flap"]').addClass("inc_price"):$('#extra .container_options ul a[href="'+t+'"]').addClass("inc_price")):("quilted_waistcoat"==t&&$(".quilted_waistcoat_click").removeClass("active"),"contrasts"==t||"type_flap"==t?$('#extra .container_options ul a[href="satin_flap"]').removeClass("inc_price"):$('#extra .container_options ul a[href="'+t+'"]').removeClass("inc_price"))},Garment.prototype.inArray=function(t,e){if(!e)return!1;for(var r=e.length,i=0;i<r;i++)if(e[i]==t)return!0;return!1},Garment.prototype.updatePrice=function(){var t=this,e=0;for(var r in t.price_detail)isNaN(t.price_detail[r])&&delete t.price_detail[r],e+=parseFloat(t.price_detail[r]);e=Math.round(100*e)/100;var i=format_price(e,"small_symbol",window.currency_json);if($(".action_column div.price").html(i),t.price_detail.fabric_discount<0){$(".action_column div.price").not(".original_price").addClass("discount");var a=e-t.price_detail.fabric_discount,n=format_price(a,"small_symbol",window.currency_json);$(".action_column div.original_price").html(n).show()}else $(".action_column div.price").removeClass("discount"),$(".action_column div.original_price").hide()},String.prototype.trim=function(t){var e,r=0,i=0,a=this+"";for(t?(t+="",e=t.replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1")):e=" \n\r\t\f\v            ​\u2028\u2029　",r=a.length,i=0;i<r;i++)if(e.indexOf(a.charAt(i))===-1){a=a.substring(i);break}for(r=a.length,i=r-1;i>=0;i--)if(e.indexOf(a.charAt(i))===-1){a=a.substring(0,i+1);break}return e.indexOf(a.charAt(0))===-1?a:""},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.getID=function(t){return t?this.replace(/^[^#]*#/,""):this.replace(/^[^#]*/,"")},Object.size=function(t){var e,r=0;for(e in t)t.hasOwnProperty(e)&&r++;return r},"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(t){return t<10?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var r,i,a,n,o,c=gap,s=e[t];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(t)),"function"==typeof rep&&(s=rep.call(e,t,s)),typeof s){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(s)){for(n=s.length,r=0;r<n;r+=1)o[r]=str(r,s)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+c+"]":"["+o.join(",")+"]",gap=c,a}if(rep&&"object"==typeof rep)for(n=rep.length,r=0;r<n;r+=1)"string"==typeof rep[r]&&(i=rep[r],a=str(i,s),a&&o.push(quote(i)+(gap?": ":":")+a));else for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(a=str(i,s),a&&o.push(quote(i)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+c+"}":"{"+o.join(",")+"}",gap=c,a}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,r){var i;if(gap="",indent="","number"==typeof r)for(i=0;i<r;i+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=e,!e||"function"==typeof e||"object"==typeof e&&"number"==typeof e.length)return str("",{"":t});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var r,i,a=t[e];if(a&&"object"==typeof a)for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=walk(a,r),void 0!==i?a[r]=i:delete a[r]);return reviver.call(t,e,a)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(t,e){"use strict";var r=t.History=t.History||{},i=t.jQuery;if("undefined"!=typeof r.Adapter)throw new Error("History.js Adapter has already been loaded...");r.Adapter={bind:function(t,e,r){i(t).bind(e,r)},trigger:function(t,e,r){i(t).trigger(e,r)},extractEventData:function(t,r,i){var a=r&&r.originalEvent&&r.originalEvent[t]||i&&i[t]||e;return a},onDomLoad:function(t){i(t)}},"undefined"!=typeof r.init&&r.init()}(window),function(t,e){"use strict";var r=t.document,i=t.setTimeout||i,a=t.clearTimeout||a,n=t.setInterval||n,o=t.History=t.History||{};if("undefined"!=typeof o.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){return"undefined"==typeof o.initHtml4.initialized&&(o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(t){var e,r=o.getHashByIndex();return e=t===r},o.isHashEqual=function(t,e){return t=encodeURIComponent(t).replace(/%25/g,"%"),e=encodeURIComponent(e).replace(/%25/g,"%"),t===e},o.saveHash=function(t){return!o.isLastHash(t)&&(o.savedHashes.push(t),!0)},o.getHashByIndex=function(t){var e=null;return e="undefined"==typeof t?o.savedHashes[o.savedHashes.length-1]:t<0?o.savedHashes[o.savedHashes.length+t]:o.savedHashes[t]},o.discardedHashes={},o.discardedStates={},o.discardState=function(t,e,r){
    var i,a=o.getHashByState(t);return i={discardedState:t,backState:r,forwardState:e},o.discardedStates[a]=i,!0},o.discardHash=function(t,e,r){var i={discardedHash:t,backState:r,forwardState:e};return o.discardedHashes[t]=i,!0},o.discardedState=function(t){var e,r=o.getHashByState(t);return e=o.discardedStates[r]||!1},o.discardedHash=function(t){var e=o.discardedHashes[t]||!1;return e},o.recycleState=function(t){var e=o.getHashByState(t);return o.discardedState(t)&&delete o.discardedStates[e],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var e,i,a,c,s="",l=Boolean(o.getHash());return o.isInternetExplorer()?(e="historyjs-iframe",i=r.createElement("iframe"),i.setAttribute("id",e),i.setAttribute("src","#"),i.style.display="none",r.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),a="",c=!1,o.checkerFunction=function(){if(c)return!1;c=!0;var e=o.getHash(),r=o.getHash(i.contentWindow.document);return e!==s?(s=e,r!==e&&(a=r=e,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(e)),o.Adapter.trigger(t,"hashchange")):r!==a&&(a=r,l&&""===r?o.back():o.setHash(r,!1)),c=!1,!0}):o.checkerFunction=function(){var e=o.getHash()||"";return e!==s&&(s=e,o.Adapter.trigger(t,"hashchange")),!0},o.intervalList.push(n(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(e){var r,i=e&&e.newURL||o.getLocationHref(),a=o.getHashByUrl(i),n=null,c=null;return o.isLastHash(a)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(a),a&&o.isTraditionalAnchor(a)?(o.Adapter.trigger(t,"anchorchange"),o.busy(!1),!1):(n=o.extractState(o.getFullUrl(a||o.getLocationHref()),!0),o.isLastSavedState(n)?(o.busy(!1),!1):(c=o.getHashByState(n),r=o.discardedState(n),r?(o.getHashByIndex(-2)===o.getHashByState(r.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(n.data,n.title,encodeURI(n.url),!1),!0))))},o.Adapter.bind(t,"hashchange",o.onHashChange),o.pushState=function(e,r,i,a){if(i=encodeURI(i).replace(/%25/g,"%"),o.getHashByUrl(i))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(a!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:a}),!1;o.busy(!0);var n=o.createStateObject(e,r,i),c=o.getHashByState(n),s=o.getState(!1),l=o.getHashByState(s),_=o.getHash(),u=o.expectedStateId==n.id;return o.storeState(n),o.expectedStateId=n.id,o.recycleState(n),o.setTitle(n),c===l?(o.busy(!1),!1):(o.saveState(n),u||o.Adapter.trigger(t,"statechange"),!o.isHashEqual(c,_)&&!o.isHashEqual(c,o.getShortUrl(o.getLocationHref()))&&o.setHash(c,!1),o.busy(!1),!0)},o.replaceState=function(e,r,i,a){if(i=encodeURI(i).replace(/%25/g,"%"),o.getHashByUrl(i))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(a!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:a}),!1;o.busy(!0);var n=o.createStateObject(e,r,i),c=o.getHashByState(n),s=o.getState(!1),l=o.getHashByState(s),_=o.getStateByIndex(-2);return o.discardState(s,n,_),c===l?(o.storeState(n),o.expectedStateId=n.id,o.recycleState(n),o.setTitle(n),o.saveState(n),o.Adapter.trigger(t,"statechange"),o.busy(!1)):o.pushState(n.data,n.title,n.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(t,"hashchange")}),void 0)},"undefined"!=typeof o.init&&o.init()}(window),function(t,e){"use strict";var r=t.console||e,i=t.document,a=t.navigator,n=!1,o=t.setTimeout,c=t.clearTimeout,s=t.setInterval,l=t.clearInterval,_=t.JSON,u=t.alert,p=t.History=t.History||{},f=t.history;try{n=t.sessionStorage,n.setItem("TEST","1"),n.removeItem("TEST")}catch(t){n=!1}if(_.stringify=_.stringify||_.encode,_.parse=_.parse||_.decode,"undefined"!=typeof p.init)throw new Error("History.js Core has already been loaded...");p.init=function(t){return"undefined"!=typeof p.Adapter&&("undefined"!=typeof p.initCore&&p.initCore(),"undefined"!=typeof p.initHtml4&&p.initHtml4(),!0)},p.initCore=function(d){if("undefined"!=typeof p.initCore.initialized)return!1;if(p.initCore.initialized=!0,p.options=p.options||{},p.options.hashChangeInterval=p.options.hashChangeInterval||100,p.options.safariPollInterval=p.options.safariPollInterval||500,p.options.doubleCheckInterval=p.options.doubleCheckInterval||500,p.options.disableSuid=p.options.disableSuid||!1,p.options.storeInterval=p.options.storeInterval||1e3,p.options.busyDelay=p.options.busyDelay||250,p.options.debug=p.options.debug||!1,p.options.initialTitle=p.options.initialTitle||i.title,p.options.html4Mode=p.options.html4Mode||!1,p.options.delayInit=p.options.delayInit||!1,p.intervalList=[],p.clearAllIntervals=function(){var t,e=p.intervalList;if("undefined"!=typeof e&&null!==e){for(t=0;t<e.length;t++)l(e[t]);p.intervalList=null}},p.debug=function(){(p.options.debug||!1)&&p.log.apply(p,arguments)},p.log=function(){var t,e,a,n,o,c="undefined"!=typeof r&&"undefined"!=typeof r.log&&"undefined"!=typeof r.log.apply,s=i.getElementById("log");for(c?(n=Array.prototype.slice.call(arguments),t=n.shift(),"undefined"!=typeof r.debug?r.debug.apply(r,[t,n]):r.log.apply(r,[t,n])):t="\n"+arguments[0]+"\n",e=1,a=arguments.length;e<a;++e){if(o=arguments[e],"object"==typeof o&&"undefined"!=typeof _)try{o=_.stringify(o)}catch(t){}t+="\n"+o+"\n"}return s?(s.value+=t+"\n-----\n",s.scrollTop=s.scrollHeight-s.clientHeight):c||u(t),!0},p.getInternetExplorerMajorVersion=function(){var t=p.getInternetExplorerMajorVersion.cached="undefined"!=typeof p.getInternetExplorerMajorVersion.cached?p.getInternetExplorerMajorVersion.cached:function(){for(var t=3,e=i.createElement("div"),r=e.getElementsByTagName("i");(e.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->")&&r[0];);return t>4&&t}();return t},p.isInternetExplorer=function(){var t=p.isInternetExplorer.cached="undefined"!=typeof p.isInternetExplorer.cached?p.isInternetExplorer.cached:Boolean(p.getInternetExplorerMajorVersion());return t},p.options.html4Mode?p.emulated={pushState:!0,hashChange:!0}:p.emulated={pushState:!Boolean(t.history&&t.history.pushState&&t.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(a.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(a.userAgent)),hashChange:Boolean(!("onhashchange"in t||"onhashchange"in i)||p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8)},p.enabled=!p.emulated.pushState,p.bugs={setHash:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===a.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(a.userAgent)),safariPoll:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===a.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(a.userAgent)),ieDoubleCheck:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<7)},p.isEmptyObject=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},p.cloneObject=function(t){var e,r;return t?(e=_.stringify(t),r=_.parse(e)):r={},r},p.getRootUrl=function(){var t=i.location.protocol+"//"+(i.location.hostname||i.location.host);return i.location.port&&(t+=":"+i.location.port),t+="/"},p.getBaseHref=function(){var t=i.getElementsByTagName("base"),e=null,r="";return 1===t.length&&(e=t[0],r=e.href.replace(/[^\/]+$/,"")),r=r.replace(/\/+$/,""),r&&(r+="/"),r},p.getBaseUrl=function(){var t=p.getBaseHref()||p.getBasePageUrl()||p.getRootUrl();return t},p.getPageUrl=function(){var t,e=p.getState(!1,!1),r=(e||{}).url||p.getLocationHref();return t=r.replace(/\/+$/,"").replace(/[^\/]+$/,function(t,e,r){return/\./.test(t)?t:t+"/"})},p.getBasePageUrl=function(){var t=p.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(t,e,r){return/[^\/]$/.test(t)?"":t}).replace(/\/+$/,"")+"/";return t},p.getFullUrl=function(t,e){var r=t,i=t.substring(0,1);return e="undefined"==typeof e||e,/[a-z]+\:\/\//.test(t)||(r="/"===i?p.getRootUrl()+t.replace(/^\/+/,""):"#"===i?p.getPageUrl().replace(/#.*/,"")+t:"?"===i?p.getPageUrl().replace(/[\?#].*/,"")+t:e?p.getBaseUrl()+t.replace(/^(\.\/)+/,""):p.getBasePageUrl()+t.replace(/^(\.\/)+/,"")),r.replace(/\#$/,"")},p.getShortUrl=function(t){var e=t,r=p.getBaseUrl(),i=p.getRootUrl();return p.emulated.pushState&&(e=e.replace(r,"")),e=e.replace(i,"/"),p.isTraditionalAnchor(e)&&(e="./"+e),e=e.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},p.getLocationHref=function(t){return t=t||i,t.URL===t.location.href?t.location.href:t.location.href===decodeURIComponent(t.URL)?t.URL:t.location.hash&&decodeURIComponent(t.location.href.replace(/^[^#]+/,""))===t.location.hash?t.location.href:t.URL.indexOf("#")==-1&&t.location.href.indexOf("#")!=-1?t.location.href:t.URL||t.location.href},p.store={},p.idToState=p.idToState||{},p.stateToId=p.stateToId||{},p.urlToId=p.urlToId||{},p.storedStates=p.storedStates||[],p.savedStates=p.savedStates||[],p.normalizeStore=function(){p.store.idToState=p.store.idToState||{},p.store.urlToId=p.store.urlToId||{},p.store.stateToId=p.store.stateToId||{}},p.getState=function(t,e){"undefined"==typeof t&&(t=!0),"undefined"==typeof e&&(e=!0);var r=p.getLastSavedState();return!r&&e&&(r=p.createStateObject()),t&&(r=p.cloneObject(r),r.url=r.cleanUrl||r.url),r},p.getIdByState=function(t){var e,r=p.extractId(t.url);if(!r)if(e=p.getStateString(t),"undefined"!=typeof p.stateToId[e])r=p.stateToId[e];else if("undefined"!=typeof p.store.stateToId[e])r=p.store.stateToId[e];else{for(;r=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"!=typeof p.idToState[r]||"undefined"!=typeof p.store.idToState[r];);p.stateToId[e]=r,p.idToState[r]=t}return r},p.normalizeState=function(t){var e,r;return t&&"object"==typeof t||(t={}),"undefined"!=typeof t.normalized?t:(t.data&&"object"==typeof t.data||(t.data={}),e={},e.normalized=!0,e.title=t.title||"",e.url=p.getFullUrl(t.url?t.url:p.getLocationHref()),e.hash=p.getShortUrl(e.url),e.data=p.cloneObject(t.data),e.id=p.getIdByState(e),e.cleanUrl=e.url.replace(/\??\&_suid.*/,""),e.url=e.cleanUrl,r=!p.isEmptyObject(e.data),(e.title||r)&&p.options.disableSuid!==!0&&(e.hash=p.getShortUrl(e.url).replace(/\??\&_suid.*/,""),/\?/.test(e.hash)||(e.hash+="?"),e.hash+="&_suid="+e.id),e.hashedUrl=p.getFullUrl(e.hash),(p.emulated.pushState||p.bugs.safariPoll)&&p.hasUrlDuplicate(e)&&(e.url=e.hashedUrl),e)},p.createStateObject=function(t,e,r){var i={data:t,title:e,url:r};return i=p.normalizeState(i)},p.getStateById=function(t){t=String(t);var r=p.idToState[t]||p.store.idToState[t]||e;return r},p.getStateString=function(t){var e,r,i;return e=p.normalizeState(t),r={data:e.data,title:t.title,url:t.url},i=_.stringify(r)},p.getStateId=function(t){var e,r;return e=p.normalizeState(t),r=e.id},p.getHashByState=function(t){var e,r;return e=p.normalizeState(t),r=e.hash},p.extractId=function(t){var e,r,i,a;return a=t.indexOf("#")!=-1?t.split("#")[0]:t,r=/(.*)\&_suid=([0-9]+)$/.exec(a),i=r?r[1]||t:t,e=r?String(r[2]||""):"",e||!1},p.isTraditionalAnchor=function(t){var e=!/[\/\?\.]/.test(t);return e},p.extractState=function(t,e){var r,i,a=null;return e=e||!1,r=p.extractId(t),r&&(a=p.getStateById(r)),a||(i=p.getFullUrl(t),r=p.getIdByUrl(i)||!1,r&&(a=p.getStateById(r)),!a&&e&&!p.isTraditionalAnchor(t)&&(a=p.createStateObject(null,null,i))),a},p.getIdByUrl=function(t){var r=p.urlToId[t]||p.store.urlToId[t]||e;return r},p.getLastSavedState=function(){return p.savedStates[p.savedStates.length-1]||e},p.getLastStoredState=function(){return p.storedStates[p.storedStates.length-1]||e},p.hasUrlDuplicate=function(t){var e,r=!1;return e=p.extractState(t.url),r=e&&e.id!==t.id},p.storeState=function(t){return p.urlToId[t.url]=t.id,p.storedStates.push(p.cloneObject(t)),t},p.isLastSavedState=function(t){var e,r,i,a=!1;return p.savedStates.length&&(e=t.id,r=p.getLastSavedState(),i=r.id,a=e===i),a},p.saveState=function(t){return!p.isLastSavedState(t)&&(p.savedStates.push(p.cloneObject(t)),!0)},p.getStateByIndex=function(t){var e=null;return e="undefined"==typeof t?p.savedStates[p.savedStates.length-1]:t<0?p.savedStates[p.savedStates.length+t]:p.savedStates[t]},p.getCurrentIndex=function(){var t=null;return t=p.savedStates.length<1?0:p.savedStates.length-1},p.getHash=function(t){var e,r=p.getLocationHref(t);return e=p.getHashByUrl(r)},p.unescapeHash=function(t){var e=p.normalizeHash(t);return e=decodeURIComponent(e)},p.normalizeHash=function(t){var e=t.replace(/[^#]*#/,"").replace(/#.*/,"");return e},p.setHash=function(t,e){var r,a;return e!==!1&&p.busy()?(p.pushQueue({scope:p,callback:p.setHash,args:arguments,queue:e}),!1):(p.busy(!0),r=p.extractState(t,!0),r&&!p.emulated.pushState?p.pushState(r.data,r.title,r.url,!1):p.getHash()!==t&&(p.bugs.setHash?(a=p.getPageUrl(),p.pushState(null,null,a+"#"+t,!1)):i.location.hash=t),p)},p.escapeHash=function(e){var r=p.normalizeHash(e);return r=t.encodeURIComponent(r),p.bugs.hashEscape||(r=r.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),r},p.getHashByUrl=function(t){var e=String(t).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return e=p.unescapeHash(e)},p.setTitle=function(t){var e,r=t.title;r||(e=p.getStateByIndex(0),e&&e.url===t.url&&(r=e.title||p.options.initialTitle));try{i.getElementsByTagName("title")[0].innerHTML=r.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(t){}return i.title=r,p},p.queues=[],p.busy=function(t){if("undefined"!=typeof t?p.busy.flag=t:"undefined"==typeof p.busy.flag&&(p.busy.flag=!1),!p.busy.flag){c(p.busy.timeout);var e=function(){var t,r,i;if(!p.busy.flag)for(t=p.queues.length-1;t>=0;--t)r=p.queues[t],0!==r.length&&(i=r.shift(),p.fireQueueItem(i),p.busy.timeout=o(e,p.options.busyDelay))};p.busy.timeout=o(e,p.options.busyDelay)}return p.busy.flag},p.busy.flag=!1,p.fireQueueItem=function(t){return t.callback.apply(t.scope||p,t.args||[])},p.pushQueue=function(t){return p.queues[t.queue||0]=p.queues[t.queue||0]||[],p.queues[t.queue||0].push(t),p},p.queue=function(t,e){return"function"==typeof t&&(t={callback:t}),"undefined"!=typeof e&&(t.queue=e),p.busy()?p.pushQueue(t):p.fireQueueItem(t),p},p.clearQueue=function(){return p.busy.flag=!1,p.queues=[],p},p.stateChanged=!1,p.doubleChecker=!1,p.doubleCheckComplete=function(){return p.stateChanged=!0,p.doubleCheckClear(),p},p.doubleCheckClear=function(){return p.doubleChecker&&(c(p.doubleChecker),p.doubleChecker=!1),p},p.doubleCheck=function(t){return p.stateChanged=!1,p.doubleCheckClear(),p.bugs.ieDoubleCheck&&(p.doubleChecker=o(function(){return p.doubleCheckClear(),p.stateChanged||t(),!0},p.options.doubleCheckInterval)),p},p.safariStatePoll=function(){var e,r=p.extractState(p.getLocationHref());if(!p.isLastSavedState(r))return e=r,e||(e=p.createStateObject()),p.Adapter.trigger(t,"popstate"),p},p.back=function(t){return t!==!1&&p.busy()?(p.pushQueue({scope:p,callback:p.back,args:arguments,queue:t}),!1):(p.busy(!0),p.doubleCheck(function(){p.back(!1)}),f.go(-1),!0)},p.forward=function(t){return t!==!1&&p.busy()?(p.pushQueue({scope:p,callback:p.forward,args:arguments,queue:t}),!1):(p.busy(!0),p.doubleCheck(function(){p.forward(!1)}),f.go(1),!0)},p.go=function(t,e){var r;if(t>0)for(r=1;r<=t;++r)p.forward(e);else{if(!(t<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(r=-1;r>=t;--r)p.back(e)}return p},p.emulated.pushState){var h=function(){};p.pushState=p.pushState||h,p.replaceState=p.replaceState||h}else p.onPopState=function(e,r){var i,a,n=!1,o=!1;return p.doubleCheckComplete(),i=p.getHash(),i?(a=p.extractState(i||p.getLocationHref(),!0),a?p.replaceState(a.data,a.title,a.url,!1):(p.Adapter.trigger(t,"anchorchange"),p.busy(!1)),p.expectedStateId=!1,!1):(n=p.Adapter.extractEventData("state",e,r)||!1,o=n?p.getStateById(n):p.expectedStateId?p.getStateById(p.expectedStateId):p.extractState(p.getLocationHref()),o||(o=p.createStateObject(null,null,p.getLocationHref())),p.expectedStateId=!1,p.isLastSavedState(o)?(p.busy(!1),!1):(p.storeState(o),p.saveState(o),p.setTitle(o),p.Adapter.trigger(t,"statechange"),p.busy(!1),!0))},p.Adapter.bind(t,"popstate",p.onPopState),p.pushState=function(e,r,i,a){if(p.getHashByUrl(i)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(a!==!1&&p.busy())return p.pushQueue({scope:p,callback:p.pushState,args:arguments,queue:a}),!1;p.busy(!0);var n=p.createStateObject(e,r,i);return p.isLastSavedState(n)?p.busy(!1):(p.storeState(n),p.expectedStateId=n.id,f.pushState(n.id,n.title,n.url),p.Adapter.trigger(t,"popstate")),!0},p.replaceState=function(e,r,i,a){if(p.getHashByUrl(i)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(a!==!1&&p.busy())return p.pushQueue({scope:p,callback:p.replaceState,args:arguments,queue:a}),!1;p.busy(!0);var n=p.createStateObject(e,r,i);return p.isLastSavedState(n)?p.busy(!1):(p.storeState(n),p.expectedStateId=n.id,f.replaceState(n.id,n.title,n.url),p.Adapter.trigger(t,"popstate")),!0};if(n){try{p.store=_.parse(n.getItem("History.store"))||{}}catch(t){p.store={}}p.normalizeStore()}else p.store={},p.normalizeStore();p.Adapter.bind(t,"unload",p.clearAllIntervals),p.saveState(p.storeState(p.extractState(p.getLocationHref(),!0))),n&&(p.onUnload=function(){var t,e,r;try{t=_.parse(n.getItem("History.store"))||{}}catch(e){t={}}t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{};for(e in p.idToState)p.idToState.hasOwnProperty(e)&&(t.idToState[e]=p.idToState[e]);for(e in p.urlToId)p.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=p.urlToId[e]);for(e in p.stateToId)p.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=p.stateToId[e]);p.store=t,p.normalizeStore(),r=_.stringify(t);try{n.setItem("History.store",r)}catch(t){if(t.code!==DOMException.QUOTA_EXCEEDED_ERR)throw t;n.length&&(n.removeItem("History.store"),n.setItem("History.store",r))}},p.intervalList.push(s(p.onUnload,p.options.storeInterval)),p.Adapter.bind(t,"beforeunload",p.onUnload),p.Adapter.bind(t,"unload",p.onUnload)),p.emulated.pushState||(p.bugs.safariPoll&&p.intervalList.push(s(p.safariStatePoll,p.options.safariPollInterval)),"Apple Computer, Inc."!==a.vendor&&"Mozilla"!==(a.appCodeName||"")||(p.Adapter.bind(t,"hashchange",function(){p.Adapter.trigger(t,"popstate")}),p.getHash()&&p.Adapter.onDomLoad(function(){p.Adapter.trigger(t,"hashchange")})))},(!p.options||!p.options.delayInit)&&p.init()}(window);